<?php
 defined('IN_IA') or exit('Access Denied'); class Myxs_fodderModuleSite extends WeModuleSite { public function doWebBasics() { goto Cw_96; Qjire: $system_content = json_decode($system['system_content'], true); goto FELUq; q7kwX: goto zaZjx; goto vAy3L; Cw_96: global $_GPC, $_W; goto j2jUQ; yGpQ2: pdo_insert('myxs_fodder_system', $systemData); goto Fba1a; r75sc: $class = empty($_GPC['class']) ? 'system' : $_GPC['class']; goto YDY0V; oR5Dh: message('编辑系统设置成功', $this->createWebUrl('Basics', array("class" => "system")), 'success'); goto q7kwX; CJwat: YBonh: goto Qjire; PeVDx: kZlkO: goto R8xHe; Zk0MP: $systemData['create_time'] = time(); goto Xyuqw; Fba1a: message('添加系统设置成功', $this->createWebUrl('Basics', array("class" => "system")), 'success'); goto b0jQl; AF8J8: if (!($_GPC['submit'] == '提交')) { goto YBonh; } goto AaGJP; b0jQl: zaZjx: goto CJwat; FELUq: $system_seting = json_decode($system['system'], true); goto Qeki9; AaGJP: $systemData = array(); goto oSY2v; j2jUQ: $titleList = array("system" => "系统设置"); goto r75sc; YDY0V: $system = pdo_fetch('select * from ' . tablename('myxs_fodder_system') . ' where uniacid = :uniacid and system_code = :system_code', array(":uniacid" => $_W['uniacid'], ":system_code" => $class)); goto d4qP6; Xyuqw: $systemData['system'] = json_encode(array("title" => $_GPC['title'], "member_name" => $_GPC['member_name'], "copyright" => $_GPC['copyright'], "grouping" => $_GPC['grouping'], "share_txt" => $_GPC['share_txt'], "day_sign_status" => $_GPC['day_sign_status'])); goto eW7bc; Qeki9: include $this->template('default/Basics/index'); goto PeVDx; rYMxn: $systemData['system_content'] = json_encode(array("stat_bg" => $_GPC['stat_bg'], "logo_bg" => $_GPC['logo_bg'], "qr_bg" => $_GPC['qr_bg'], "content_bg" => $_GPC['content_bg'], "share_bg" => $_GPC['share_bg'])); goto Zk0MP; vAy3L: EoiuC: goto yGpQ2; rdZnc: if (empty($system)) { goto EoiuC; } goto mvLh3; mvLh3: pdo_update('myxs_fodder_system', $systemData, array("system_id" => $system['system_id'])); goto oR5Dh; oSY2v: $systemData['system_code'] = $class; goto rYMxn; eW7bc: $systemData['uniacid'] = $_W['uniacid']; goto rdZnc; d4qP6: if (!($class == 'system')) { goto kZlkO; } goto AF8J8; R8xHe: } public function doWebContent() { goto iVPJC; z4QFW: $where .= " and text like '%{$search}%'"; goto oC8Cq; nEj0X: if (!($operation == 'search')) { goto xcBf0; } goto hliBn; Q4PY3: if (empty($search)) { goto mZjKl; } goto z4QFW; EbLBo: xcBf0: goto DL2n4; emd3s: $where = ''; goto nEj0X; jKPmc: $pager = pagination($contentListTotal, $pindex, $psize); goto ndXYc; GDYJv: $psize = 20; goto XOhst; XOhst: $operation = !empty($_GPC['op']) ? $_GPC['op'] : 'main'; goto emd3s; iVPJC: global $_W, $_GPC; goto e6_Lg; hliBn: $search = trim($_GPC['searchmess']); goto Q4PY3; M8zhC: $contentListTotal = pdo_fetchcolumn('select count(*) from ' . tablename('myxs_fodder_content') . ' where content_class = :content_class and uniacid = :uniacid  ' . $where . '   order by `content_id` desc', array(":content_class" => 1, ":uniacid" => $_W['uniacid'])); goto jKPmc; KvSL1: foreach ($contentList as $key => $value) { goto ibVTa; YiuJc: $contentList[$key]['content_status'] = $class_status[$value['content_status']]; goto jJGFO; UpbLJ: $grouping = pdo_fetch('select * from ' . tablename('myxs_fodder_grouping') . ' where grouping_id = :grouping_id ', array(":grouping_id" => $value['grouping_id'])); goto jdJNc; jJGFO: $contentList[$key]['create_time'] = date('Y-m-d H:i:s', $value['create_time']); goto UpbLJ; MzERK: f2aif: goto stIiB; jdJNc: $contentList[$key]['grouping_id'] = $value['grouping_id'] == 0 ? '默认分组' : $grouping['grouping_name']; goto MzERK; ibVTa: $Class = pdo_fetch('select * from ' . tablename('myxs_fodder_class') . ' where class_id = :class_id', array(":class_id" => $value['class_id'])); goto RGfS5; RGfS5: $contentList[$key]['class_id'] = $Class['class_name']; goto YiuJc; stIiB: } goto l451G; e6_Lg: $pindex = max(1, intval($_GPC['page'])); goto GDYJv; DL2n4: $contentList = pdo_fetchall('select * from ' . tablename('myxs_fodder_content') . ' where  content_status > :content_status and content_class = :content_class and uniacid = :uniacid  ' . $where . '  order by `content_id` desc LIMIT ' . ($pindex - 1) * $psize . ',' . $psize, array(":content_status" => 0, ":content_class" => 1, ":uniacid" => $_W['uniacid'])); goto CXaFU; oC8Cq: mZjKl: goto EbLBo; ndXYc: include $this->template('default/content/index'); goto OKB39; l451G: Zzuu3: goto M8zhC; CXaFU: $class_status = array("删除", "显示", "隐藏"); goto KvSL1; OKB39: } public function doWebUpdateContent() { goto ckeYd; ve47f: pdo_update('myxs_fodder_content', array("content_status" => 2), array("content_id" => $_GPC['id'])); goto mgy1e; ua3Ae: $content = pdo_fetch('select * from ' . tablename('myxs_fodder_content') . ' where content_id = :content_id', array(":content_id" => $_GPC['id'])); goto RxhM1; ckeYd: global $_W, $_GPC; goto ua3Ae; RxhM1: if ($content['content_status'] == 1) { goto tGsOC; } goto S0SyX; Nw2AG: exit; goto oxclp; ToWcG: echo '显示'; goto Nw2AG; IieR4: exit; goto QLic_; AYiFR: tGsOC: goto ve47f; oxclp: goto M_0Um; goto AYiFR; QLic_: M_0Um: goto WLN23; S0SyX: pdo_update('myxs_fodder_content', array("content_status" => 1), array("content_id" => $_GPC['id'])); goto ToWcG; mgy1e: echo '隐藏'; goto IieR4; WLN23: } public function doWebContentMess() { goto DDbti; Tw5JO: $class = pdo_fetchall('select * from ' . tablename('myxs_fodder_class') . ' where class_status=:class_status and uniacid = :uniacid ', array("class_status" => 1, ":uniacid" => $_W['uniacid'])); goto B_YEZ; y48Ff: $data['text'] = $_GPC['text']; goto Tu9Nm; kYbjq: $data['fictitious_donnb'] = intval($_GPC['fictitious_donnb']); goto KsjP2; nLXX4: $data['update_time'] = time(); goto ldmaz; bSp3t: if (!empty($row)) { goto RGFeA; } goto BL7kI; erSML: message('内容添加成功！', $this->createWebUrl('content'), 'success'); goto jDVxT; CXSfs: RGFeA: goto UuZBk; sJ5yc: if (!($_GPC['submit'] == '提交')) { goto BIH7t; } goto KHwgG; UQAkY: if (!empty($data['content'])) { goto cHAbL; } goto MO5zF; O9WJo: message('删除成功！', referer(), 'success'); goto zgYyv; AsS5v: $sub = true; goto sJ5yc; Lg4x_: $data['content'] = json_encode(array($_GPC['video_path'], 300, 255)); goto o0iSa; tY1i3: $data['fictitious_donnb'] = intval($_GPC['fictitious_donnb']); goto gsmRT; eESxn: cHAbL: goto k6GK9; elfmG: $data = array(); goto LcUGj; NlG9i: $data['content_status'] = intval($_GPC['content_status']); goto CCW1i; jDVxT: BIH7t: goto ZRh39; v7ZgX: $data['content'] = json_encode($_GPC['thumbs']); goto NaTvi; nc2yT: $data['content_status'] = intval($_GPC['content_status']); goto ApyGt; rFKlv: if (!($_GPC['op'] == 'update')) { goto WPt1c; } goto we9kv; delbg: $content = pdo_fetch('select * from ' . tablename('myxs_fodder_content') . ' where content_id = :content_id', array(":content_id" => $id)); goto rszNK; ZRh39: C3DMi: goto QlZu6; qjhYC: tUkr6: goto zoZ4s; KIkSa: $insertid = pdo_insert('myxs_fodder_content', $data); goto erSML; cUbl0: if ($operation == 'delete') { goto ljfuR; } goto Ik16Q; zoZ4s: if (!empty($data['text'])) { goto C2ljn; } goto wL8VF; rEVWh: $contentimg = json_decode($content['content'], true); goto Tw5JO; pEVe4: ObfTR: goto h63ga; gsmRT: $data['fictitious_sharenb'] = intval($_GPC['fictitious_sharenb']); goto wPPtO; NaTvi: goto zeNFi; goto jKOzp; jKOzp: plAVj: goto Lg4x_; B_YEZ: $groupingList = pdo_fetchall('select * from ' . tablename('myxs_fodder_grouping') . ' where uniacid = :uniacid ', array(":uniacid" => $_W['uniacid'])); goto rFKlv; MO5zF: message('图片附件不能为空！', $this->createWebUrl('ContentMess', array("op" => "update", "id" => $id)), 'error'); goto eESxn; ApyGt: $data['create_time'] = time(); goto nLXX4; XaXhv: CQOVO: goto rRt3o; cMoxs: if (!empty($data['content'])) { goto RjSnQ; } goto ecZj_; hmHJs: wVUKt: goto cMoxs; wnVEU: message('请输入文本内容！'); goto pEVe4; GAqbm: $row = pdo_fetch('SELECT * FROM ' . tablename('myxs_fodder_content') . ' WHERE content_id = :content_id', array(":content_id" => $id)); goto bSp3t; KHwgG: if (!empty($_GPC['text'])) { goto ObfTR; } goto wnVEU; CCW1i: if ($data['type'] == 'video') { goto s45V0; } goto WSNtL; fh6yS: message('内容更新成功！', $this->createWebUrl('contentmess', array("op" => "update", "id" => $id)), 'success'); goto XaXhv; ecZj_: message('图片附件不能为空！', $this->createWebUrl('ContentMess', array("op" => "add", "id" => $id)), 'error'); goto qcxJL; KsjP2: $data['fictitious_sharenb'] = intval($_GPC['fictitious_sharenb']); goto NlG9i; GTQkJ: s45V0: goto dTEj_; BL7kI: message('抱歉，内容不存在或是已经被删除！'); goto CXSfs; D6D5w: $data['fictitious_clnb'] = intval($_GPC['fictitious_clnb']); goto kYbjq; kjq75: r7pCT: goto ADkFC; uB4WP: $data['content_class'] = 1; goto nc2yT; LcUGj: $data['type'] = trim($_GPC['type']); goto WLte1; Tu9Nm: $data['fictitious_clnb'] = intval($_GPC['fictitious_clnb']); goto tY1i3; DDbti: global $_W, $_GPC; goto SXfQa; QP5yU: message('文本内容不能为空！', $this->createWebUrl('ContentMess', array("op" => "add", "id" => $id)), 'error'); goto hmHJs; QlZu6: include $this->template('default/content/post'); goto IQRrh; i42jP: ljfuR: goto RZv25; k6GK9: pdo_update('myxs_fodder_content', $data, array("content_id" => $_GPC['id'])); goto fh6yS; WSNtL: $data['content'] = json_encode($_GPC['thumbs']); goto jcS7U; rRt3o: goto C3DMi; goto i42jP; VmYkb: $operation = !empty($_GPC['op']) ? $_GPC['op'] : 'look'; goto cUbl0; wPPtO: if ($data['type'] == 'video') { goto plAVj; } goto v7ZgX; SXfQa: $id = intval($_GPC['id']); goto VmYkb; ldmaz: $data['uniacid'] = $_W['uniacid']; goto IHCVG; UuZBk: pdo_update('myxs_fodder_content', array("content_status" => 0), array("content_id" => $id)); goto O9WJo; yyzbj: $data['class_id'] = intval($_GPC['class_id']); goto JD3_E; ADkFC: $class = pdo_fetchall('select * from ' . tablename('myxs_fodder_class') . ' where class_status=:class_status and uniacid = :uniacid ', array("class_status" => 1, ":uniacid" => $_W['uniacid'])); goto o8mXI; zgYyv: goto C3DMi; goto kjq75; wL8VF: message('文本内容不能为空！', $this->createWebUrl('ContentMess', array("op" => "update", "id" => $id)), 'error'); goto DpFtk; JD3_E: $data['grouping_id'] = intval($_GPC['grouping_id']); goto lSTBf; lsTOJ: $data['type'] = trim($_GPC['type']); goto yyzbj; RZv25: $id = intval($_GPC['id']); goto GAqbm; qcxJL: RjSnQ: goto KIkSa; IHCVG: if (!empty($data['text'])) { goto wVUKt; } goto QP5yU; o0iSa: zeNFi: goto uB4WP; DpFtk: C2ljn: goto UQAkY; h63ga: $data = array(); goto lsTOJ; Z4msO: if (!($_GPC['submit'] == '提交')) { goto CQOVO; } goto elfmG; aQoDI: $sub = false; goto delbg; dTEj_: $data['content'] = json_encode(array($_GPC['video_path'], 300, 255)); goto qjhYC; rszNK: $member_name = pdo_fetch('select username from ' . tablename('users') . ' where uid = :uid', array(":uid" => $content['member_id'])); goto rEVWh; f6RF0: WPt1c: goto Z4msO; tT1uJ: $data['grouping_id'] = intval($_GPC['grouping_id']); goto bSD0O; o8mXI: $groupingList = pdo_fetchall('select * from ' . tablename('myxs_fodder_grouping') . ' where uniacid = :uniacid ', array(":uniacid" => $_W['uniacid'])); goto AsS5v; WLte1: $data['class_id'] = intval($_GPC['class_id']); goto tT1uJ; we9kv: $sub = true; goto f6RF0; Ik16Q: if ($operation == 'add') { goto r7pCT; } goto aQoDI; jcS7U: goto tUkr6; goto GTQkJ; lSTBf: $data['member_id'] = 1; goto y48Ff; bSD0O: $data['text'] = $_GPC['text']; goto D6D5w; IQRrh: } public function doWebClass() { goto Epnob; mrG8G: $classListTotal = pdo_fetchcolumn('select count(*) from ' . tablename('myxs_fodder_class') . ' where circle_id = :circle_id and uniacid = :uniacid order by `class_id` desc', array(":circle_id" => "0", ":uniacid" => $_W['uniacid'])); goto ZOvJN; oE0Rr: foreach ($classList as $key => $value) { goto eEt_h; WoPbf: $classList[$key]['class_status'] = $class_status[$value['class_status']]; goto qJf7M; rFZza: nIAhw: goto Jgy3e; qJf7M: $classList[$key]['create_time'] = date('Y-m-d H:i:s', $value['create_time']); goto rFZza; eEt_h: $Class = pdo_fetch('select * from ' . tablename('myxs_fodder_class') . ' where class_id = :class_id', array(":class_id" => $value['class_id'])); goto WoPbf; Jgy3e: } goto bcfIy; ipx_s: $class_status = array("1" => "启用", "2" => "删除"); goto oE0Rr; ZOvJN: $pager = pagination($classListTotal, $pindex, $psize); goto p2rji; GWSqL: $psize = 20; goto g4lFH; p2rji: include $this->template('default/class/index'); goto Djc5n; bcfIy: euWpG: goto mrG8G; g4lFH: $classList = pdo_fetchall('select * from ' . tablename('myxs_fodder_class') . ' where circle_id = :circle_id and uniacid = :uniacid order by `class_id` desc LIMIT ' . ($pindex - 1) * $psize . ',' . $psize, array(":circle_id" => "0", ":uniacid" => $_W['uniacid'])); goto ipx_s; IvzCR: $pindex = max(1, intval($_GPC['page'])); goto GWSqL; Epnob: global $_W, $_GPC; goto IvzCR; Djc5n: } public function doWebClassMess() { goto xfmtb; U43Vf: $sub = true; goto ewSZ1; fXIJ_: if (!empty($row)) { goto upzmJ; } goto RVZDe; S7xRE: $insertid = pdo_insert('myxs_fodder_class', $data); goto qbKk5; pmz2e: $content = pdo_fetch('select * from ' . tablename('myxs_fodder_class') . ' where class_id = :class_id', array(":class_id" => $id)); goto R9MQK; cGV76: upzmJ: goto c4GBg; K9SD2: bwCRE: goto AleFX; AleFX: $id = intval($_GPC['id']); goto q11o9; CCsAw: $sub = true; goto cTPbE; cTPbE: APBNP: goto qmPze; q11o9: $row = pdo_fetch('SELECT * FROM ' . tablename('myxs_fodder_class') . ' WHERE class_id = :class_id', array(":class_id" => $id)); goto fXIJ_; RIVQ9: message('请输入分类名称！'); goto QeG0o; qbKk5: message('分类添加成功！', $this->createWebUrl('class'), 'success'); goto zdJtF; sLBed: goto e0tcF; goto K9SD2; b2r9j: if (!($_GPC['op'] == 'add')) { goto APBNP; } goto CCsAw; SXZZn: VNWVL: goto sLBed; qmPze: if (!($_GPC['submit'] == '提交')) { goto x6Qb7; } goto bQvnM; c4GBg: pdo_update('myxs_fodder_class', array("class_status" => 2), array("class_id" => $id)); goto jfRRr; MqOVK: $data['create_time'] = time(); goto SiNlS; QCxUL: $sub = false; goto pmz2e; KtEKG: $data['class_status'] = intval($_GPC['class_status']); goto MqOVK; f5L11: $id = intval($_GPC['id']); goto XXx9y; XIQgY: if ($operation == 'delete') { goto bwCRE; } goto Xdvxb; SiNlS: pdo_update('myxs_fodder_class', $data, array("class_id" => $_GPC['id'])); goto bMtgU; zdJtF: x6Qb7: goto dDN14; RVZDe: message('抱歉，内容不存在或是已经被删除！'); goto cGV76; bMtgU: message('分类更新成功！', $this->createWebUrl('classmess', array("op" => "update", "id" => $id)), 'success'); goto SXZZn; xfmtb: global $_W, $_GPC; goto f5L11; qXwow: $data['class_name'] = $_GPC['class_name']; goto NGZsI; NGZsI: $data['class_status'] = intval($_GPC['class_status']); goto PA9BD; PA9BD: $data['create_time'] = time(); goto Wl622; XXx9y: $operation = !empty($_GPC['op']) ? $_GPC['op'] : 'look'; goto XIQgY; ewSZ1: tFNH1: goto KF3ad; Wl622: $data['uniacid'] = $_W['uniacid']; goto S7xRE; hXSc6: exjow: goto b2r9j; KF3ad: if (!($_GPC['submit'] == '提交')) { goto VNWVL; } goto nbxCM; RJrqv: $data['class_name'] = $_GPC['class_name']; goto KtEKG; bQvnM: if (!empty($_GPC['class_name'])) { goto IPmnb; } goto RIVQ9; bknSI: include $this->template('default/class/post'); goto d_9Uj; nbxCM: $data = array(); goto RJrqv; xthXX: goto e0tcF; goto hXSc6; dDN14: e0tcF: goto bknSI; jfRRr: message('删除成功！', referer(), 'success'); goto xthXX; UIMSJ: $data = array(); goto qXwow; Xdvxb: if ($operation == 'add') { goto exjow; } goto QCxUL; R9MQK: if (!($_GPC['op'] == 'update')) { goto tFNH1; } goto U43Vf; QeG0o: IPmnb: goto UIMSJ; d_9Uj: } public function doWebDaySign() { goto DqwCx; ojSXW: $daySignList = pdo_fetchall('select * from ' . tablename('myxs_fodder_day_sign') . ' where uniacid = :uniacid and sign_status > :sign_status order by `sign_id` desc LIMIT ' . ($pindex - 1) * $psize . ',' . $psize, array(":uniacid" => $_W['uniacid'], ":sign_status" => 0)); goto JbNNk; DqwCx: global $_W, $_GPC; goto ism2V; SXWNm: $pager = pagination($daySignListTotal, $pindex, $psize); goto rFdbh; dFU3w: GrDtS: goto SXWNm; JbNNk: $daySignListTotal = pdo_fetchcolumn('select count(*) from ' . tablename('myxs_fodder_day_sign') . ' where uniacid = :uniacid and sign_status > :sign_status order by `sign_id` desc', array(":uniacid" => $_W['uniacid'], ":sign_status" => 0)); goto ZRelU; ZRelU: foreach ($daySignList as $key => $value) { goto fBv8M; fBv8M: $daySignList[$key]['display_time'] = date('Y-m-d', $value['display_time']); goto Hg8Bi; z8eeg: KrU4g: goto kKypu; Hg8Bi: $daySignList[$key]['sign_img'] = toimage($value['sign_img']); goto z8eeg; kKypu: } goto dFU3w; rFdbh: include $this->template('default/daySign/index'); goto K8GOy; wZaA9: $psize = 20; goto ojSXW; ism2V: $pindex = max(1, intval($_GPC['page'])); goto wZaA9; K8GOy: } public function doWebDaySignMess() { goto m99_t; XdIoe: $id = intval($_GPC['id']); goto xOFqK; G5GU8: message('标题不能为空！', $this->createWebUrl('DaySignMess', array("op" => "add", "id" => $id)), 'error'); goto BsHXp; c_wQP: if (!empty($data['sign_title'])) { goto WW4cL; } goto kOvRS; SkYxx: if (!empty($_GPC['sign_title'])) { goto Ed5Ec; } goto J3mIp; mS306: if (!empty($row)) { goto RSGk0; } goto Af3Vw; q0efS: if (!empty($data['sign_title'])) { goto v0IfB; } goto G5GU8; zw6zD: message('日签更新成功！', $this->createWebUrl('DaySignMess', array("op" => "update", "id" => $id)), 'success'); goto uA1wD; XqXIg: message('内容不能为空！', $this->createWebUrl('DaySignMess', array("op" => "add", "id" => $id)), 'error'); goto GgScK; s0HPV: $data['sign_content'] = $_GPC['sign_content']; goto FE8r7; LySnc: if (!empty($_GPC['sign_content'])) { goto KYXi0; } goto f6f7f; rdQRz: i17qV: goto cegp6; LlsTY: O4tUp: goto Bn0e_; YG6yQ: $data['sign_title'] = $_GPC['sign_title']; goto s0HPV; GgScK: gZi7c: goto jUOe7; hJdZA: rY8Yu: goto hCCDD; f6f7f: message('请输入日签内容！'); goto BAtMw; t1ggF: if (!empty($data['sign_content'])) { goto gZi7c; } goto XqXIg; ApBVw: $data['display_time'] = strtotime($_GPC['time']); goto rN1KE; kOvRS: message('标题不能为空！', $this->createWebUrl('DaySignMess', array("op" => "add", "id" => $id)), 'error'); goto e37Nt; bXNUx: include $this->template('default/daySign/post'); goto QHdC6; Bn0e_: if (!($_GPC['submit'] == '提交')) { goto jtg2G; } goto ToI1X; TG8Rc: pdo_update('myxs_fodder_day_sign', $data, array("sign_id" => $_GPC['id'])); goto zw6zD; e37Nt: WW4cL: goto t1ggF; XKr4m: RSGk0: goto IWmqk; m99_t: global $_W, $_GPC; goto XdIoe; qRjTn: $data['sign_title'] = $_GPC['sign_title']; goto lu_SN; yKmoW: $data = array(); goto SkYxx; jUOe7: if (!empty($data['sign_img'])) { goto J9daf; } goto zOaWu; bRrYq: $daysign = pdo_fetch('select * from ' . tablename('myxs_fodder_day_sign') . ' where sign_id = :sign_id', array(":sign_id" => $id)); goto NoMuW; xQ9hY: $data['sign_img'] = $_GPC['sign_img']; goto qRjTn; tXTza: $data['sign_status'] = intval($_GPC['sign_status']); goto ApBVw; NoMuW: if (!($_GPC['op'] == 'update')) { goto O4tUp; } goto RetEI; IWmqk: pdo_update('myxs_fodder_day_sign', array("sign_status" => 0), array("sign_id" => $id)); goto mHsBz; hCCDD: pdo_insert('myxs_fodder_day_sign', $data); goto r3PxG; uA1wD: jtg2G: goto VZQcv; VZQcv: goto hCw_A; goto k7MYh; WaU_8: if (!empty($data['sign_content'])) { goto i17qV; } goto ekTtl; O5S5G: if ($operation == 'delete') { goto nS6CR; } goto J2dF_; FE8r7: $data['display_time'] = strtotime($_GPC['time']); goto V1xVi; xOFqK: $operation = !empty($_GPC['op']) ? $_GPC['op'] : 'look'; goto O5S5G; tzx25: $data['uniacid'] = $_W['uniacid']; goto q0efS; J2dF_: if ($operation == 'add') { goto OzWCP; } goto Ojvg8; k7MYh: nS6CR: goto ivgww; zOaWu: message('图片不能为空！', $this->createWebUrl('DaySignMess', array("op" => "add", "id" => $id)), 'error'); goto NwCjX; R5G8R: UWt_S: goto QqOcn; ivgww: $id = intval($_GPC['id']); goto G87cH; ekTtl: message('内容不能为空！', $this->createWebUrl('DaySignMess', array("op" => "add", "id" => $id)), 'error'); goto rdQRz; Bmysg: message('图片不能为空！', $this->createWebUrl('DaySignMess', array("op" => "add", "id" => $id)), 'error'); goto hJdZA; lu_SN: $data['sign_content'] = $_GPC['sign_content']; goto tXTza; NwCjX: J9daf: goto TG8Rc; r3PxG: message('内容添加成功！', $this->createWebUrl('daySign'), 'success'); goto R5G8R; Af3Vw: message('抱歉，日签不存在或是已经被删除！'); goto XKr4m; mHsBz: message('删除成功！', referer(), 'success'); goto Ahy1G; UJ2Zk: if (!($_GPC['submit'] == '提交')) { goto UWt_S; } goto yKmoW; V1xVi: $data['sign_status'] = intval($_GPC['sign_status']); goto c_wQP; cegp6: if (!empty($data['sign_img'])) { goto rY8Yu; } goto Bmysg; ZoIR2: Ed5Ec: goto LySnc; GBnUG: OzWCP: goto P6I_3; QqOcn: hCw_A: goto bXNUx; RetEI: $sub = true; goto LlsTY; G87cH: $row = pdo_fetch('SELECT * FROM ' . tablename('myxs_fodder_day_sign') . ' WHERE sign_id = :sign_id', array(":sign_id" => $id)); goto mS306; ToI1X: $data = array(); goto mU6zc; J3mIp: message('请输入日签标题！'); goto ZoIR2; BAtMw: KYXi0: goto xQ9hY; rN1KE: $data['create_time'] = time(); goto tzx25; P6I_3: $sub = true; goto UJ2Zk; Ahy1G: goto hCw_A; goto GBnUG; Ojvg8: $sub = false; goto bRrYq; BsHXp: v0IfB: goto WaU_8; mU6zc: $data['sign_img'] = $_GPC['sign_img']; goto YG6yQ; QHdC6: } public function doWebMember() { goto qMl27; nmiVq: $pager = pagination($memberListTotal, $pindex, $psize); goto fxZpQ; dqHUd: af8uz: goto flmPE; wMktX: $pindex = max(1, intval($_GPC['page'])); goto VlGDF; qMl27: global $_GPC, $_W; goto wMktX; yNB2L: if (empty($search)) { goto af8uz; } goto WUwc3; dkuD_: $memberList = pdo_fetchall('select * from ' . tablename('myxs_fodder_member') . ' where uniacid = :uniacid  ' . $where . ' order by `member_id` desc LIMIT ' . ($pindex - 1) * $psize . ',' . $psize, array(":uniacid" => $_W['uniacid'])); goto n1NGn; flmPE: NJEho: goto dkuD_; VlGDF: $psize = 20; goto GwO75; fxZpQ: include $this->template('default/member/index'); goto jpezi; j_R8M: if (!($operation == 'search')) { goto NJEho; } goto d1xuI; u51GS: D3Xpr: goto nmiVq; GwO75: $operation = !empty($_GPC['op']) ? $_GPC['op'] : 'main'; goto SqxPJ; LiGcK: foreach ($memberList as $key => $value) { goto lfZJ2; lfZJ2: $memberList[$key]['create_time'] = date('Y-m-d', $value['create_time']); goto DCiFO; udASP: mAkGH: goto G23AU; n14Zp: $memberList[$key]['grouping_id'] = $value['grouping_id'] == 0 ? '默认分组' : $grouping['grouping_name']; goto udASP; z1_kg: $grouping = pdo_fetch('select * from ' . tablename('myxs_fodder_grouping') . ' where grouping_id = :grouping_id ', array(":grouping_id" => $value['grouping_id'])); goto n14Zp; DCiFO: $memberList[$key]['member_head_portrait'] = toimage($value['member_head_portrait']); goto z1_kg; G23AU: } goto u51GS; n1NGn: $memberListTotal = pdo_fetchcolumn('select count(*) from ' . tablename('myxs_fodder_member') . ' where uniacid = :uniacid  ' . $where . '  order by `member_id` desc', array(":uniacid" => $_W['uniacid'])); goto LiGcK; SqxPJ: $where = ''; goto j_R8M; WUwc3: $where .= " and member_name like '%{$search}%'"; goto dqHUd; d1xuI: $search = trim($_GPC['searchmess']); goto yNB2L; jpezi: } public function doWebMemberPost() { goto VWjIA; jSP3K: goto jmCdV; goto TM3j6; yeuQQ: if (!($_GPC['op'] == 'update')) { goto WC1DZ; } goto ZajLa; ZajLa: $sub = true; goto ZRD4R; vpPym: $operation = !empty($_GPC['op']) ? $_GPC['op'] : 'look'; goto RJoCG; sEwj3: include $this->template('default/member/post'); goto XU4A9; T87zG: $data['member_mobile'] = $_GPC['member_mobile']; goto rz51Z; Sbh9Q: message('删除成功！', referer(), 'success'); goto UyRVZ; R1hnT: message('会员头像不能为空！', $this->createWebUrl('MemberPost', array("op" => "update", "id" => $id)), 'error'); goto OTlNK; VWjIA: global $_W, $_GPC; goto Pkq0B; f6trc: if (!empty($row)) { goto XOsv3; } goto oXpPA; N9FzI: $member = pdo_fetch('select * from ' . tablename('myxs_fodder_member') . ' where member_id = :member_id', array(":member_id" => $id)); goto qjMxU; RJoCG: if ($operation == 'delete') { goto x0Swf; } goto u7zJ2; qjMxU: $groupingList = pdo_fetchall('select * from ' . tablename('myxs_fodder_grouping') . ' where uniacid = :uniacid ', array(":uniacid" => $_W['uniacid'])); goto yeuQQ; jRyZV: XOsv3: goto BwIsa; TSUaI: $data['create_time'] = strtotime($_GPC['create_time']); goto EEsjE; tby5_: message('会员更新成功！', $this->createWebUrl('MemberPost', array("op" => "update", "id" => $id)), 'success'); goto FCoSl; EEsjE: $data['is_system'] = intval($_GPC['is_system']); goto gqFdw; Pkq0B: $id = intval($_GPC['id']); goto vpPym; lg_PV: $id = intval($_GPC['id']); goto wZSmk; wZSmk: $row = pdo_fetch('SELECT * FROM ' . tablename('myxs_fodder_member') . ' WHERE member_id = :member_id', array(":member_id" => $id)); goto f6trc; BwIsa: pdo_update('myxs_fodder_member', array("member_status" => 0), array("member_id" => $id)); goto Sbh9Q; N2Zlg: if (!($_GPC['submit'] == '提交')) { goto sbld1; } goto C2ayh; u7zJ2: $sub = false; goto N9FzI; FCoSl: sbld1: goto jSP3K; ZRD4R: WC1DZ: goto N2Zlg; qD3eJ: message('会员昵称不能为空！', $this->createWebUrl('MemberPost', array("op" => "update", "id" => $id)), 'error'); goto JPMaU; TM3j6: x0Swf: goto lg_PV; cLOqH: if (!empty($data['member_head_portrait'])) { goto h2SDW; } goto R1hnT; JPMaU: gSuPL: goto cLOqH; C2ayh: $data = array(); goto qaWjj; HWDSs: $data['member_head_portrait'] = $_GPC['member_head_portrait']; goto T87zG; UyRVZ: jmCdV: goto sEwj3; qaWjj: $data['member_name'] = $_GPC['member_name']; goto HWDSs; gqFdw: if (!empty($data['member_name'])) { goto gSuPL; } goto qD3eJ; OTlNK: h2SDW: goto PTD4B; oXpPA: message('抱歉，会员不存在或是已经被删除！'); goto jRyZV; PTD4B: pdo_update('myxs_fodder_member', $data, array("member_id" => $_GPC['id'])); goto tby5_; rz51Z: $data['grouping_id'] = intval($_GPC['grouping_id']); goto TSUaI; XU4A9: } public function doWebRecycle() { goto UJWO2; kW2DZ: include $this->template('default/content/recycle'); goto JMm0S; wd7HO: $pindex = max(1, intval($_GPC['page'])); goto XkOLy; bhKV2: pdo_update('myxs_fodder_content', array("content_status" => 1), array("content_id" => $_GPC['id'])); goto T3Cyq; Nwf5e: $operation = $_GPC['op']; goto VZ5CK; XkOLy: $psize = 20; goto f3WEo; VZ5CK: $type = $_GPC['type']; goto wd7HO; wdqOf: $contentListTotal = pdo_fetchcolumn('select count(*) from ' . tablename('myxs_fodder_content') . ' where content_class = :content_class and uniacid = :uniacid order by `content_id` desc', array(":content_class" => 1, ":uniacid" => $_W['uniacid'])); goto rKMAr; rKMAr: $pager = pagination($contentListTotal, $pindex, $psize); goto HH3ud; JMm0S: gI9y7: goto i7E91; TzShx: goto H8Ggs; goto t4XpQ; jFFon: CPXF5: goto bhKV2; t4XpQ: ap_Li: goto tig46; TD7If: $contentList = pdo_fetchall('select * from ' . tablename('myxs_fodder_content') . ' where  content_status = :content_status and content_class = :content_class and uniacid = :uniacid  order by `content_id` desc LIMIT ' . ($pindex - 1) * $psize . ',' . $psize, array(":content_status" => 0, ":content_class" => 1, ":uniacid" => $_W['uniacid'])); goto WBMud; XMpsm: if ($type == 'delete') { goto ap_Li; } goto TD7If; dc4EX: H8Ggs: goto kW2DZ; IGqYB: qJxc6: goto wdqOf; HH3ud: goto H8Ggs; goto jFFon; UJWO2: global $_W, $_GPC; goto Nwf5e; WBMud: $class_status = array("删除", "显示", "隐藏"); goto E3Bnn; f3WEo: if (!($operation == 'content')) { goto gI9y7; } goto OHBKy; tig46: pdo_delete('myxs_fodder_content', array("content_id" => $_GPC['id'])); goto xue1s; T3Cyq: message('从回收站恢复内容成功！', $this->createWebUrl('Recycle', array("op" => "content")), 'success'); goto TzShx; E3Bnn: foreach ($contentList as $key => $value) { goto h7O0y; TEJA3: $contentList[$key]['content_status'] = $class_status[$value['content_status']]; goto c1T4d; CpNbP: $contentList[$key]['class_id'] = $Class['class_name']; goto TEJA3; u3y0J: bvSkV: goto UJztG; h7O0y: $Class = pdo_fetch('select * from ' . tablename('myxs_fodder_class') . ' where class_id = :class_id', array(":class_id" => $value['class_id'])); goto CpNbP; c1T4d: $contentList[$key]['create_time'] = date('Y-m-d H:i:s', $value['create_time']); goto u3y0J; UJztG: } goto IGqYB; xue1s: message('从回收站删除内容成功！', $this->createWebUrl('Recycle', array("op" => "content")), 'success'); goto dc4EX; OHBKy: if ($type == 'recovery') { goto CPXF5; } goto XMpsm; i7E91: } public function doWebGrouping() { goto PJjpo; TKsyO: S5vvV: goto QFByV; aUThJ: $pager = pagination($groupingListTotal, $pindex, $psize); goto zcX5G; PJjpo: global $_W, $_GPC; goto NFE4l; ut9In: $psize = 20; goto ZBpZh; OER43: foreach ($groupingList as $key => $value) { $groupingList[$key]['create_time'] = date('Y-m-d H:i:s', $value['create_time']); Qo7Gk: } goto TKsyO; NFE4l: $pindex = max(1, intval($_GPC['page'])); goto ut9In; QFByV: $groupingListTotal = pdo_fetchcolumn('select count(*) from ' . tablename('myxs_fodder_grouping') . ' where uniacid = :uniacid order by `grouping_id` desc', array(":uniacid" => $_W['uniacid'])); goto aUThJ; ZBpZh: $groupingList = pdo_fetchall('select * from ' . tablename('myxs_fodder_grouping') . ' where uniacid = :uniacid order by `grouping_id` desc LIMIT ' . ($pindex - 1) * $psize . ',' . $psize, array(":uniacid" => $_W['uniacid'])); goto OER43; zcX5G: include $this->template('default/grouping/index'); goto zlN43; zlN43: } public function doWebGroupingPost() { goto G5BXL; NyBtt: cFkPm: goto hZ9Ka; ioOzL: if (!($_GPC['op'] == 'add')) { goto WlgmO; } goto jrHya; GVO2H: pdo_update('myxs_fodder_grouping', $data, array("grouping_id" => $_GPC['id'])); goto lymOz; YfzRq: if (empty($grouping_passwd)) { goto opycx; } goto rcm8T; T_AZv: if ($operation == 'delete') { goto S_vRB; } goto S6CI5; nOuAu: jjSyl: goto ftqsX; hpxVX: goto cFkPm; goto WB239; qKIuH: $data = array(); goto ZSFzE; tmfSP: $id = intval($_GPC['id']); goto udBWD; zjnDg: $insertid = pdo_insert('myxs_fodder_grouping', $data); goto rDB6S; AxWJF: $row = pdo_fetch('SELECT * FROM ' . tablename('myxs_fodder_grouping') . ' WHERE grouping_id = :grouping_id', array(":grouping_id" => $id)); goto LSfCP; VygKv: message('请输入分组名称！'); goto AHcY5; jrHya: $sub = true; goto S_JTn; S6CI5: if ($operation == 'add') { goto Kr1Lz; } goto Fyl9M; viogf: message('输入分组邀请码重复！'); goto Gl10A; XtpHz: $data['create_time'] = time(); goto GVO2H; CszkP: goto cFkPm; goto ftnCY; W7YWL: opycx: goto oval0; G5BXL: global $_W, $_GPC; goto tmfSP; V4DFj: $content = pdo_fetch('select * from ' . tablename('myxs_fodder_grouping') . ' where grouping_id = :grouping_id', array(":grouping_id" => $id)); goto ODjWW; u448K: if (!($_GPC['submit'] == '提交')) { goto e9oOR; } goto mKPPh; H7hc2: $id = intval($_GPC['id']); goto AxWJF; tduTj: message('请输入分组邀请码！'); goto TWLlg; Gl10A: xVmjY: goto E6Akw; udBWD: $operation = !empty($_GPC['op']) ? $_GPC['op'] : 'look'; goto MPVRu; ZSFzE: $data['grouping_name'] = $_GPC['grouping_name']; goto HU_I8; HU_I8: $data['grouping_passwd'] = trim($_GPC['grouping_passwd']); goto XtpHz; Avla3: $data['grouping_passwd'] = trim($_GPC['grouping_passwd']); goto aUq_F; S_JTn: WlgmO: goto u448K; Iecv5: cr8SW: goto CszkP; lymOz: message('分组更新成功！', $this->createWebUrl('GroupingPost', array("op" => "update", "id" => $id)), 'success'); goto Iecv5; rDB6S: message('分组添加成功！', $this->createWebUrl('grouping'), 'success'); goto ylPth; WB239: Kr1Lz: goto ioOzL; tPJrq: if (empty($grouping_passwd)) { goto xVmjY; } goto viogf; bIKUY: message('抱歉，用户分组不存在或是已经被删除！'); goto nOuAu; AHcY5: QT0O2: goto m0HPO; rcm8T: message('输入分组邀请码重复！'); goto W7YWL; Fyl9M: $sub = false; goto V4DFj; ftqsX: pdo_delete('myxs_fodder_grouping', array("grouping_id" => $id)); goto smesD; lPGtA: $data['grouping_name'] = $_GPC['grouping_name']; goto Avla3; E6Akw: if (!($_GPC['submit'] == '提交')) { goto cr8SW; } goto qKIuH; ZZOiu: uZ7zH: goto tPJrq; aUq_F: $data['create_time'] = time(); goto MzRE1; oval0: $data = array(); goto lPGtA; ftnCY: S_vRB: goto H7hc2; TWLlg: o6bnK: goto YfzRq; pRd4e: $sub = true; goto ZZOiu; m0HPO: if (!empty($_GPC['grouping_passwd'])) { goto o6bnK; } goto tduTj; smesD: message('删除用户分组成功！', referer(), 'success'); goto hpxVX; MzRE1: $data['uniacid'] = $_W['uniacid']; goto zjnDg; MPVRu: $grouping_passwd = pdo_fetch('select * from ' . tablename('myxs_fodder_grouping') . ' where grouping_passwd = :grouping_passwd and uniacid = :uniacid', array(":grouping_passwd" => trim($_GPC['grouping_passwd']), ":uniacid" => $_W['uniacid'])); goto T_AZv; hZ9Ka: include $this->template('default/grouping/post'); goto nZs4U; ylPth: e9oOR: goto NyBtt; LSfCP: if (!empty($row)) { goto jjSyl; } goto bIKUY; ODjWW: if (!($_GPC['op'] == 'update')) { goto uZ7zH; } goto pRd4e; mKPPh: if (!empty($_GPC['grouping_name'])) { goto QT0O2; } goto VygKv; nZs4U: } public function doWebAdvert() { goto C2c6E; PQXLs: $advertListTotal = pdo_fetchcolumn('select count(*) from ' . tablename('myxs_fodder_advert') . ' where uniacid = :uniacid order by `advert_id` desc', array(":uniacid" => $_W['uniacid'])); goto bvAr6; HYV3H: $advertClass = array(1 => "流量主广告", 2 => "平台广告", 3 => "会员广告"); goto q6grB; bvAr6: $pager = pagination($advertListTotal, $pindex, $psize); goto Xcm82; d26g1: foreach ($advertList as $key => $value) { goto tk2A8; TYidc: $advertList[$key]['advert_position'] = $advertPosition[$value['advert_position']]; goto MxQkO; EEtYZ: tPyoA: goto ojBLb; MxQkO: $advertList[$key]['create_time'] = date('Y-m-d H:i:s', $value['create_time']); goto EEtYZ; tk2A8: $advertList[$key]['advert_class'] = $advertClass[$value['advert_class']]; goto TYidc; ojBLb: } goto gFUVI; di5R0: $psize = 20; goto HYV3H; gFUVI: BGZsY: goto PQXLs; q6grB: $advertPosition = array("member" => "会员中心", "content" => "广场", "member_set" => "会员设置"); goto hgTZm; Xcm82: include $this->template('default/advert/index'); goto jV61V; SZ2qZ: $pindex = max(1, intval($_GPC['page'])); goto di5R0; hgTZm: $advertList = pdo_fetchall('select * from ' . tablename('myxs_fodder_advert') . ' where uniacid = :uniacid order by `advert_id` desc LIMIT ' . ($pindex - 1) * $psize . ',' . $psize, array(":uniacid" => $_W['uniacid'])); goto d26g1; C2c6E: global $_W, $_GPC; goto SZ2qZ; jV61V: } public function doWebAdvertPost() { goto hvUNL; x5aIp: $data['advert_class'] = 1; goto K_nz2; uRKlv: $data['create_time'] = time(); goto M37Ll; V1tFQ: $data['advert_text'] = trim($_GPC['advert_text']); goto uRKlv; X6_5u: message('抱歉，广告不存在或是已经被删除！'); goto N5qLY; j9Edp: message('请输入广告位ID！'); goto WnF5t; ETRXi: w1ITR: goto KsBWG; z4nh7: $data['create_time'] = time(); goto ntHI3; hvUNL: global $_W, $_GPC; goto IpF3q; zfUwv: $sub = false; goto kYXfA; S0ZYK: $data['advert_name'] = $_GPC['advert_name']; goto RNbTg; KBT8q: if ($operation == 'delete') { goto JvJ3g; } goto FUMe9; KsBWG: if (!($_GPC['submit'] == '提交')) { goto iw7pR; } goto xPFE1; ntHI3: pdo_update('myxs_fodder_advert', $data, array("advert_id" => $_GPC['id'])); goto Z9BE3; lZ4RY: $id = intval($_GPC['id']); goto T8BiT; I6gZM: if (!empty($_GPC['advert_text'])) { goto ddzcW; } goto j9Edp; xPFE1: if (!empty($_GPC['advert_name'])) { goto siiXg; } goto HNF4A; xXrOg: if (!($_GPC['submit'] == '提交')) { goto jB7xT; } goto MfGAS; T8BiT: $row = pdo_fetch('SELECT * FROM ' . tablename('myxs_fodder_advert') . ' WHERE advert_id = :advert_id', array(":advert_id" => $id)); goto Rfmvt; M37Ll: $data['uniacid'] = $_W['uniacid']; goto JtGpR; Dtg1P: $advertPosition = array("member" => "会员中心", "content" => "广场", "member_set" => "会员设置"); goto odLEH; IpF3q: $id = intval($_GPC['id']); goto Dtg1P; svh6u: Qg14x: goto h23FS; k3vXl: siiXg: goto I6gZM; EReAt: jB7xT: goto m57bT; tptaD: goto Qg14x; goto Yp5Ux; DMOAm: if (!($_GPC['op'] == 'add')) { goto w1ITR; } goto qUfyL; bTibB: if (!($_GPC['op'] == 'update')) { goto gWQj4; } goto HbRfW; odLEH: $operation = !empty($_GPC['op']) ? $_GPC['op'] : 'look'; goto KBT8q; h23FS: include $this->template('default/advert/post'); goto ZWzAU; oWSTR: gWQj4: goto xXrOg; kYXfA: $content = pdo_fetch('select * from ' . tablename('myxs_fodder_advert') . ' where advert_id = :advert_id', array(":advert_id" => $id)); goto bTibB; mtype: $data['advert_text'] = trim($_GPC['advert_text']); goto z4nh7; WnF5t: ddzcW: goto P1JdY; N5qLY: U_O6o: goto KyuxG; HbRfW: $sub = true; goto oWSTR; K_nz2: $data['advert_position'] = trim($_GPC['advert_position']); goto V1tFQ; qUfyL: $sub = true; goto ETRXi; m57bT: goto Qg14x; goto TcX5i; OFqml: message('添加广告成功！', $this->createWebUrl('Advert'), 'success'); goto KrkT_; RNbTg: $data['advert_position'] = trim($_GPC['advert_position']); goto mtype; KrkT_: iw7pR: goto svh6u; JtGpR: $insertid = pdo_insert('myxs_fodder_advert', $data); goto OFqml; Yp5Ux: oSd9O: goto DMOAm; MfGAS: $data = array(); goto S0ZYK; KyuxG: pdo_delete('myxs_fodder_advert', array("advert_id" => $id)); goto j6djm; j6djm: message('删除广告成功！', referer(), 'success'); goto tptaD; P1JdY: $data = array(); goto LJ7OB; Rfmvt: if (!empty($row)) { goto U_O6o; } goto X6_5u; FUMe9: if ($operation == 'add') { goto oSd9O; } goto zfUwv; LJ7OB: $data['advert_name'] = $_GPC['advert_name']; goto x5aIp; TcX5i: JvJ3g: goto lZ4RY; HNF4A: message('请输入广告名称！'); goto k3vXl; Z9BE3: message('更新广告成功！', $this->createWebUrl('AdvertPost', array("op" => "update", "id" => $id)), 'success'); goto EReAt; ZWzAU: } } ?>