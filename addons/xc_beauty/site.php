<?php
 goto P2xy_; Mqd1Z: function xmlToArray($xml) { goto agg9G; agg9G: libxml_disable_entity_loader(true); goto nvz_G; nvz_G: $values = json_decode(json_encode(simplexml_load_string($xml, 'SimpleXMLElement', LIBXML_NOCDATA)), true); goto RDsZm; RDsZm: return $values; goto XZFM8; XZFM8: } goto K3k_U; i5NqT: function arrayToXml($arr) { goto t2YsH; WiAvw: foreach ($arr as $key => $val) { goto GnRCM; gzgBS: goto e78YP; goto cvGuJ; VBOrM: B6QKM: goto IdY2x; AHHjI: e78YP: goto VBOrM; c6xDL: $xml .= '<' . $key . '>' . arrayToXml($val) . '</' . $key . '>'; goto AHHjI; YvHGo: $xml .= '<' . $key . '>' . $val . '</' . $key . '>'; goto gzgBS; GnRCM: if (is_array($val)) { goto eMs2m; } goto YvHGo; cvGuJ: eMs2m: goto c6xDL; IdY2x: } goto sRC4x; PLZ0a: return $xml; goto xxw7b; t2YsH: $xml = '<root>'; goto WiAvw; sRC4x: dDK7F: goto H0ce6; H0ce6: $xml .= '</root>'; goto PLZ0a; xxw7b: } goto Mqd1Z; P2xy_: defined('IN_IA') or exit('Access Denied'); goto A_bEK; DfGXd: function vpost($url, $data) { goto Q9vRY; H0pEt: curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); goto qCuT_; EILEq: if (!curl_errno($curl)) { goto jtmI6; } goto r1xp8; WGgiQ: curl_setopt($curl, CURLOPT_POSTFIELDS, $data); goto Vs0Jt; Vs0Jt: curl_setopt($curl, CURLOPT_TIMEOUT, 30); goto pxwN_; QA4rw: curl_setopt($curl, CURLOPT_AUTOREFERER, 1); goto ei15g; AFAH4: return $tmpInfo; goto cZAn5; Sf3qy: curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, 0); goto AAyqM; Q9vRY: $curl = curl_init(); goto RBGds; qCuT_: $tmpInfo = curl_exec($curl); goto EILEq; BefYM: curl_setopt($curl, CURLOPT_USERAGENT, $_SERVER['HTTP_USER_AGENT']); goto Hhq4o; RBGds: curl_setopt($curl, CURLOPT_URL, $url); goto Sf3qy; pxwN_: curl_setopt($curl, CURLOPT_HEADER, 0); goto H0pEt; AAyqM: curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, 1); goto BefYM; r1xp8: echo 'Errno' . curl_error($curl); goto NrprZ; NrprZ: jtmI6: goto VWBtw; ei15g: curl_setopt($curl, CURLOPT_POST, 1); goto WGgiQ; Hhq4o: curl_setopt($curl, CURLOPT_FOLLOWLOCATION, 1); goto QA4rw; VWBtw: curl_close($curl); goto AFAH4; cZAn5: } goto YK2kJ; A_bEK: include_once IA_ROOT . '/addons/xc_beauty/common/function.php'; goto byetf; K3k_U: function juhecurl($url, $params = false, $ispost = 0) { goto PFUF0; dHEj0: curl_setopt($ch, CURLOPT_URL, $url); goto WFJKS; jyoF1: curl_setopt($ch, CURLOPT_TIMEOUT, 30); goto EMoPK; EMoPK: curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); goto Y1P7u; oDAbx: curl_close($ch); goto B1cgn; uZao4: j1Cyd: goto i91PA; dma1B: MFczx: goto KW8ch; NijDe: if (!($response === FALSE)) { goto KgkGy; } goto pkVbn; Enh0y: KgkGy: goto XXg81; mjYES: curl_setopt($ch, CURLOPT_URL, $url . '?' . $params); goto GOusO; c2qfI: $httpInfo = array_merge($httpInfo, curl_getinfo($ch)); goto oDAbx; cNUy2: goto MFczx; goto uZao4; Y1P7u: if ($ispost) { goto j1Cyd; } goto Yowqy; KW8ch: $response = curl_exec($ch); goto NijDe; gNXTD: $ch = curl_init(); goto TzLhQ; GOusO: UTvN8: goto cNUy2; pkVbn: return false; goto Enh0y; PFUF0: $httpInfo = array(); goto gNXTD; fx1sV: curl_setopt($ch, CURLOPT_USERAGENT, 'Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.22 (KHTML, like Gecko) Chrome/25.0.1364.172 Safari/537.22'); goto vaUEP; t8QYH: curl_setopt($ch, CURLOPT_POSTFIELDS, $params); goto patNW; TzLhQ: curl_setopt($ch, CURLOPT_HTTP_VERSION, CURL_HTTP_VERSION_1_1); goto fx1sV; B1cgn: return $response; goto XIw_O; vaUEP: curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 30); goto jyoF1; vzF38: he5xy: goto mjYES; i91PA: curl_setopt($ch, CURLOPT_POST, true); goto t8QYH; patNW: curl_setopt($ch, CURLOPT_URL, $url); goto dma1B; Yowqy: if ($params) { goto he5xy; } goto dHEj0; XXg81: $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE); goto c2qfI; WFJKS: goto UTvN8; goto vzF38; XIw_O: } goto X9Qca; X9Qca: function push($requestInfo, $url) { goto US4Si; qZIwc: $tmpInfo = curl_exec($curl); goto QBbvR; a4h5w: curl_setopt($curl, CURLOPT_FOLLOWLOCATION, 1); goto dh6Jv; alO6s: curl_setopt($curl, CURLOPT_HTTPHEADER, array("Expect:")); goto a4h5w; Sg92P: curl_close($curl); goto LgX7X; Yff9w: curl_setopt($curl, CURLOPT_POST, 1); goto ybmy2; WxaTq: curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, 0); goto alO6s; QBbvR: if (!curl_errno($curl)) { goto UkIZX; } goto ZCbqB; oFPv9: curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); goto qZIwc; F2jD_: curl_setopt($curl, CURLOPT_URL, $url); goto WxaTq; ZCbqB: echo 'Errno' . curl_error($curl); goto L1J4l; J317J: curl_setopt($curl, CURLOPT_TIMEOUT, 30); goto wXsM1; dh6Jv: curl_setopt($curl, CURLOPT_AUTOREFERER, 1); goto Yff9w; ybmy2: curl_setopt($curl, CURLOPT_POSTFIELDS, $requestInfo); goto J317J; L1J4l: UkIZX: goto Sg92P; LgX7X: return $tmpInfo; goto BDuqT; US4Si: $curl = curl_init(); goto F2jD_; wXsM1: curl_setopt($curl, CURLOPT_HEADER, 0); goto oFPv9; BDuqT: } goto prk4Q; byetf: class Xc_beautyModuleSite extends WeModuleSite { public function doWebWeb() { goto KHWcb; Sv3Ok: $tablename = 'xc_beauty_config'; goto ZTCQh; p96M6: $uniacid = $_W['uniacid']; goto b7OzJ; KU5vS: global $_GPC, $_W; goto p96M6; ZTCQh: switch ($op) { case 'edit': goto vgg1X; p5BRv: GCJtj: goto Kbkzx; M5gvy: if (!empty($list['content']['group_refund'])) { goto axIy_; } goto VthHs; rBXeR: LuVft: goto t8eV9; Fs0iC: $str = file_get_contents($text); goto nHGSD; Vpi_g: J6dhQ: goto M5gvy; PMs20: T3G8L: goto IWXY6; TWcfw: $text = '../addons/xc_beauty/resource/tiangong.txt'; goto FTZR9; YGIX4: wFGGx: goto rS2pz; jPc0G: if (!($i < 5)) { goto GCJtj; } goto Y9mUM; DysPT: $list = pdo_get($tablename, array("xkey" => $xkey, "uniacid" => $uniacid)); goto iVhjc; rS2pz: $i++; goto ykkuk; hjac4: $xkey = 'web'; goto DysPT; FTZR9: if (!is_file($text)) { goto T3G8L; } goto Fs0iC; ykkuk: goto R7vxz; goto p5BRv; qsQCU: v1SLX: goto PMs20; jN2O1: R7vxz: goto jPc0G; mx_g1: j_BHx: goto ES4Ow; KbEFz: $tiangong = 1; goto qsQCU; vgg1X: $xtitle = '网站配置'; goto hjac4; Kbkzx: goto J6dhQ; goto mx_g1; VthHs: $list['content']['group_refund'] = 1; goto bznpn; iVhjc: if (!$list) { goto LuVft; } goto tYQLa; IWXY6: include $this->template('Web/edit'); goto sy4ua; nHGSD: if (!(md5($str) == '9c723b18124c30c5fd0ec47513a8f375')) { goto v1SLX; } goto KbEFz; tYQLa: $list['content'] = json_decode($list['content'], true); goto rBXeR; wS124: $list['content']['footer'] = ''; goto GF_rE; CKvMb: $tiangong = -1; goto TWcfw; t8eV9: if (!empty($list['content']['footer'])) { goto j_BHx; } goto wS124; bznpn: axIy_: goto CKvMb; sy4ua: goto EcSge; goto vONtj; GF_rE: $i = 0; goto jN2O1; n81NQ: o2pNl: goto Vpi_g; ES4Ow: foreach ($list['content']['footer'] as &$x) { goto BFSLS; cLoiQ: BG6Mz: goto vzDBZ; Ygm3x: OzkSa: goto cLoiQ; BFSLS: if (!empty($x['status'])) { goto OzkSa; } goto SNEi_; SNEi_: $x['status'] = 1; goto Ygm3x; vzDBZ: } goto n81NQ; Y9mUM: $list['content']['footer'][$i] = array("icon" => "", "select" => "", "text" => "", "link" => "", "status" => 1); goto YGIX4; vONtj: case 'savemodel': goto PolhS; RLkqp: $content['home_status'] = -1; goto w9N81; MvlaG: if (!empty($_GPC['online_time'])) { goto YeO9l; } goto Mrb2R; WUDIi: $content['audit'] = $_GPC['audit']; goto JnUKM; wdiqq: ac3tb: goto x9cc2; bJQiy: AhI7v: goto MvlaG; O4XM7: $json = array("status" => -1, "msg" => "操作失败"); goto BR3Gl; E3xFj: $content['member_status'] = -1; goto gG1zs; cbdTF: if (!empty($_GPC['tiangong'])) { goto avp1u; } goto h0Ih4; eRs2S: $content['map_status'] = $_GPC['map_status']; goto kefvH; V1m7v: goto EcSge; goto wwVh5; c_tKE: goto PL3Cw; goto NbUBJ; EyJw3: $request = pdo_insert($tablename, $condition); goto PeUOy; FKLjj: CSnzq: goto bspXm; o7LKm: goto fIEyc; goto rL1W6; b1ZHG: $content['refund_status'] = -1; goto o7LKm; kErv1: $json = array("status" => 1, "msg" => "操作成功"); goto ygvO8; ZyzER: $content['AppSecret'] = $_GPC['AppSecret']; goto JyPdf; UUwIz: av7BH: goto jFM1x; dxB0k: if (!(!empty($footer) && is_array($footer))) { goto YfoRK; } goto NjURa; jFM1x: if (!empty($_GPC['ti_status'])) { goto TuqmS; } goto oUdPS; TDX7p: if (!empty($_GPC['member_status'])) { goto rh1_S; } goto E3xFj; zXFiR: rh1_S: goto kXNr1; VQikx: uT340: goto K2tRq; nzY2U: goto ZV0wf; goto UQFGA; a0Ft7: if (!empty($_GPC['mobile_status'])) { goto lSPrj; } goto usoby; ImxC4: fIEyc: goto a0Ft7; lNU4o: goto eihwu; goto xe_cU; uFB3d: prkdU: goto GOsu0; Fm_oc: if (!empty($_GPC['home_status'])) { goto hA4SK; } goto RLkqp; evPPr: $condition['content'] = json_encode($content); goto JYIRm; bspXm: if (!empty($_GPC['buy_sale_status'])) { goto RdbKt; } goto eCgfJ; ptgMD: goto IyG4S; goto hsvVr; XvsSU: ZV0wf: goto V1m7v; h0Ih4: $content['tiangong'] = -1; goto ptgMD; unxao: jFvOs: goto tBfsu; kIp27: $condition['name'] = $_GPC['name']; goto VLHnY; nNWxa: $content['group_time'] = $_GPC['group_time']; goto bJQiy; gAMPU: if ($list) { goto jFvOs; } goto EyJw3; x9cc2: $content['time_status'] = $_GPC['time_status']; goto QdOSp; zU11T: YfoRK: goto odHLR; tBfsu: $request = pdo_update($tablename, $condition, array("id" => $list['id'], "uniacid" => $uniacid)); goto VQikx; oUdPS: $content['ti_status'] = -1; goto lNU4o; JyPdf: $content['agent_id'] = $_GPC['agent_id']; goto z8Ikc; gG1zs: goto urJ6c; goto zXFiR; GlrnA: $content['store_change'] = -1; goto McBWG; aLbD2: eihwu: goto cbdTF; n9BN5: goto t49Wn; goto yagov; iYCqv: if (!empty($_GPC['refund_status'])) { goto cIFBv; } goto b1ZHG; s852J: t49Wn: goto iYCqv; BLZsW: if (!empty($_GPC['online_status'])) { goto zG3SX; } goto J__lI; Lj2YP: $content['AppKey'] = $_GPC['AppKey']; goto ZyzER; rkToe: goto av7BH; goto V0ZAD; rTC0T: hA4SK: goto FkES6; GOsu0: if (!empty($_GPC['map_status'])) { goto ZHg0_; } goto D0OVf; rL1W6: cIFBv: goto jhIuL; w9N81: goto R3Koh; goto rTC0T; NjURa: foreach ($footer as &$x) { goto jBa4j; kNGLX: VwZI3: goto Our3Q; W2Icu: $x['status'] = -1; goto Y7rtT; jBa4j: if (!empty($x['status'])) { goto aztZ2; } goto W2Icu; Y7rtT: aztZ2: goto kNGLX; Our3Q: } goto uteRZ; z8Ikc: $content['user_id'] = $_GPC['user_id']; goto D_h4p; sePTH: $content['time_status'] = -1; goto oSNAm; P_RTo: kQpj1: goto F4UYC; JnUKM: hSwfm: goto BLZsW; PVRDt: $content['group_time'] = -1; goto yook0; McBWG: goto CSnzq; goto T42TT; Jo3V1: $content['online_time'] = $_GPC['online_time']; goto P_RTo; odHLR: $content = array("title" => $_GPC['title'], "copyright" => $_GPC['copyright'], "footer" => $footer, "template_id" => $_GPC['template_id'], "online_simg" => $_GPC['online_simg'], "member_title" => $_GPC['member_title'], "coupon_text" => $_GPC['coupon_text'], "coupon_bg" => $_GPC['coupon_bg'], "rotate_bg" => $_GPC['rotate_bg'], "total_limit" => $_GPC['total_limit'], "group_refund" => $_GPC['group_refund'], "share_index_title" => $_GPC['share_index_title'], "share_index_img" => $_GPC['share_index_img'], "share_service_title" => $_GPC['share_service_title'], "share_service_img" => $_GPC['share_service_img'], "share_group_title" => $_GPC['share_group_title'], "share_group_img" => $_GPC['share_group_img'], "mobile_simg" => $_GPC['mobile_simg'], "mobile" => $_GPC['mobile'], "order_fail" => $_GPC['order_fail'], "order_do" => $_GPC['order_do'], "group_success" => $_GPC['group_success'], "group_fail" => $_GPC['group_fail'], "xcmessage" => $_GPC['xcmessage']); goto k78Ro; T42TT: pmLBm: goto gPGDu; kefvH: PL3Cw: goto TDX7p; nVlb5: $content['tiangong'] = $_GPC['tiangong']; goto Lj2YP; D_h4p: IyG4S: goto evPPr; U07hA: Xs5Qq: goto nNWxa; iYPq_: $condition['xkey'] = 'web'; goto kIp27; HKt0J: urJ6c: goto Fm_oc; ev8PY: lSPrj: goto xv68K; UQFGA: BkVUy: goto kErv1; hsvVr: avp1u: goto nVlb5; kXNr1: $content['member_status'] = $_GPC['member_status']; goto HKt0J; V0ZAD: RdbKt: goto oWr0f; ygvO8: echo json_encode($json); goto XvsSU; yook0: goto AhI7v; goto U07hA; yagov: zG3SX: goto e0nZr; oWr0f: $content['buy_sale_status'] = $_GPC['buy_sale_status']; goto UUwIz; jhIuL: $content['refund_status'] = $_GPC['refund_status']; goto ImxC4; S8POE: $content['ti_status'] = $_GPC['ti_status']; goto aLbD2; usoby: $content['mobile_status'] = -1; goto I3xjh; bKYVG: if (!empty($_GPC['time_status'])) { goto ac3tb; } goto sePTH; D1ZHR: goto kQpj1; goto rPXhk; Mrb2R: $content['online_time'] = -1; goto D1ZHR; eCgfJ: $content['buy_sale_status'] = -1; goto rkToe; D0OVf: $content['map_status'] = -1; goto c_tKE; NbUBJ: ZHg0_: goto eRs2S; e0nZr: $content['online_status'] = $_GPC['online_status']; goto s852J; F4UYC: if (!empty($_GPC['store_change'])) { goto pmLBm; } goto GlrnA; FkES6: $content['home_status'] = $_GPC['home_status']; goto RtNJl; PeUOy: goto uT340; goto unxao; BR3Gl: echo json_encode($json); goto nzY2U; xv68K: $content['mobile_status'] = $_GPC['mobile_status']; goto uFB3d; k78Ro: if (!empty($_GPC['audit'])) { goto f92TB; } goto nW81F; J__lI: $content['online_status'] = -1; goto n9BN5; VLHnY: $footer = $_GPC['footer']; goto dxB0k; cG474: if (!empty($_GPC['group_time'])) { goto Xs5Qq; } goto PVRDt; uteRZ: BLrnk: goto zU11T; RtNJl: R3Koh: goto bKYVG; oSNAm: goto C97F_; goto wdiqq; QdOSp: C97F_: goto cG474; vhWgP: f92TB: goto WUDIi; K2tRq: if (!empty($request)) { goto BkVUy; } goto O4XM7; fH5hQ: $condition['uniacid'] = $uniacid; goto iYPq_; I3xjh: goto prkdU; goto ev8PY; jrXvV: goto hSwfm; goto vhWgP; gPGDu: $content['store_change'] = $_GPC['store_change']; goto FKLjj; rPXhk: YeO9l: goto Jo3V1; nW81F: $content['audit'] = -1; goto jrXvV; xe_cU: TuqmS: goto S8POE; JYIRm: $list = pdo_get($tablename, array("xkey" => "web", "uniacid" => $uniacid)); goto gAMPU; PolhS: $condition = array(); goto fH5hQ; wwVh5: case 'map': goto VK_Cm; uS54m: if (!$list) { goto JO5T0; } goto OyXT2; TVMEM: include $this->template('Web/map'); goto OrVjM; OyXT2: $list['content'] = json_decode($list['content'], true); goto B1DbT; B1DbT: JO5T0: goto TVMEM; OrVjM: goto EcSge; goto bn7HM; FQKYg: $list = pdo_get($tablename, array("xkey" => $xkey, "uniacid" => $uniacid)); goto uS54m; VK_Cm: $xtitle = '网站配置'; goto Ip1Ys; Ip1Ys: $xkey = 'map'; goto FQKYg; bn7HM: case 'savemap': goto DFXcX; Xo7uT: $condition['xkey'] = 'map'; goto W3qQr; epK0m: ukHuX: goto I8H4H; s7xFw: $content['store'] = -1; goto yuZIL; gkZh0: if (!empty($request)) { goto ukHuX; } goto Al_iY; x60rN: goto MpGJq; goto cpqgj; W3qQr: $condition['name'] = $_GPC['name']; goto MQr6W; D2N9v: echo json_encode($json); goto ZmhYj; E033W: if (!empty($_GPC['store'])) { goto kP01j; } goto s7xFw; m3UJ_: $condition['content'] = json_encode($content); goto XcJ_8; d0NgG: goto EcSge; goto DXc0j; sJy42: S_e1C: goto m3UJ_; DFXcX: $condition = array(); goto xxyWH; uhABv: MpGJq: goto gkZh0; h28o2: echo json_encode($json); goto Xyfyt; yuZIL: goto S_e1C; goto Soxew; WSML8: if ($list) { goto ai7U9; } goto skt9E; MQr6W: $content = array("mobile" => $_GPC['mobile'], "address" => $_GPC['address'], "longitude" => $_GPC['longitude'], "latitude" => $_GPC['latitude']); goto E033W; cpqgj: ai7U9: goto IcSza; HUfXh: $content['store'] = $_GPC['store']; goto sJy42; Soxew: kP01j: goto HUfXh; I8H4H: $json = array("status" => 1, "msg" => "操作成功"); goto D2N9v; xxyWH: $condition['uniacid'] = $uniacid; goto Xo7uT; skt9E: $request = pdo_insert($tablename, $condition); goto x60rN; IcSza: $request = pdo_update($tablename, $condition, array("id" => $list['id'], "uniacid" => $uniacid)); goto uhABv; Xyfyt: goto DWLbH; goto epK0m; XcJ_8: $list = pdo_get($tablename, array("xkey" => "map", "uniacid" => $uniacid)); goto WSML8; ZmhYj: DWLbH: goto d0NgG; Al_iY: $json = array("status" => -1, "msg" => "操作失败"); goto h28o2; DXc0j: case 'sort': goto PY2SV; j8Uor: $list['content']['sort'][] = array("name" => "ad", "status" => 1); goto noWYB; a9r1l: $list['content'] = json_decode($list['content'], true); goto KC2bJ; li1rB: foreach ($list['content']['sort'] as &$x) { goto SoDlX; FcGu7: goto TKVMy; goto ovCu8; PGnFU: goto h6Nm2; goto Kma8S; lA4Ue: $pclass = 1; goto U1CGp; Vx_bt: bk_4R: goto hTDXx; U1CGp: h6Nm2: goto FcGu7; Kma8S: SoWPf: goto lA4Ue; HMlyE: $x['value'] = htmlspecialchars(json_encode($x['value'])); goto SEQB8; tHyC2: jbtnd: goto TeWyk; HRQOf: $nav = 1; goto BCpZ0; y8hQx: if (!($x['name'] == 'ad')) { goto bk_4R; } goto gWENo; gWENo: $ad = 1; goto Vx_bt; SoDlX: if ($x['name'] == 'display') { goto FoEb6; } goto e2ql0; e2ql0: if ($x['name'] == 'pclass') { goto SoWPf; } goto eXkWU; MYLe7: CqAxE: goto HRQOf; SEQB8: TKVMy: goto tHyC2; BCpZ0: YCWdJ: goto PGnFU; eXkWU: if ($x['name'] == 'nav') { goto CqAxE; } goto y8hQx; ovCu8: FoEb6: goto HMlyE; hTDXx: goto YCWdJ; goto MYLe7; TeWyk: } goto wDQFO; kzmHP: $xkey = 'sort'; goto YVVAC; gWHiG: if (!($nav == -1)) { goto BzfSK; } goto OhY9Z; MVR3H: include $this->template('Web/sort'); goto spq8D; wDQFO: BehDi: goto IWdSl; noWYB: DpfTs: goto XGrRo; PY2SV: $xtitle = '网站配置'; goto kzmHP; spq8D: goto EcSge; goto AH3Yc; TI4WP: $nav = -1; goto p2oMJ; XGrRo: CvheW: goto MVR3H; OhY9Z: $list['content']['sort'][] = array("name" => "nav", "status" => -1); goto Kcur9; UmeQ0: if (!($ad == -1)) { goto DpfTs; } goto j8Uor; IWdSl: if (!($pclass == -1)) { goto MIl1h; } goto fStOG; Kcur9: BzfSK: goto UmeQ0; YVVAC: $list = pdo_get($tablename, array("xkey" => $xkey, "uniacid" => $uniacid)); goto WxwJ4; fStOG: $list['content']['sort'][] = array("name" => "pclass", "status" => -1); goto Q6aNX; p2oMJ: $ad = -1; goto li1rB; KC2bJ: $pclass = -1; goto TI4WP; Q6aNX: MIl1h: goto gWHiG; WxwJ4: if (!$list) { goto CvheW; } goto a9r1l; AH3Yc: case 'savesort': goto YQj31; BbM2W: $condition['content'] = json_encode($content); goto E12Hk; YkeRi: goto EcSge; goto P2PIU; BeJeX: $json = array("status" => -1, "msg" => "操作失败"); goto Mi8c3; s9f2B: goto n5jUb; goto l4YEW; SEaq6: $request = pdo_update($tablename, $condition, array("id" => $list['id'], "uniacid" => $uniacid)); goto gqSaL; rCJJB: $condition['xkey'] = 'sort'; goto TkGr0; tX5FT: zECwJ: goto XN7Ui; F28_R: echo json_encode($json); goto iG2Ma; X0ljy: if (!empty($request)) { goto zECwJ; } goto BeJeX; l4YEW: wexXa: goto SEaq6; TkGr0: $condition['name'] = $_GPC['name']; goto CfGYv; E12Hk: $list = pdo_get($tablename, array("xkey" => "sort", "uniacid" => $uniacid)); goto z8sP0; iG2Ma: Ji9KU: goto YkeRi; gqSaL: n5jUb: goto X0ljy; XN7Ui: $json = array("status" => 1, "msg" => "操作成功"); goto F28_R; YQj31: $condition = array(); goto k6K6Q; K6M3o: goto Ji9KU; goto tX5FT; k6K6Q: $condition['uniacid'] = $uniacid; goto rCJJB; z8sP0: if ($list) { goto wexXa; } goto E7dWh; E7dWh: $request = pdo_insert($tablename, $condition); goto s9f2B; CfGYv: $content = array("sort" => json_decode(htmlspecialchars_decode($_GPC['sort']), true)); goto BbM2W; Mi8c3: echo json_encode($json); goto K6M3o; P2PIU: case 'sort_service': goto p1Nb8; cI4Aa: bYHji: goto OvpqH; qTeDH: goto bfjH5; goto E6xdO; nunXf: $condition['cid'] = $_GPC['cid']; goto gb5nQ; Rop7d: if (!$list) { goto bYHji; } goto tObai; XOEK6: if (!$class) { goto W94f7; } goto Tz427; pE_zd: $condition['name LIKE'] = '%' . $_GPC['xname'] . '%'; goto AkQqG; x0VpG: enHHR: goto TyLeD; ASlEj: if (empty($_GPC['xname'])) { goto bRqp7; } goto pUXVF; zX18r: $list = pdo_getall('xc_beauty_service', $condition, array(), '', 'sort DESC,createtime DESC', array($pageindex, $pagesize)); goto HMQej; TyLeD: W94f7: goto Rop7d; E6xdO: VqXy5: goto ifPHM; sOb7V: if (empty($_GPC['cid'])) { goto e_EaB; } goto kQRL5; GQDys: $condition['uniacid'] = $uniacid; goto ASlEj; KSIBX: $pageindex = intval($_GPC['page']); goto qTeDH; t9GLO: bfjH5: goto BDROU; ifPHM: $pageindex = 1; goto t9GLO; tObai: foreach ($list as &$y) { $y['cidname'] = $datalist[$y['cid']]; ySRrE: } goto btQUp; gb5nQ: e_EaB: goto PUOP2; pUXVF: $xname = $_GPC['xname']; goto pE_zd; kQRL5: $cid = $_GPC['cid']; goto nunXf; BDROU: $pagesize = 6; goto G8jTv; Jtu1H: if (!isset($_GPC['page'])) { goto VqXy5; } goto KSIBX; btQUp: VNRtz: goto cI4Aa; HMQej: $class = pdo_getall('xc_beauty_service_class', array("status" => 1, "uniacid" => $uniacid), array(), '', 'sort DESC,createtime DESC'); goto WfryX; OvpqH: include $this->template('Web/sort_service'); goto ihnsN; p1Nb8: $condition = array(); goto GQDys; ihnsN: goto EcSge; goto kbFvZ; Tz427: foreach ($class as $x) { $datalist[$x['id']] = $x['name']; bZ0VG: } goto x0VpG; Hmp5N: $total = count($request); goto Jtu1H; AkQqG: bRqp7: goto sOb7V; PUOP2: $request = pdo_getall('xc_beauty_service', $condition); goto Hmp5N; WfryX: $datalist = array(); goto XOEK6; G8jTv: $pager = pagination($total, $pageindex, $pagesize); goto zX18r; kbFvZ: case 'sms': goto nQdXr; aM8ej: $list['content']['type'] = 1; goto qXZPQ; WYXwj: if (!empty($list['content']['type'])) { goto ePlTj; } goto aM8ej; tc2np: $xkey = 'sms'; goto LodPH; qXZPQ: ePlTj: goto Fi9aL; Fi9aL: include $this->template('Web/sms'); goto v1lUm; g2izF: $list['content'] = json_decode($list['content'], true); goto Wo9MO; v1lUm: goto EcSge; goto EMFyX; LodPH: $list = pdo_get($tablename, array("xkey" => $xkey, "uniacid" => $uniacid)); goto y5Nhe; nQdXr: $xtitle = '网站配置'; goto tc2np; Wo9MO: KcuIf: goto WYXwj; y5Nhe: if (!$list) { goto KcuIf; } goto g2izF; EMFyX: case 'savesms': goto qEFBL; PnXXz: $condition['content'] = json_encode($content); goto x4kLf; bjnVN: $content['status'] = -1; goto sJzx7; c2Ass: if (!empty($_GPC['status'])) { goto gg8TF; } goto bjnVN; E6M5E: $condition['name'] = $_GPC['name']; goto YrF5W; a33QC: QveXx: goto m1DSe; bJngK: $content['status'] = $_GPC['status']; goto rauX0; fSzei: goto QveXx; goto Q_sgz; rauX0: V4xVe: goto PnXXz; x4kLf: $list = pdo_get($tablename, array("xkey" => "sms", "uniacid" => $uniacid)); goto sDDpT; yG8qu: goto mooFO; goto zf9eY; HSUa9: mooFO: goto wB1rv; CgDcF: $json = array("status" => -1, "msg" => "操作失败"); goto i7LMm; YrF5W: $content = array("AccessKeyId" => $_GPC['AccessKeyId'], "AccessKeySecret" => $_GPC['AccessKeySecret'], "sign" => $_GPC['sign'], "code" => $_GPC['code'], "mobile" => $_GPC['mobile'], "type" => $_GPC['type'], "key" => $_GPC['key'], "tpl_id" => $_GPC['tpl_id'], "url" => $_GPC['url'], "customize" => json_decode(htmlspecialchars_decode($_GPC['customize']), true), "post" => json_decode(htmlspecialchars_decode($_GPC['post']), true), "get" => json_decode(htmlspecialchars_decode($_GPC['get']), true)); goto c2Ass; oHjYW: gg8TF: goto bJngK; pIvgp: echo json_encode($json); goto HSUa9; RGmFL: $request = pdo_insert($tablename, $condition); goto fSzei; qEFBL: $condition = array(); goto Ba6Ax; Ba6Ax: $condition['uniacid'] = $uniacid; goto rl1LZ; zf9eY: C8zPe: goto LOTge; rl1LZ: $condition['xkey'] = 'sms'; goto E6M5E; Q_sgz: HEkHz: goto C2ycU; C2ycU: $request = pdo_update($tablename, $condition, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto a33QC; sDDpT: if ($list) { goto HEkHz; } goto RGmFL; LOTge: $json = array("status" => 1, "msg" => "操作成功"); goto pIvgp; sJzx7: goto V4xVe; goto oHjYW; m1DSe: if (!empty($request)) { goto C8zPe; } goto CgDcF; wB1rv: goto EcSge; goto QUC9l; i7LMm: echo json_encode($json); goto yG8qu; QUC9l: case 'theme': goto J_RAA; sp4mw: $list['content']['theme'] = 1; goto Dj7ea; s20Gg: iUU5w: goto u15pg; t60Yo: goto EcSge; goto uMjoo; R8QiZ: Fob3t: goto HoKo_; Y83C1: $list = pdo_get($tablename, array("xkey" => $xkey, "uniacid" => $uniacid)); goto TQD2D; TQD2D: if ($list) { goto Fob3t; } goto sp4mw; aX_Dz: $xkey = 'theme'; goto Y83C1; J_RAA: $xtitle = '网站配置'; goto aX_Dz; Dj7ea: goto iUU5w; goto R8QiZ; HoKo_: $list['content'] = json_decode($list['content'], true); goto s20Gg; u15pg: include $this->template('Web/theme'); goto t60Yo; uMjoo: case 'savetheme': goto E1Hur; Af0bj: if (empty($_GPC['color'])) { goto nJ00g; } goto ob_uz; gYMuJ: $content['color'] = '#e74479'; goto Gm2Mf; BP413: $content['icon'] = $_GPC['icon']; goto eheNe; ob_uz: $content['color'] = $_GPC['color']; goto NUm3S; EiFKj: echo json_encode($json); goto Nl2kl; orN5A: $json = array("status" => 1, "msg" => "操作成功"); goto EiFKj; DiJyO: $request = pdo_insert($tablename, $condition); goto nnETd; nnETd: goto v8n7s; goto UK20S; HIA27: $request = pdo_update($tablename, $condition, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto G5RLM; UK20S: uttPO: goto HIA27; s76Nt: $content = array("theme" => $_GPC['theme']); goto mTuAt; NT4pR: if ($list) { goto uttPO; } goto DiJyO; rlmCh: $list = pdo_get($tablename, array("xkey" => "theme", "uniacid" => $uniacid)); goto NT4pR; EgTd0: if (!empty($request)) { goto BzDdV; } goto ad65h; cq3e6: echo json_encode($json); goto s10OE; NUm3S: goto VNOeP; goto hKjYf; s10OE: goto m6FQm; goto XM06e; JOR30: $condition['name'] = $_GPC['name']; goto s76Nt; eheNe: KZUM7: goto SK5sm; mTuAt: if (!($_GPC['theme'] == 2)) { goto KZUM7; } goto Af0bj; CWrZe: $condition['xkey'] = 'theme'; goto JOR30; Gm2Mf: VNOeP: goto BP413; Xextv: $condition['uniacid'] = $uniacid; goto CWrZe; SK5sm: $condition['content'] = json_encode($content); goto rlmCh; G5RLM: v8n7s: goto EgTd0; ad65h: $json = array("status" => -1, "msg" => "操作失败"); goto cq3e6; UPirc: goto EcSge; goto Xw9WC; hKjYf: nJ00g: goto gYMuJ; XM06e: BzDdV: goto orN5A; Nl2kl: m6FQm: goto UPirc; E1Hur: $condition = array(); goto Xextv; Xw9WC: case 'smstest': goto z_s1G; xdG_Q: $content = juhecurl($sendUrl, $smsConf, 1); goto CLKAu; jPlsr: WXolF: goto Z1uuo; bdBHP: goto WXolF; goto HExTo; q6Nyx: echo json_encode($result); goto jPlsr; I5FLv: if (!($_GPC['type'] == 2)) { goto LWW7_; } goto et7gC; udeKE: $sendUrl = 'http://v.juhe.cn/sms/send'; goto GNQZT; EV6cS: EV_ae: goto QAH2Y; u7NoT: $send = new sms(); goto xg_d8; HhQpw: header('Content-Type: text/plain; charset=utf-8'); goto NCbHR; CPjIU: echo json_encode($result); goto EV6cS; OjosQ: $error_code = $result['error_code']; goto CPjIU; ti4oY: set_time_limit(0); goto HhQpw; sgJ1t: echo json_encode('请求发送短信失败'); goto rbQsu; QAH2Y: LWW7_: goto bdBHP; Z1uuo: goto EcSge; goto a4n8h; rbQsu: goto EV_ae; goto Whm_U; z_s1G: if ($_GPC['type'] == 1) { goto wRGgK; } goto I5FLv; HExTo: wRGgK: goto Jv5Bv; CLKAu: if ($content) { goto FcWMv; } goto sgJ1t; GNQZT: $smsConf = array("key" => $_GPC['key'], "mobile" => $_GPC['mobile'], "tpl_id" => $_GPC['tpl_id'], "tpl_value" => '#webnamex#=美容&#trade#=1220171127101100000017&#amount#=199元&#namex#=张三&#phonex#=18888888888&#addrx#=中国北京&#datex#=' . date('Y-m-d H:i')); goto xdG_Q; xg_d8: $result = $send->sendSms($_GPC['AccessKeyId'], $_GPC['AccessKeySecret'], $_GPC['sign'], $_GPC['code'], $_GPC['mobile'], $templateParam); goto q6Nyx; NCbHR: $templateParam = array("webnamex" => "美容", "trade" => "20171127101100000017", "amount" => "199元", "namex" => "张三", "phonex" => "18888888888", "addrx" => "中国北京", "datex" => date('Y-m-d H:i'), "service" => "买蛋糕", "store" => "门店"); goto u7NoT; Jv5Bv: require_once IA_ROOT . '/addons/xc_beauty/resource/sms/sendSms.php'; goto ti4oY; Whm_U: FcWMv: goto ht0qt; et7gC: header('content-type:text/html;charset=utf-8'); goto udeKE; ht0qt: $result = json_decode($content, true); goto OjosQ; a4n8h: case 'print': goto ysq9g; jCoDB: $list['content'] = json_decode($list['content'], true); goto yv7q1; H76Ya: goto EcSge; goto ogQfD; ysq9g: $xtitle = '网站配置'; goto J0kuT; KpklV: if (!$list) { goto BmYBY; } goto jCoDB; J0kuT: $xkey = 'print'; goto hyyB1; RLwOS: include $this->template('Web/print'); goto H76Ya; hyyB1: $list = pdo_get($tablename, array("xkey" => $xkey, "uniacid" => $uniacid)); goto KpklV; yv7q1: BmYBY: goto RLwOS; ogQfD: case 'saveprint': goto QLXvE; FpEgt: goto Q8Yem; goto bwBhV; UQSbN: $content = array("apikey" => $_GPC['apikey'], "machine_code" => $_GPC['machine_code'], "msign" => $_GPC['msign'], "partner" => $_GPC['partner'], "type" => $_GPC['type'], "user" => $_GPC['user'], "ukey" => $_GPC['ukey'], "sn" => $_GPC['sn']); goto F8c6d; Py2kh: $content['status'] = -1; goto FpEgt; YD4F_: X67tO: goto Wlb_z; lPWRZ: echo json_encode($json); goto Frkmb; ev7b_: $json = array("status" => -1, "msg" => "操作失败"); goto v8ang; owcS4: if ($list) { goto X67tO; } goto xMtjz; Frkmb: XkEP2: goto RLJNb; F8c6d: if (!empty($_GPC['status'])) { goto qRSk1; } goto Py2kh; HMgLp: $condition['content'] = json_encode($content); goto GCEPG; Wlb_z: $request = pdo_update($tablename, $condition, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto uFxRE; y4W3u: $content['status'] = $_GPC['status']; goto kYWrv; gYxqR: $condition['uniacid'] = $uniacid; goto mTFLD; LixgN: LPQim: goto fw5FI; v8ang: echo json_encode($json); goto vVPbO; S6JhK: if (!empty($request)) { goto LPQim; } goto ev7b_; bwBhV: qRSk1: goto y4W3u; GCEPG: $list = pdo_get($tablename, array("xkey" => "print", "uniacid" => $uniacid)); goto owcS4; xMtjz: $request = pdo_insert($tablename, $condition); goto K4T80; uFxRE: mP8n4: goto S6JhK; K4T80: goto mP8n4; goto YD4F_; fw5FI: $json = array("status" => 1, "msg" => "操作成功"); goto lPWRZ; kYWrv: Q8Yem: goto HMgLp; vVPbO: goto XkEP2; goto LixgN; QLXvE: $condition = array(); goto gYxqR; mTFLD: $condition['xkey'] = 'print'; goto DMXEl; RLJNb: goto EcSge; goto I9NC4; DMXEl: $condition['name'] = $_GPC['name']; goto UQSbN; I9NC4: case 'printtest': goto Uskjd; uT_MW: $content .= '</table>'; goto jWp9N; cOJB8: $request = wp_print(SN, $orderInfo, 1); goto pMOFC; Yd08p: $time = time(); goto P0Z5u; Uskjd: if ($_GPC['type'] == 1) { goto NKO4Z; } goto WYLJn; cnhrU: NKO4Z: goto PN23Z; Vnata: Fmsto: goto y_Vl_; PN23Z: $partner = $_GPC['partner']; goto HbANk; HJUMD: $content .= '<tr><td>订单号：1111111111</td></tr>'; goto uT_MW; HbANk: $apikey = $_GPC['apikey']; goto OXnV0; OXnV0: $machine_code = $_GPC['machine_code']; goto snWev; gzq43: $requestUrl = 'http://open.10ss.net:8888'; goto RCoZO; fyKlY: $orderInfo .= '蛋炒饭　　　　 10.0   100 100.0<BR>'; goto FZ_Tx; O7mIq: $orderInfo .= '合计：xx.0元<BR>'; goto NTLVe; o47hx: define('SIG', sha1(USER . UKEY . STIME)); goto DS9ZC; WYLJn: if (!($_GPC['type'] == 2)) { goto h9ZnL; } goto YBo_6; R5TNi: $request = push($requestInfo, $requestUrl); goto TZpXv; dlOqf: $orderInfo .= '联系电话：13888888888888<BR>'; goto Bssp1; RCoZO: $requestAll = ["partner" => $partner, "machine_code" => $machine_code, "time" => $time, "content" => $content, "sign" => $sign]; goto JCAPa; pMOFC: echo $request; goto KBsdk; oLetu: $orderInfo .= '备注：加辣<BR>'; goto i4Bg1; i4Bg1: $orderInfo .= '--------------------------------<BR>'; goto O7mIq; gVRzY: $orderInfo .= '炒饭　　　　　 10.0   10  10.0<BR>'; goto fyKlY; TZpXv: echo $request; goto Vnata; a5xkY: goto Fmsto; goto cnhrU; Q48YX: define('SN', $_GPC['sn']); goto Kh7_5; Bssp1: $orderInfo .= '订餐时间：2014-08-08 08:08:08<BR>'; goto UMRpv; Rdube: define('PATH', '/Api/Open/'); goto T4chS; Kh7_5: define('IP', 'api.feieyun.cn'); goto It1IB; XUys3: $orderInfo .= '西红柿鸡蛋炒饭 15.0   1   15.0<BR>'; goto oLetu; KBsdk: h9ZnL: goto a5xkY; FZ_Tx: $orderInfo .= '鸡蛋炒饭　　　 100.0  100 100.0<BR>'; goto D9_u1; rw_PZ: $orderInfo .= '西红柿蛋炒饭　 100.0  100 100.0<BR>'; goto XUys3; T4chS: define('STIME', time()); goto o47hx; snWev: $msign = $_GPC['msign']; goto Yd08p; P0Z5u: $content = ''; goto aobJp; MgXNV: $orderInfo .= '名称　　　　　 单价  数量 金额<BR>'; goto K0lOG; y_Vl_: goto EcSge; goto FSqlv; K0lOG: $orderInfo .= '--------------------------------<BR>'; goto UCgov; jWp9N: $sign = strtoupper(md5($_GPC['apikey'] . 'machine_code' . $_GPC['machine_code'] . 'partner' . $_GPC['partner'] . 'time' . $time . $msign)); goto gzq43; UMRpv: $orderInfo .= '<QR>http://www.dzist.com</QR>'; goto cOJB8; JCAPa: $requestInfo = http_build_query($requestAll); goto R5TNi; It1IB: define('PORT', 80); goto Rdube; D9_u1: $orderInfo .= '西红柿炒饭　　 1000.0 1   100.0<BR>'; goto rw_PZ; UCgov: $orderInfo .= '饭　　　　　 　10.0   10  10.0<BR>'; goto gVRzY; aobJp: $content .= '<table>'; goto HJUMD; eApr0: define('USER', $_GPC['user']); goto X4_bo; NTLVe: $orderInfo .= '送货地点：广州市南沙区xx路xx号<BR>'; goto dlOqf; DS9ZC: $orderInfo = '<CB>测试打印</CB><BR>'; goto MgXNV; X4_bo: define('UKEY', $_GPC['ukey']); goto Q48YX; YBo_6: include IA_ROOT . '/addons/xc_beauty/resource/HttpClient.class.php'; goto eApr0; FSqlv: case 'refund': goto NBkjL; N710r: $xkey = 'refund'; goto AxeeR; Tqefw: if (empty($list['content']['cert'])) { goto SYl3a; } goto bqFr5; ncLvj: if (!($i < $cert_count)) { goto b6ecJ; } goto XzVmh; G1bxG: $i++; goto KLprY; XzVmh: $list['content']['cert'] = $list['content']['cert'] . '*'; goto AW0M4; vReY1: $i = 0; goto EHnnb; AW0M4: XVIcf: goto G1bxG; bNMuy: yz8KJ: goto IXVKc; EHnnb: O_YHw: goto UnYP_; aMp2g: xD9J5: goto cjkMy; uPg3k: $cert_count = strlen($list['content']['key']); goto Wx0cR; BkXS7: $i++; goto RHz95; KLprY: goto bbbIC; goto Z3mzS; Z3mzS: b6ecJ: goto ytKzK; RHz95: goto O_YHw; goto bNMuy; bqFr5: $cert_count = strlen($list['content']['cert']); goto Jqzvu; Zftzd: if (!$list) { goto xD9J5; } goto VOM_I; VOM_I: $list['content'] = json_decode($list['content'], true); goto Tqefw; ytKzK: SYl3a: goto JGx3O; qalHO: bbbIC: goto ncLvj; Gw0R9: $list['content']['key'] = $list['content']['key'] . '*'; goto Tr5kc; NBkjL: $xtitle = '网站配置'; goto N710r; Tr5kc: s_LUY: goto BkXS7; UnYP_: if (!($i < $cert_count)) { goto yz8KJ; } goto Gw0R9; Wx0cR: $list['content']['key'] = ''; goto vReY1; Jqzvu: $list['content']['cert'] = ''; goto nhi1T; nhi1T: $i = 0; goto qalHO; AxeeR: $list = pdo_get($tablename, array("xkey" => $xkey, "uniacid" => $uniacid)); goto Zftzd; IXVKc: oCilZ: goto aMp2g; iMuxC: goto EcSge; goto TbsQe; JGx3O: if (empty($list['content']['key'])) { goto oCilZ; } goto uPg3k; cjkMy: include $this->template('Web/refund'); goto iMuxC; TbsQe: case 'saverefund': goto X2rNz; dXkvl: qFVS7: goto aZ2yn; icaLl: G8NcY: goto cPTsi; bZwII: goto coHtA; goto Yuq52; Dzl9c: FbeLI: goto NoLIq; C_JVq: if (!empty($request)) { goto C_kuI; } goto UHjnv; Oy0YN: if ($cert == $_GPC['cert']) { goto g8bOw; } goto Egw7V; I9FBj: $content = array(); goto mlCgy; H8Zte: $cert = ''; goto PM51d; GZt2j: a_UFy: goto C_JVq; MtsZJ: if (empty($_GPC['id'])) { goto Y5aXN; } goto I9FBj; cWTrW: $request = pdo_update($tablename, $condition, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto GZt2j; O4kJo: J5KAU: goto lwzo2; Egw7V: $content['cert'] = $_GPC['cert']; goto Glurr; lkL0l: $key = $key . '*'; goto i_KTO; lwzo2: goto EcSge; goto JwxqV; KEYZa: $json = array("status" => 1, "msg" => "操作成功"); goto AdMYP; Igg09: echo json_encode($json); goto usKjK; aZ2yn: if ($key == $_GPC['key']) { goto BHJJa; } goto zT5dq; Yuq52: BHJJa: goto k6FAm; zFT3y: g8bOw: goto pg2Ic; k6FAm: $content['key'] = $dddd['content']['key']; goto GRyZX; S8dlh: Aq53j: goto DaMbo; pThef: sGlT5: goto yX4d_; sRekx: $cert_count = strlen($dddd['content']['key']); goto p0n5n; X2rNz: $condition = array(); goto fdFXF; QBVm_: goto a_UFy; goto WDbZm; pg2Ic: $content['cert'] = $dddd['content']['cert']; goto a5zV4; Glurr: goto WZk1_; goto zFT3y; fdFXF: $condition['uniacid'] = $uniacid; goto d5FpV; PM51d: $i = 0; goto S8dlh; VrKUH: $cert_count = strlen($dddd['content']['cert']); goto H8Zte; GRyZX: coHtA: goto qM9q1; U6KfP: jfxuc: goto Oy0YN; d5FpV: $condition['xkey'] = 'refund'; goto ha_dw; i_KTO: iymX1: goto Zbx1L; DaMbo: if (!($i < $cert_count)) { goto jfxuc; } goto NSUcW; NSUcW: $cert = $cert . '*'; goto Dzl9c; cQEXC: C_kuI: goto KEYZa; usKjK: goto J5KAU; goto cQEXC; n9EXu: Y5aXN: goto hy_r5; yX4d_: $condition['content'] = json_encode($content); goto qreu5; AdMYP: echo json_encode($json); goto O4kJo; UHjnv: $json = array("status" => -1, "msg" => "操作失败"); goto Igg09; nBwXs: $i = 0; goto icaLl; WDbZm: m_zQo: goto cWTrW; a5zV4: WZk1_: goto sRekx; c8pxc: $request = pdo_insert($tablename, $condition); goto QBVm_; NoLIq: $i++; goto vO10T; Zbx1L: $i++; goto M8nJP; LrTUX: $dddd['content'] = json_decode($dddd['content'], true); goto VrKUH; zT5dq: $content['key'] = $_GPC['key']; goto bZwII; ha_dw: $condition['name'] = $_GPC['name']; goto MtsZJ; p0n5n: $key = ''; goto nBwXs; mlCgy: $dddd = pdo_get($tablename, array("xkey" => "refund", "uniacid" => $uniacid)); goto LrTUX; pqRe1: if ($list) { goto m_zQo; } goto c8pxc; M8nJP: goto G8NcY; goto dXkvl; qreu5: $list = pdo_get($tablename, array("xkey" => "refund", "uniacid" => $uniacid)); goto pqRe1; hy_r5: $content = array("cert" => $_GPC['cert'], "key" => $_GPC['key']); goto pThef; cPTsi: if (!($i < $cert_count)) { goto qFVS7; } goto lkL0l; qM9q1: goto sGlT5; goto n9EXu; vO10T: goto Aq53j; goto U6KfP; JwxqV: case 'card': goto Ikixf; Ikixf: $xtitle = '网站配置'; goto vfu2n; vfu2n: $xkey = 'card'; goto SzUAc; J9QNG: goto EcSge; goto I3aPN; SzUAc: $list = pdo_get($tablename, array("xkey" => $xkey, "uniacid" => $uniacid)); goto q6zuK; w0LmA: $list['content'] = json_decode($list['content'], true); goto JzNz9; ztamZ: include $this->template('Web/card'); goto J9QNG; q6zuK: if (!$list) { goto DY2EM; } goto w0LmA; JzNz9: DY2EM: goto ztamZ; I3aPN: case 'savecard': goto DvDgB; rLY5e: if (!empty($_GPC['discount_status'])) { goto j1xkV; } goto e73vx; JusPC: $condition['content']['code_status'] = $_GPC['code_status']; goto TCEo3; VK1ka: if (!empty($_GPC['score_status'])) { goto DtH3q; } goto DbKDZ; EIUMC: $condition['uniacid'] = $uniacid; goto oA1wj; Bs9FM: $condition['content']['level_status'] = -1; goto UbZh4; I05oK: $json = array("status" => 1, "msg" => "操作成功"); goto tGaSY; IXnv0: $condition['content'] = json_encode($condition['content']); goto VmwgS; tGaSY: echo json_encode($json); goto RJYX_; mFSiI: $condition['content']['code_status'] = -1; goto r0cQ4; u2OYl: yxqmu: goto I05oK; zK6GI: $json = array("status" => -1, "msg" => "操作失败"); goto EdThx; hLHTR: $condition['content']['withdraw'] = -1; goto Vqxdd; GAqxy: $condition['content']['level_status'] = $_GPC['level_status']; goto jKWQO; NZzfK: $condition['content']['score_status'] = $_GPC['score_status']; goto wAm47; RJYX_: Blf8_: goto cy5Se; u_Bu8: if (!empty($_GPC['withdraw'])) { goto FUWg3; } goto hLHTR; r0cQ4: goto k18lx; goto TNf6o; Ffi3I: FUWg3: goto UdyxO; nanT_: goto W2YFv; goto ynv3U; DbKDZ: $condition['content']['score_status'] = -1; goto IHtNY; sXF1w: ftcaz: goto VK1ka; qzVXN: $condition['content'] = array("card" => $_GPC['card'], "card_on" => $_GPC['card_on'], "card_rules" => $_GPC['card_rules'], "AccessKeyId" => $_GPC['AccessKeyId'], "AccessKeySecret" => $_GPC['AccessKeySecret'], "sign" => $_GPC['sign'], "code" => $_GPC['code'], "type" => $_GPC['type'], "key" => $_GPC['key'], "tpl_id" => $_GPC['tpl_id'], "withdraw_amount" => $_GPC['withdraw_amount'], "score_icon" => $_GPC['score_icon'], "score_attr" => $_GPC['score_attr'], "score_value" => $_GPC['score_value'], "discount_icon" => $_GPC['discount_icon'], "discount" => $_GPC['discount'], "recharge" => json_decode(htmlspecialchars_decode($_GPC['recharge']), true), "level" => json_decode(htmlspecialchars_decode($_GPC['level']), true)); goto XoHe_; iZSF4: $request = pdo_update($tablename, $condition, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto wPbUz; QLqR6: if ($list) { goto xaEch; } goto GqXIh; EeViN: W2YFv: goto Jd7rS; TNf6o: eaVEV: goto JusPC; EdThx: echo json_encode($json); goto gqqMr; UdyxO: $condition['content']['withdraw'] = $_GPC['withdraw']; goto sXF1w; jKWQO: Mv5Hd: goto IXnv0; IHtNY: goto eSXT2; goto EYGA3; wPbUz: sSGhj: goto h2BEx; oA1wj: $condition['xkey'] = 'card'; goto AP2ab; Vqxdd: goto ftcaz; goto Ffi3I; NBPiY: HIs6H: goto GAqxy; pnOzB: xaEch: goto iZSF4; HWFi7: goto sSGhj; goto pnOzB; DvDgB: $condition = array(); goto EIUMC; waeZE: $condition['content']['discount_status'] = $_GPC['discount_status']; goto EeViN; e73vx: $condition['content']['discount_status'] = -1; goto nanT_; ynv3U: j1xkV: goto waeZE; Jd7rS: if (!empty($_GPC['level_status'])) { goto HIs6H; } goto Bs9FM; wAm47: eSXT2: goto rLY5e; h2BEx: if (!empty($request)) { goto yxqmu; } goto zK6GI; EYGA3: DtH3q: goto NZzfK; gqqMr: goto Blf8_; goto u2OYl; TCEo3: k18lx: goto u_Bu8; cy5Se: goto EcSge; goto u_bju; VmwgS: $list = pdo_get($tablename, array("xkey" => "card", "uniacid" => $uniacid)); goto QLqR6; XoHe_: if (!empty($_GPC['code_status'])) { goto eaVEV; } goto mFSiI; GqXIh: $request = pdo_insert($tablename, $condition); goto HWFi7; UbZh4: goto Mv5Hd; goto NBPiY; AP2ab: $condition['name'] = $_GPC['name']; goto qzVXN; u_bju: case 'rotate': goto LClMb; hG9qU: $list['content']['status'] = 1; goto Jfgkg; oU03W: $xkey = 'rotate'; goto Q0mjk; ctq03: goto EcSge; goto Vc8QR; W_ggN: include $this->template('Web/rotate'); goto ctq03; ZdvaE: H_EQt: goto aEJn5; Jfgkg: P_0uA: goto W_ggN; aEJn5: if (!empty($list['content']['status'])) { goto P_0uA; } goto hG9qU; Q0mjk: $list = pdo_get($tablename, array("xkey" => $xkey, "uniacid" => $uniacid)); goto tQ41m; tQ41m: if (!$list) { goto H_EQt; } goto BYq_L; BYq_L: $list['content'] = json_decode($list['content'], true); goto ZdvaE; LClMb: $xtitle = '网站配置'; goto oU03W; Vc8QR: case 'saverotate': goto YKIYL; wDix6: TC_DS: goto OP3BZ; o3YwT: QmyM1: goto gCq6f; gCq6f: $condition['content'] = json_encode($condition['content']); goto Q38gx; XBmVz: $json = array("status" => 1, "msg" => "操作成功"); goto pdIlF; ITJc2: $condition['content']['status'] = -1; goto u003z; OP3BZ: $request = pdo_update($tablename, $condition, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto iSfuo; SX8rv: $json = array("status" => -1, "msg" => "操作失败"); goto Bn26P; Dba75: OMhmm: goto z3Jqb; Bn26P: echo json_encode($json); goto ajxKd; sHQSc: if ($list) { goto TC_DS; } goto IaFnc; iSfuo: Hhftl: goto FNRaU; YKIYL: $condition = array(); goto rTq9v; N6mMq: m9LUo: goto XBmVz; U_XsO: goto EcSge; goto DTVLX; IaFnc: $request = pdo_insert($tablename, $condition); goto HTD1e; HTD1e: goto Hhftl; goto wDix6; rTq9v: $condition['uniacid'] = $uniacid; goto HkGe_; N3gW3: if (!empty($_GPC['status'])) { goto OMhmm; } goto ITJc2; HkGe_: $condition['xkey'] = 'rotate'; goto s9XTj; llkZX: VGfnR: goto U_XsO; u003z: goto QmyM1; goto Dba75; FNRaU: if (!empty($request)) { goto m9LUo; } goto SX8rv; s9XTj: $condition['name'] = $_GPC['name']; goto jLqkv; jLqkv: $condition['content'] = array("sign" => $_GPC['sign'], "rules" => $_GPC['rules']); goto N3gW3; z3Jqb: $condition['content']['status'] = $_GPC['status']; goto o3YwT; ajxKd: goto VGfnR; goto N6mMq; pdIlF: echo json_encode($json); goto llkZX; Q38gx: $list = pdo_get($tablename, array("xkey" => "rotate", "uniacid" => $uniacid)); goto sHQSc; DTVLX: case 'share': goto sce9p; TXBty: goto EcSge; goto pGsJv; bfB5Q: fU0sl: goto NMquO; v6IGu: D4ztT: goto T4fA_; T4fA_: include $this->template('Web/share'); goto TXBty; GHDXh: Sgpmf: goto SPr2T; upgDp: $list['content']['level'] = 3; goto YSd4g; zsyAM: $list = pdo_get($tablename, array("xkey" => $xkey, "uniacid" => $uniacid)); goto yO4I0; yO4I0: if ($list) { goto Sgpmf; } goto upgDp; YSd4g: goto fU0sl; goto GHDXh; OHxuF: $xkey = 'share'; goto zsyAM; sce9p: $xtitle = '网站配置'; goto OHxuF; SPr2T: $list['content'] = json_decode($list['content'], true); goto bfB5Q; NMquO: if (!empty($list['content']['status'])) { goto D4ztT; } goto T4OzA; T4OzA: $list['content']['status'] = 1; goto v6IGu; pGsJv: case 'saveshare': goto qN98n; z70ah: SEa_P: goto lcLin; YUOJx: xE0kE: goto vdsOH; lcLin: $condition['content']['status'] = $_GPC['status']; goto vdd5u; KnhL9: if (!empty($_GPC['status'])) { goto SEa_P; } goto KOgij; uwSYE: $request = pdo_update($tablename, $condition, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto zjaR1; OvFlE: mLvzZ: goto MLTa0; KOgij: $condition['content']['status'] = -1; goto RcPWD; zg3bG: $condition['xkey'] = 'share'; goto kLyui; kLyui: $condition['name'] = $_GPC['name']; goto bxF7X; cBSPf: $request = pdo_insert($tablename, $condition); goto bszhT; bxF7X: $condition['content'] = array("rules" => $_GPC['rules'], "level" => $_GPC['level'], "type" => $_GPC['type'], "level_one" => $_GPC['level_one'], "level_two" => $_GPC['level_two'], "level_three" => $_GPC['level_three'], "back" => $_GPC['back'], "withdraw_amount" => $_GPC['withdraw_amount'], "share_text" => $_GPC['share_text'], "share_nick_color" => $_GPC['share_nick_color'], "share_text_color" => $_GPC['share_text_color'], "amount" => $_GPC['amount']); goto KnhL9; MLTa0: $json = array("status" => 1, "msg" => "操作成功"); goto gCo67; pYGDa: $condition['content'] = json_encode($condition['content']); goto mA3xh; vdd5u: J7f3p: goto pYGDa; bszhT: goto Syf3N; goto WudiJ; gCo67: echo json_encode($json); goto YUOJx; g2euB: $json = array("status" => -1, "msg" => "操作失败"); goto bYzBa; waJVD: if ($list) { goto KSLGz; } goto cBSPf; vdsOH: goto EcSge; goto l76Eh; mA3xh: $list = pdo_get($tablename, array("xkey" => "share", "uniacid" => $uniacid)); goto waJVD; ihE8O: $condition['uniacid'] = $uniacid; goto zg3bG; zjaR1: Syf3N: goto LEARB; qN98n: $condition = array(); goto ihE8O; WudiJ: KSLGz: goto uwSYE; Rg5x6: goto xE0kE; goto OvFlE; bYzBa: echo json_encode($json); goto Rg5x6; RcPWD: goto J7f3p; goto z70ah; LEARB: if (!empty($request)) { goto mLvzZ; } goto g2euB; l76Eh: case 'ad': goto NvXK0; NvXK0: $xtitle = '网站配置'; goto UnVb0; UnVb0: $xkey = 'ad'; goto CjzSV; CjzSV: $list = pdo_get($tablename, array("xkey" => $xkey, "uniacid" => $uniacid)); goto AWe6P; AWe6P: if (!$list) { goto dGSc8; } goto y71MQ; XOD4J: goto EcSge; goto NFdME; y71MQ: $list['content'] = json_decode($list['content'], true); goto QgViA; ZwlEL: include $this->template('Web/ad'); goto XOD4J; QgViA: dGSc8: goto ZwlEL; NFdME: case 'savead': goto Gotfb; mu8Bt: $json = array("status" => -1, "msg" => "操作失败"); goto wjiJX; xxsM9: $condition['xkey'] = 'ad'; goto YqBgY; Qo3WF: if (!empty($_GPC['status'])) { goto qux_l; } goto j4V2_; vUJTe: CN9JD: goto cx_nh; VbMDE: $condition['content'] = json_encode($content); goto NGSzz; voeEZ: d_KgX: goto f8Ikw; wjiJX: echo json_encode($json); goto PKz8f; j4V2_: $content['status'] = -1; goto RzGrp; YqBgY: $condition['name'] = $_GPC['name']; goto vZcTe; TZZVS: goto EcSge; goto ZjIwk; l6kk8: KtJJW: goto GNDR2; GNDR2: $request = pdo_update($tablename, $condition, array("id" => $list['id'], "uniacid" => $uniacid)); goto voeEZ; NGSzz: $list = pdo_get($tablename, array("xkey" => $condition['xkey'], "uniacid" => $uniacid)); goto NoXyT; JvmMn: echo json_encode($json); goto LQg2X; PKz8f: goto ibigQ; goto vUJTe; TaQH_: goto d_KgX; goto l6kk8; FA0qU: qux_l: goto ha3Ak; A_oVV: $condition['uniacid'] = $uniacid; goto xxsM9; RzGrp: goto HpXQk; goto FA0qU; NGhDC: HpXQk: goto VbMDE; Gotfb: $condition = array(); goto A_oVV; ha3Ak: $content['status'] = $_GPC['status']; goto NGhDC; f8Ikw: if (!empty($request)) { goto CN9JD; } goto mu8Bt; cx_nh: $json = array("status" => 1, "msg" => "操作成功"); goto JvmMn; H59TW: $request = pdo_insert($tablename, $condition); goto TaQH_; NoXyT: if ($list) { goto KtJJW; } goto H59TW; vZcTe: $content = array("list" => json_decode(htmlspecialchars_decode($_GPC['list']), true)); goto Qo3WF; LQg2X: ibigQ: goto TZZVS; ZjIwk: case 'group': goto rhL8o; rhL8o: $list = array("group" => 'https://' . $_SERVER['HTTP_HOST'] . '/app/index.php?i=' . $uniacid . '&c=entry&do=grouprefund&m=' . $_GPC['m']); goto tUDM1; V3nRR: goto EcSge; goto u8jkF; tUDM1: include $this->template('Web/group'); goto V3nRR; u8jkF: case 'online': goto BSqlz; AKVKj: $mesaurl = array(); goto J41x_; JCKgZ: VeTix: goto C3K9x; AJuY8: if (empty($xc)) { goto zRob2; } goto MWobY; J41x_: $mesaurl['ident'] = ''; goto BtkRd; KhEq2: include $this->template('Web/online'); goto XDhA4; XDhA4: exit; goto swsFA; svH5G: $rselut = json_decode($contents['content'], true); goto rxPbD; WjpU2: $xc['prolevel'] = -1; goto Xv1Jb; Yg27D: $idata['erurl'] = ''; goto AKVKj; Mu8Pd: $referer = $_SERVER['HTTP_REFERER']; goto nWIlM; Xv1Jb: CEah5: goto GkiBz; nWIlM: $siteroot = $_W['siteroot']; goto fqaEx; cKJa0: zRob2: goto JRsdD; W_pGC: $mesaurl['ident'] = uniqid(); goto Mu8Pd; G3ZP4: $contents = ihttp_get($acceurl . '&op=gettempplatelist'); goto wIGjT; kRx64: $config['content'] = json_decode($config['content'], true); goto hH355; vKneM: $xc = pdo_fetch($sql, $params); goto AJuY8; C3K9x: XcxSS: goto T3lrD; hH355: if (!(!empty($config['content']) && !empty($config['content']['xcmessage']))) { goto VeTix; } goto h10Ye; wIGjT: $mobalarrr = array("webnamex" => "小程序名", "nick" => "昵称", "content" => "内容", "appid" => "小程序id", "page" => "客服页面"); goto svH5G; rxPbD: $idata = $rselut['obj']; goto JCKgZ; xpZLj: $config = pdo_get('xc_beauty_config', array("xkey" => "web", "uniacid" => $_W['uniacid'])); goto h6Vlr; jK18v: $sql = 'SELECT * FROM ' . tablename($tablename) . ' WHERE xkey=:keyval AND uniacid=:uniacid LIMIT 1'; goto lwqBQ; JRsdD: if (!empty($xc['prolevel'])) { goto CEah5; } goto WjpU2; kGTCY: $idata = array(); goto OsoFT; g5SG1: XpDaQ: goto I4DIj; lwqBQ: $params = array(":keyval" => $keyval, ":uniacid" => $_W['uniacid']); goto kGTCY; T3lrD: $mesaurl = json_encode($mesaurl, true); goto vKneM; sP9cS: $siteroot = 'https' . substr($siteroot, 4); goto g5SG1; vduhn: $xc = array(); goto jK18v; MWobY: $xc = json_decode($xc['content'], true); goto cKJa0; BtkRd: $mesaurl['url'] = ''; goto xpZLj; h10Ye: $acceurl = $config['content']['xcmessage']; goto W_pGC; BSqlz: $keyval = 'online'; goto vduhn; GkiBz: $url = 'https://' . $_SERVER['HTTP_HOST'] . '/app/index.php?i=' . $_W['uniacid'] . '&c=entry&do=online&m=' . $_GPC['m']; goto KhEq2; OsoFT: $idata['content'] = 'null'; goto Yg27D; h6Vlr: if (!$config) { goto XcxSS; } goto kRx64; I4DIj: $mesaurl['url'] = $acceurl . '&op=getuserinfo&xcref=' . urlencode($siteroot . 'app/' . $this->createMobileUrl('sysasyn', array("op" => "binguser", "ident" => $mesaurl['ident']))); goto G3ZP4; fqaEx: if (!(substr($referer, 0, 5) == 'https' && substr($siteroot, 0, 5) != 'https')) { goto XpDaQ; } goto sP9cS; swsFA: case 'saveonline': goto EU8fd; nqIvJ: Hjgue: goto pZbLh; I2yEJ: if ($request) { goto Hjgue; } goto gMiTa; DC9tp: goto ePJeE; goto nqIvJ; SDyfm: $condition['xkey'] = $_GPC['xkey']; goto vklBR; kJYDO: sB0vL: goto I2yEJ; apnVU: $request = array(); goto ppTTt; ppTTt: $condition['uniacid'] = $_W['uniacid']; goto SDyfm; siXoM: $condition['content'] = $data; goto y2JkM; jdumB: if ($xc) { goto m5hXb; } goto adHTR; Ptj5v: ePJeE: goto otTHe; EU8fd: $xc = pdo_get($tablename, array("uniacid" => $_W['uniacid'], "xkey" => $_GPC['xkey'])); goto apnVU; pZbLh: xc_message(1, null); goto Ptj5v; hgKUI: m5hXb: goto ZqHsg; y2JkM: $condition['content'] = json_encode($condition['content']); goto jdumB; otTHe: goto EcSge; goto FjygR; adHTR: $request = pdo_insert($tablename, $condition); goto k6ZHk; vklBR: $data = $_POST; goto siXoM; k6ZHk: goto sB0vL; goto hgKUI; ZqHsg: $request = pdo_update($tablename, $condition, array("uniacid" => $_W['uniacid'], "xkey" => $_GPC['xkey'])); goto kJYDO; gMiTa: xc_message(-1, null); goto DC9tp; FjygR: case 'getnewuserlist': goto XF8BX; zorCS: $strwhere['ident'] = $_GPC['ident']; goto Xn_iK; Im5Fo: $userlist = array(); goto PtUsg; UkOQF: $result = pdo_update('xc_beauty_moban_user', array("status" => 1), array("id" => $arrids, "uniacid" => $_W['uniacid'])); goto nay0h; NDyOW: P61TZ: goto UkOQF; fgy7h: xc_message(1, $userlist); goto eILZS; nay0h: pN5AU: goto fgy7h; m6toV: zPogo: goto OThch; XF8BX: $strwhere = array(); goto zorCS; yvJF6: $userlist = pdo_getall('xc_beauty_moban_user', $strwhere); goto IfgTg; OThch: $arrids = array(); goto kJFJ4; IfgTg: if ($userlist) { goto zPogo; } goto Im5Fo; PtUsg: goto pN5AU; goto m6toV; Xn_iK: $strwhere['uniacid'] = $_W['uniacid']; goto sySLp; kJFJ4: foreach ($userlist as &$itemuser) { goto e2imy; Z_hEC: pBUsg: goto vRJ36; UqaKP: $arrids[] = $itemuser['id']; goto Z_hEC; e2imy: $itemuser['nickname'] = base64_decode($itemuser['nickname'], true); goto UqaKP; vRJ36: } goto NDyOW; sySLp: $strwhere['status'] = -1; goto yvJF6; eILZS: case 'testsmsv2': goto PRZXH; GPunO: FIloL: goto Zq5FM; ObMT4: $config = pdo_get('xc_beauty_config', array("xkey" => "web", "uniacid" => $_W['uniacid'])); goto uoXBT; QJWK8: exit(json_encode($reslut2, true)); goto aqVgJ; M4p9N: $sendopenid = array(); goto yc2Vb; yc2Vb: foreach ($openids as $itemopenis) { $sendopenid[] = $itemopenis['openid']; kChH5: } goto GPunO; PRZXH: $templateParam = array("webnamex" => "小程序名", "nick" => "昵称", "content" => "内容", "appid" => $_W['account']['key'], "page" => "xc_beauty/pages/base/base?share=/xc_beauty/ui2/online/index"); goto ObMT4; iM_ih: xc_message(-1, null, '请添加信息接受人'); goto TB67h; a1gwr: $config['content'] = json_decode($config['content'], true); goto FJlGn; nbS22: header('Content-Type:application/json; charset=utf-8'); goto QJWK8; FJlGn: SzIkB: goto Srzm0; TB67h: XasXX: goto hja86; YTmGa: $template = $_GPC['xc']; goto itacx; hja86: $reslut2 = momessv2($accessurl, $template, $sendopenid, $templateParam); goto JKGgy; Srzm0: $accessurl = $config['content']['xcmessage'] . '&op=sendv2'; goto YTmGa; RGuzf: xc_message($temresult['status'], null, $temresult['message']); goto nbS22; JKGgy: $temresult = json_decode($reslut2, true); goto RGuzf; Zq5FM: if (!empty($openids)) { goto XasXX; } goto iM_ih; qCPiG: $openids = $_GPC['userlist']; goto M4p9N; itacx: $template['data'] = $_GPC['data']; goto qCPiG; uoXBT: if (!$config) { goto SzIkB; } goto a1gwr; aqVgJ: case 'audit': goto YYR31; YYR31: $xtitle = '网站配置'; goto YJtO4; pz0Ji: $list = pdo_get($tablename, array("xkey" => $xkey, "uniacid" => $uniacid)); goto B7W6P; RWVgs: $list['content'] = json_decode($list['content'], true); goto gO7YO; B7W6P: if (!$list) { goto MSfDB; } goto RWVgs; MAjoW: goto EcSge; goto MYH_F; TGMD_: include $this->template('Web/audit'); goto MAjoW; gO7YO: MSfDB: goto TGMD_; YJtO4: $xkey = 'audit'; goto pz0Ji; MYH_F: case 'saveaudit': goto zpo6O; K2SBU: goto F4SpW; goto tAYSM; C0xil: $condition['xkey'] = 'audit'; goto i4R08; H2M9b: $list = pdo_get($tablename, array("xkey" => "audit", "uniacid" => $uniacid)); goto qP2Mm; qP2Mm: if ($list) { goto BT5Pf; } goto VB0Yf; kYAEY: goto EcSge; goto qQ94A; tAYSM: qRP7E: goto DjUu2; i4R08: $condition['name'] = $_GPC['name']; goto vV5IB; zpo6O: $condition = array(); goto UZTRJ; UZTRJ: $condition['uniacid'] = $uniacid; goto C0xil; NUIMP: H1yVZ: goto kYAEY; sj4cA: $request = pdo_update($tablename, $condition, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto oRrdn; tSode: echo json_encode($json); goto NUIMP; DjUu2: $condition['content']['status'] = $_GPC['status']; goto FOZIT; NJWy5: if (!empty($_GPC['status'])) { goto qRP7E; } goto rMxKR; A2vLf: BT5Pf: goto sj4cA; vvEmY: npdXX: goto O12B3; CD0PU: echo json_encode($json); goto vQwXw; Vk2fe: $condition['content'] = json_encode($condition['content']); goto H2M9b; O12B3: $json = array("status" => 1, "msg" => "操作成功"); goto tSode; QuvTX: if (!empty($request)) { goto npdXX; } goto GFazP; C8mu1: goto DApSS; goto A2vLf; VB0Yf: $request = pdo_insert($tablename, $condition); goto C8mu1; vQwXw: goto H1yVZ; goto vvEmY; vV5IB: $condition['content'] = array("bimg" => tomedia($_GPC['bimg']), "store_icon" => tomedia($_GPC['store_icon']), "store_name" => $_GPC['store_name'], "time_icon" => tomedia($_GPC['time_icon']), "store_time" => $_GPC['store_time'], "mobile_icon" => tomedia($_GPC['mobile_icon']), "store_mobile" => $_GPC['store_mobile'], "map_icon" => tomedia($_GPC['map_icon']), "store_map" => $_GPC['store_map'], "content" => $_GPC['content']); goto NJWy5; rMxKR: $condition['content']['status'] = -1; goto K2SBU; GFazP: $json = array("status" => -1, "msg" => "操作失败"); goto CD0PU; oRrdn: DApSS: goto QuvTX; FOZIT: F4SpW: goto Vk2fe; qQ94A: } goto e_b1q; b7OzJ: $op = in_array($_GPC['op'], $ops) ? $_GPC['op'] : 'edit'; goto Sv3Ok; KHWcb: $ops = array("edit", "savemodel", "map", "savemap", "sort", "savesort", "sort_service", "sms", "savesms", "smstest", "print", "saveprint", "printtest", "refund", "saverefund", "card", "savecard", "theme", "savetheme", "rotate", "saverotate", "share", "saveshare", "ad", "savead", "group", "online", "saveonline", "getnewuserlist", "saveonline", "testsmsv2", "audit", "saveaudit"); goto KU5vS; e_b1q: rEjvb: goto bIhdP; bIhdP: EcSge: goto eBMXt; eBMXt: } public function doWebBanner() { goto LXs3z; VXt5r: $op = in_array($_GPC['op'], $ops) ? $_GPC['op'] : 'list'; goto ZLcSb; dgM9Q: zghdt: goto jyZk7; B6F8D: $uniacid = $_W['uniacid']; goto VXt5r; LXs3z: $ops = array("list", "edit", "savemodel", "delete", "statuschange", "article"); goto znsDI; QORej: switch ($op) { case 'list': goto bIgEG; eh3ts: $condition['name LIKE'] = '%' . $_GPC['xname'] . '%'; goto dkoEZ; Bs3NX: TjmWB: goto U7tBq; ufqa6: $pageindex = intval($_GPC['page']); goto oGzTq; dkoEZ: UPjf7: goto kpN1N; w62gl: $condition['uniacid'] = $uniacid; goto LHypp; U7tBq: $pagesize = 15; goto LiYpk; yOqv1: $xname = $_GPC['xname']; goto eh3ts; aZa0E: $pageindex = 1; goto Bs3NX; u0m5W: goto zghdt; goto BVv0R; gs0Or: pHweP: goto aZa0E; kpN1N: $request = pdo_getall($tablename, $condition); goto oBors; oGzTq: goto TjmWB; goto gs0Or; LHypp: if (empty($_GPC['xname'])) { goto UPjf7; } goto yOqv1; oBors: $total = count($request); goto t_Zw1; VaIh4: $condition = array(); goto w62gl; LiYpk: $pager = pagination($total, $pageindex, $pagesize); goto XLRtm; rVwV8: include $this->template('Banner/list'); goto u0m5W; XLRtm: $list = pdo_getall($tablename, $condition, array(), '', 'sort DESC,createtime DESC', array($pageindex, $pagesize)); goto rVwV8; bIgEG: $version_id = $_GPC['version_id']; goto VaIh4; t_Zw1: if (!isset($_GPC['page'])) { goto pHweP; } goto ufqa6; BVv0R: case 'edit': goto RZFLI; NlgdR: $list = pdo_get($tablename, array("id" => $_GPC['id'])); goto NI_aI; RzupY: goto zghdt; goto g6hZF; NI_aI: rUyai: goto S8qQ4; Ub3jG: G4faV: goto NlgdR; S8qQ4: include $this->template('Banner/edit'); goto RzupY; gj98i: goto rUyai; goto Ub3jG; RZFLI: if (!empty($_GPC['id'])) { goto G4faV; } goto fvHwu; fvHwu: $list['status'] = 1; goto gj98i; g6hZF: case 'savemodel': goto xanjp; xP2Va: echo json_encode($json); goto QakAC; aDfRD: $json = array("status" => 1, "msg" => "操作成功"); goto xP2Va; JjlTX: $request = pdo_insert($tablename, $condition); goto JNcI3; mmJLc: echo json_encode($json); goto bRHh8; eqowX: goto H9sZN; goto awMr4; qRy_N: $json = array("status" => 0, "msg" => "操作失败"); goto mmJLc; gLfhN: $request = pdo_update($tablename, $condition, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto eqowX; WUCPj: $condition['link'] = $_GPC['link']; goto JdJmb; sdTgK: ckmPe: goto BNt8G; AcSxZ: $condition['uniacid'] = $uniacid; goto mdhmS; y1pBY: goto zghdt; goto ullP3; BNt8G: if (empty($_GPC['sort'])) { goto OHfLv; } goto Dvfng; BuQSk: OHfLv: goto APDJe; u9pZR: K4rlu: goto LGIgA; GAjvN: $condition['status'] = $_GPC['status']; goto tHHVZ; Dvfng: $condition['sort'] = $_GPC['sort']; goto g4UxF; APDJe: $condition['sort'] = 0; goto NddGV; xanjp: $condition = array(); goto AcSxZ; mdhmS: $condition['name'] = $_GPC['name']; goto qGRYj; QakAC: QA5IW: goto y1pBY; SnSxW: if (empty($_GPC['id'])) { goto ao31l; } goto gLfhN; rUGrL: if (empty($_GPC['status'])) { goto K4rlu; } goto GAjvN; g4UxF: goto QYRiX; goto BuQSk; NddGV: QYRiX: goto SnSxW; qGRYj: $condition['bimg'] = $_GPC['bimg']; goto WUCPj; LGIgA: $condition['status'] = -1; goto sdTgK; JdJmb: $condition['appid'] = $_GPC['appid']; goto rUGrL; bRHh8: goto QA5IW; goto Rk6tw; awMr4: ao31l: goto JjlTX; opUYm: if (!empty($request)) { goto mP2Fi; } goto qRy_N; Rk6tw: mP2Fi: goto aDfRD; JNcI3: H9sZN: goto opUYm; tHHVZ: goto ckmPe; goto u9pZR; ullP3: case 'statuschange': goto xCtrJ; MA6Pd: echo json_encode($json); goto E2Rou; Dq2ax: if ($request) { goto t754x; } goto jQcQJ; HehMk: goto TvAGa; goto OSPSx; Ne3lQ: $json = array("status" => 1, "msg" => "操作成功"); goto MA6Pd; xCtrJ: $request = pdo_update($tablename, array("status" => $_GPC['status']), array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto Dq2ax; hBBT7: echo json_encode($json); goto HehMk; E2Rou: TvAGa: goto ogRdl; ogRdl: goto zghdt; goto ccN2E; OSPSx: t754x: goto Ne3lQ; jQcQJ: $json = array("status" => 0, "msg" => "操作失败"); goto hBBT7; ccN2E: case 'delete': goto e5bFt; Ie4Fx: $json = array("status" => 1, "msg" => "操作成功"); goto ZvGjT; e5bFt: $request = pdo_delete($tablename, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto U1UlA; N9WKx: goto f3je3; goto f7FfP; ZvGjT: echo json_encode($json); goto Z2fii; cg5PT: echo json_encode($json); goto N9WKx; oEIxN: goto zghdt; goto avDhQ; f7FfP: xTHsx: goto Ie4Fx; Z2fii: f3je3: goto oEIxN; U1UlA: if ($request) { goto xTHsx; } goto vkyJL; vkyJL: $json = array("status" => 0, "msg" => "操作失败"); goto cg5PT; avDhQ: case 'article': goto N0T1i; gfEcA: foreach ($list as &$x) { $x['url'] = $url; PJ6Xz: } goto HFPs_; fzeMG: $url = 'https://' . $_SERVER['HTTP_HOST'] . '/app/index.php?i=' . $uniacid . '&c=entry&do=index&m=' . $_GPC['m']; goto tdgYk; FV0cV: $pager = pagination($total, $pageindex, $pagesize); goto CZJEB; kgsCH: $total = count($request); goto GRD_y; CZJEB: $list = pdo_getall('xc_beauty_article', $condition, array(), '', 'createtime DESC', array($pageindex, $pagesize)); goto fzeMG; S_HHr: $pagesize = 6; goto FV0cV; pjoQY: $condition['uniacid'] = $uniacid; goto gdbDc; ZZHUT: goto zghdt; goto OIDf_; Ohw_O: $title = $_GPC['title']; goto p0pVT; mmUFM: $pageindex = intval($_GPC['page']); goto XMOZ4; qcUK9: WsrvC: goto nB1fa; ppZGf: include $this->template('Banner/article'); goto ZZHUT; GRD_y: if (!isset($_GPC['page'])) { goto Nzwmy; } goto mmUFM; s1Do7: Nzwmy: goto tdAVc; gdbDc: if (empty($_GPC['title'])) { goto WsrvC; } goto Ohw_O; N0T1i: $version_id = $_GPC['version_id']; goto DdCTS; bApFG: NNZi7: goto S_HHr; nB1fa: $request = pdo_getall('xc_beauty_article', $condition); goto kgsCH; p0pVT: $condition['title LIKE'] = '%' . $_GPC['title'] . '%'; goto qcUK9; XMOZ4: goto NNZi7; goto s1Do7; tdgYk: if (!$list) { goto n2lR4; } goto gfEcA; HFPs_: vVfZW: goto Ow5xG; DdCTS: $condition = array(); goto pjoQY; Ow5xG: n2lR4: goto ppZGf; tdAVc: $pageindex = 1; goto bApFG; OIDf_: } goto QKL3s; ZLcSb: $tablename = 'xc_beauty_banner'; goto QORej; znsDI: global $_GPC, $_W; goto B6F8D; QKL3s: gTtYX: goto dgM9Q; jyZk7: } public function doWebArticle() { goto hy5v7; gszAs: $tablename = 'xc_beauty_article'; goto BAMUJ; BAMUJ: switch ($op) { case 'list': goto tvZy8; rPt2g: $condition['uniacid'] = $uniacid; goto sDAaN; tLevX: $total = count($request); goto tKs7z; sDAaN: if (empty($_GPC['title'])) { goto XIi00; } goto ru_Kt; cNuTG: include $this->template('Article/list'); goto JuFil; PI7Le: XIi00: goto WRpPV; TMo7h: $pageindex = intval($_GPC['page']); goto MiE9v; ZJ0TY: iy2eW: goto ieiKd; ru_Kt: $title = $_GPC['title']; goto fIv6u; JuFil: goto zJ2ms; goto CAxo7; OWD1U: $pageindex = 1; goto ZJ0TY; MiE9v: goto iy2eW; goto QIxRv; tvZy8: $version_id = $_GPC['version_id']; goto xOdsY; fIv6u: $condition['title LIKE'] = '%' . $_GPC['title'] . '%'; goto PI7Le; hYSXJ: $pager = pagination($total, $pageindex, $pagesize); goto CiE8T; CiE8T: $list = pdo_getall($tablename, $condition, array(), '', 'createtime DESC', array($pageindex, $pagesize)); goto cNuTG; WRpPV: $request = pdo_getall($tablename, $condition); goto tLevX; xOdsY: $condition = array(); goto rPt2g; QIxRv: hkpnk: goto OWD1U; ieiKd: $pagesize = 15; goto hYSXJ; tKs7z: if (!isset($_GPC['page'])) { goto hkpnk; } goto TMo7h; CAxo7: case 'edit': goto rA4Rp; d7DZW: goto TChhX; goto YqSZr; ozzmp: $list = pdo_get($tablename, array("id" => $_GPC['id'])); goto v3k5W; ZDBIW: include $this->template('Article/edit'); goto nBGo2; gd79H: $list['status'] = 1; goto d7DZW; rA4Rp: if (!empty($_GPC['id'])) { goto netjn; } goto gd79H; nBGo2: goto zJ2ms; goto ArwJc; YqSZr: netjn: goto ozzmp; v3k5W: TChhX: goto ZDBIW; ArwJc: case 'savemodel': goto NmLgu; ZlnpP: goto B0kSH; goto oS3vp; oS3vp: LGfXE: goto HvFX9; IvOAc: $condition['title'] = $_GPC['title']; goto jIyPp; qa5t8: $request = pdo_update($tablename, $condition, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto ZlnpP; HvFX9: $request = pdo_insert($tablename, $condition); goto rl6vb; pelSq: $condition['type'] = $_GPC['type']; goto hP3Ad; RJdcL: $condition['btn'] = $_GPC['btn']; goto G73iZ; hP3Ad: $condition['link'] = $_GPC['link']; goto RJdcL; sf0Ub: if (empty($_GPC['id'])) { goto LGfXE; } goto qa5t8; NmLgu: $condition = array(); goto OXING; R1kq5: if (!empty($request)) { goto UlavD; } goto tuLEK; vSbdD: echo json_encode($json); goto m7k8A; iQU1D: goto u82LZ; goto JBkqb; jIyPp: $condition['content'] = $_GPC['content']; goto pelSq; uHDsl: echo json_encode($json); goto iQU1D; m7k8A: u82LZ: goto Ve5LJ; rl6vb: B0kSH: goto R1kq5; G73iZ: $condition['link_type'] = $_GPC['link_type']; goto sf0Ub; OXING: $condition['uniacid'] = $uniacid; goto IvOAc; wcXIq: $json = array("status" => 1, "msg" => "操作成功"); goto vSbdD; JBkqb: UlavD: goto wcXIq; tuLEK: $json = array("status" => 0, "msg" => "操作失败"); goto uHDsl; Ve5LJ: goto zJ2ms; goto HTLZH; HTLZH: case 'statuschange': goto CpLbG; flcCY: goto zJ2ms; goto z_ISA; kfOvj: if ($request) { goto y3XrV; } goto D744S; J7EQA: echo json_encode($json); goto IsFfL; D744S: $json = array("status" => 0, "msg" => "操作失败"); goto UqZIK; FDm3I: $json = array("status" => 1, "msg" => "操作成功"); goto J7EQA; CpLbG: $request = pdo_update($tablename, array("status" => $_GPC['status']), array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto kfOvj; UqZIK: echo json_encode($json); goto z5eYw; z5eYw: goto ovUPQ; goto EwSm_; EwSm_: y3XrV: goto FDm3I; IsFfL: ovUPQ: goto flcCY; z_ISA: case 'delete': goto YZkl2; BrCPV: if ($request) { goto GE9F5; } goto eN8s0; eN8s0: $json = array("status" => 0, "msg" => "操作失败"); goto uPKcu; uPKcu: echo json_encode($json); goto tzQ8c; tzQ8c: goto Y94LU; goto xqFvM; TenMI: Y94LU: goto DZfAX; XMEmM: echo json_encode($json); goto TenMI; YZkl2: $request = pdo_delete($tablename, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto BrCPV; xqFvM: GE9F5: goto rVzIT; DZfAX: goto zJ2ms; goto HzKNi; rVzIT: $json = array("status" => 1, "msg" => "操作成功"); goto XMEmM; HzKNi: case 'sort_service': goto xsD5q; TOl40: foreach ($list as &$y) { $y['cidname'] = $datalist[$y['cid']]; ZyvBy: } goto vq4Za; fapi2: if (!isset($_GPC['page'])) { goto bP0gO; } goto Nxduq; YWMbX: $pager = pagination($total, $pageindex, $pagesize); goto Eltsr; w5cBx: $total = count($request); goto fapi2; xygPB: $condition['uniacid'] = $uniacid; goto HU942; Iqh0N: cuTog: goto utLS2; xsD5q: $condition = array(); goto xygPB; zY0O6: $xname = $_GPC['xname']; goto tImbM; BrdAT: rxyZI: goto KkRNd; EmHkg: include $this->template('Article/sort_service'); goto Cj0yX; eYfpW: B769_: goto Aq_md; hSxLP: if (empty($_GPC['cid'])) { goto cuTog; } goto JSzyh; Ol2xB: $datalist = array(); goto Rl1PC; Eltsr: $list = pdo_getall('xc_beauty_service', $condition, array(), '', 'sort DESC,createtime DESC', array($pageindex, $pagesize)); goto qVEil; RGeGu: grEjb: goto hSxLP; qVEil: $class = pdo_getall('xc_beauty_service_class', array("status" => 1, "uniacid" => $uniacid), array(), '', 'sort DESC,createtime DESC'); goto Ol2xB; RUvO8: if (!$list) { goto LXBvV; } goto TOl40; HU942: if (empty($_GPC['xname'])) { goto grEjb; } goto zY0O6; Aq_md: A2LXq: goto RUvO8; ym3ko: LXBvV: goto EmHkg; utLS2: $request = pdo_getall('xc_beauty_service', $condition); goto w5cBx; Q3DM4: foreach ($class as $x) { $datalist[$x['id']] = $x['name']; YYDaz: } goto eYfpW; KkRNd: $pagesize = 6; goto YWMbX; Nrpb4: bP0gO: goto zYiEe; JSzyh: $cid = $_GPC['cid']; goto RlxGI; Cj0yX: goto zJ2ms; goto LihHM; zYiEe: $pageindex = 1; goto BrdAT; vq4Za: JVANO: goto ym3ko; Nxduq: $pageindex = intval($_GPC['page']); goto pavzu; RlxGI: $condition['cid'] = $_GPC['cid']; goto Iqh0N; pavzu: goto rxyZI; goto Nrpb4; tImbM: $condition['name LIKE'] = '%' . $_GPC['xname'] . '%'; goto RGeGu; Rl1PC: if (!$class) { goto A2LXq; } goto Q3DM4; LihHM: } goto O8p66; J4S9t: $op = in_array($_GPC['op'], $ops) ? $_GPC['op'] : 'list'; goto gszAs; sERyR: global $_GPC, $_W; goto JyUbN; O8p66: GjvVg: goto sUvTH; sUvTH: zJ2ms: goto NMJ4g; JyUbN: $uniacid = $_W['uniacid']; goto J4S9t; hy5v7: $ops = array("list", "edit", "savemodel", "delete", "statuschange", "sort_service"); goto sERyR; NMJ4g: } public function doWebUser() { goto iHqlj; UZbXg: $uniacid = $_W['uniacid']; goto tlXzt; mhqEl: $tablename = 'xc_beauty_userinfo'; goto Uw5XE; Uw5XE: switch ($op) { case 'list': goto WXsti; TNpbn: $condition['uniacid'] = $uniacid; goto bxDwV; pDPHm: m7oGJ: goto sSse_; jJNbZ: if (!$card) { goto m7oGJ; } goto K6Aiq; PkBfU: $mobile = $_GPC['mobile']; goto XI7FU; TVliJ: $pager = pagination($total, $pageindex, $pagesize); goto E0BuF; tu1C2: pgLS5: goto uaizT; Xnmd3: $pageindex = 1; goto MqPrH; pVcN3: include $this->template('User/list'); goto jfleB; IR_6j: $pagesize = 15; goto TVliJ; iHru2: $openid = $_GPC['openid']; goto yZ3yv; K6Aiq: $card['content'] = json_decode($card['content'], true); goto pDPHm; tFEO2: ZNK1o: goto jHiW5; yZ3yv: $condition['openid LIKE'] = '%' . $_GPC['openid'] . '%'; goto UNm9g; bxDwV: if (empty($_GPC['nick'])) { goto ZNK1o; } goto EZjqr; bCF_4: if (!isset($_GPC['page'])) { goto LNt70; } goto U15TX; v2zz8: foreach ($store as $s) { $datalist[$s['id']] = $s['name']; CbDZ0: } goto xWWqp; h5btZ: $user_list = array(); goto zoYDG; WXsti: $condition = array(); goto TNpbn; UNm9g: Klyqd: goto oIeKr; sSse_: if (!$list) { goto HWUVq; } goto EKneY; jHiW5: if (empty($_GPC['openid'])) { goto Klyqd; } goto iHru2; z6ISf: HWUVq: goto pVcN3; v93cZ: zrb9o: goto Rf3rA; EKneY: $store = pdo_getall('xc_beauty_store', array("status" => 1, "uniacid" => $uniacid)); goto uWWgL; U15TX: $pageindex = intval($_GPC['page']); goto zJ6AW; zoYDG: foreach ($list as $l) { goto XerPo; DMGZL: YXGCa: goto NC7do; XerPo: $l['nick'] = base64_decode($l['nick']); goto g1mc8; g1mc8: $user_list[$l['openid']] = $l; goto DMGZL; NC7do: } goto v93cZ; RJ0R4: $card = pdo_get('xc_beauty_config', array("xkey" => "card", "uniacid" => $uniacid)); goto jJNbZ; E0BuF: $list = pdo_getall($tablename, $condition, array(), '', 'createtime DESC', array($pageindex, $pagesize)); goto RJ0R4; uWWgL: $datalist = array(); goto tyZ91; xWWqp: UPI_X: goto KeWH5; EZjqr: $nick = $_GPC['nick']; goto WQPm_; Rf3rA: foreach ($list as &$x) { goto a5er2; TwWYp: goto IuRNg; goto jxN91; p0gHa: if (!empty($datalist[$x['store']])) { goto Gq0g4; } goto GeJOk; R6R4F: if ($x['shop'] == -1) { goto mWJH9; } goto PHskm; GzguN: $x['shop_name'] = '店员'; goto Zf7av; c6Thz: if (!($x['shop'] == 3)) { goto uUlDH; } goto GzguN; fJ4Xb: $x['share_nick'] = $user_list[$x['share']]['nick']; goto xpm3U; yKIV8: uA0US: goto NqLFC; IWjy1: b_1yS: goto ALDNr; Jx5Jm: uUlDH: goto BO0uy; T3oSV: $x['shop_name'] .= '<br/>门店不存在'; goto pwckh; Ka9EY: skkAT: goto R6R4F; RJePg: qC3Wb: goto Ka9EY; yOoLx: if (!empty($x['store'])) { goto AMd7R; } goto o4yH8; XAFQ_: W56kS: goto TwWYp; PHskm: if ($x['shop'] == 1) { goto b_1yS; } goto O8PEL; iRq8C: $x['shop_name'] .= '<br/>' . $datalist[$x['shop_id']]; goto yKIV8; GeJOk: $x['store_name'] = '门店不存在'; goto A4qcJ; NqLFC: lBO8r: goto Ce2uY; xpm3U: asOn3: goto XuzEr; O8PEL: if ($x['shop'] == 2) { goto FsSRz; } goto c6Thz; ALDNr: $x['shop_name'] = '管理员'; goto XAFQ_; v3HXk: gqQGk: goto Jx5Jm; wrLVL: if (!empty($datalist[$x['shop_id']])) { goto xlcYq; } goto UN7Pq; lQKlj: if (empty($x['share'])) { goto asOn3; } goto fJ4Xb; xI83M: IuRNg: goto lQKlj; jxN91: mWJH9: goto fjjem; sau_P: $x['store_name'] = $datalist[$x['store']]; goto RJePg; Y0Lta: LL__w: goto VB7vx; KSzfA: $x['shop_name'] = '店长'; goto wrLVL; RACnn: goto uA0US; goto N5SYw; o4yH8: $x['store_name'] = '未绑定'; goto mpQ0a; h2xFo: Gq0g4: goto sau_P; A4qcJ: goto qC3Wb; goto h2xFo; XuzEr: I3WH6: goto RJYwt; vzXuW: $x['card_id'] = $x['createtime']; goto yOoLx; N5SYw: xlcYq: goto iRq8C; Zf7av: if (!empty($datalist[$x['shop_id']])) { goto LL__w; } goto T3oSV; VB7vx: $x['shop_name'] .= '<br/>' . $datalist[$x['shop_id']]; goto v3HXk; UN7Pq: $x['shop_name'] .= '<br/>门店不存在'; goto RACnn; BO0uy: goto lBO8r; goto yxuBm; yxuBm: FsSRz: goto KSzfA; Ce2uY: goto W56kS; goto IWjy1; pwckh: goto gqQGk; goto Y0Lta; a5er2: $x['nick'] = base64_decode($x['nick']); goto vzXuW; fjjem: $x['shop_name'] = '无权限'; goto xI83M; mpQ0a: goto skkAT; goto PO_Zp; PO_Zp: AMd7R: goto p0gHa; RJYwt: } goto hotSQ; hotSQ: krlaz: goto z6ISf; XI7FU: $condition['mobile LIKE'] = '%' . $_GPC['mobile'] . '%'; goto tu1C2; oIeKr: if (empty($_GPC['mobile'])) { goto pgLS5; } goto PkBfU; XcWu_: $total = count($request); goto bCF_4; ObNDu: LNt70: goto Xnmd3; uaizT: $request = pdo_getall($tablename, $condition); goto XcWu_; tyZ91: if (!$store) { goto eOiFV; } goto v2zz8; KeWH5: eOiFV: goto h5btZ; WQPm_: $condition['nick LIKE'] = '%' . base64_encode($_GPC['nick']) . '%'; goto tFEO2; MqPrH: afdkM: goto IR_6j; zJ6AW: goto afdkM; goto ObNDu; jfleB: goto tbZn0; goto TMxdq; TMxdq: case 'statuschange': goto Bk5IB; wufkm: gIc9a: goto CLF4p; GLh6U: $json = array("status" => 0, "msg" => "操作失败"); goto rxm7r; cSnCu: echo json_encode($json); goto wufkm; Bk5IB: $request = pdo_update($tablename, array("shop" => $_GPC['status']), array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto VTJbo; gofZt: goto gIc9a; goto Tw1Qd; rxm7r: echo json_encode($json); goto gofZt; Tw1Qd: hsubs: goto LlR9g; VTJbo: if ($request) { goto hsubs; } goto GLh6U; LlR9g: $json = array("status" => 1, "msg" => "操作成功"); goto cSnCu; CLF4p: goto tbZn0; goto Y5E_j; Y5E_j: case 'scorechange': goto Wb16G; DoeQB: if ($request) { goto B02Z1; } goto iflbX; Wb16G: $request = pdo_update($tablename, array("score" => $_GPC['score']), array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto DoeQB; XzjcG: echo json_encode($json); goto HCvZL; iGHUL: echo json_encode($json); goto sSIwJ; sSIwJ: goto W_f6x; goto WPjaz; WPjaz: B02Z1: goto du0al; iflbX: $json = array("status" => 0, "msg" => "操作失败"); goto iGHUL; HCvZL: W_f6x: goto ni0W6; du0al: $json = array("status" => 1, "msg" => "操作成功"); goto XzjcG; ni0W6: goto tbZn0; goto wkL02; wkL02: case 'recharge': goto t5zda; dluy9: wfcHo: goto X_qdl; X_qdl: goto tbZn0; goto d4QMT; H4i2G: $request = pdo_update('xc_laundry_userinfo', array("money" => $money), array("uniacid" => $uniacid, "id" => $_GPC['id'])); goto yJEQK; JqS6w: $condition['amount'] = $_GPC['amount']; goto uhkip; t5zda: $userinfo = pdo_get('xc_laundry_userinfo', array("uniacid" => $uniacid, "id" => $_GPC['id'])); goto hPl3O; AXWuk: $condition['money'] = $money; goto Jh9Yv; ebBCV: if ($request) { goto h0tvC; } goto XBw7K; sIosB: h0tvC: goto H4i2G; uhkip: $condition['g_price'] = 0; goto VfZi1; IKE0f: $request = pdo_insert('xc_laundry_order', $condition); goto ebBCV; STnIi: echo json_encode($json); goto dluy9; XBw7K: $json = array("status" => 0, "msg" => "操作失败"); goto wn0u1; sb2j3: $condition['tid'] = 1; goto JqS6w; yJEQK: $json = array("status" => 1, "msg" => "操作成功", "data" => array("money" => $money)); goto STnIi; hPl3O: $money = round(floatval($userinfo['money']) + floatval($_GPC['amount'])); goto f5wIJ; f5wIJ: $condition['uniacid'] = $uniacid; goto fTPgm; fTPgm: $condition['openid'] = $userinfo['openid']; goto sb2j3; Jh9Yv: $condition['status'] = 1; goto IKE0f; wn0u1: echo json_encode($json); goto hmIp0; VfZi1: $condition['admin'] = 1; goto AXWuk; hmIp0: goto wfcHo; goto sIosB; d4QMT: case 'service': goto PWqab; F3fju: $pageindex = intval($_GPC['page']); goto FlC_g; s1WuD: $list = pdo_getall($tablename, $condition, array(), '', 'sort desc,createtime DESC', array($pageindex, $pagesize)); goto kA0nR; PWqab: $tablename = 'xc_beauty_store'; goto fHNG3; aeQd3: $request = pdo_getall($tablename, $condition); goto HNn6V; vQlww: if (empty($_GPC['xname'])) { goto JDs_m; } goto WDGpR; kz7K5: KHm1N: goto gQtQm; mrS9I: if (!isset($_GPC['page'])) { goto KHm1N; } goto F3fju; wggu5: Q6n7w: goto gaqjC; RBYWo: $pager = pagination($total, $pageindex, $pagesize); goto s1WuD; s5PWN: $condition['uniacid'] = $uniacid; goto vQlww; h0xwe: $condition = array(); goto s5PWN; fHNG3: $version_id = $_GPC['version_id']; goto h0xwe; gQtQm: $pageindex = 1; goto wggu5; kA0nR: include $this->template('User/service'); goto UnpAz; CP_3F: JDs_m: goto aeQd3; WDGpR: $xname = $_GPC['xname']; goto B4zAR; UnpAz: goto tbZn0; goto awrKT; gaqjC: $pagesize = 6; goto RBYWo; HNn6V: $total = count($request); goto mrS9I; FlC_g: goto Q6n7w; goto kz7K5; B4zAR: $condition['name LIKE'] = '%' . $_GPC['xname'] . '%'; goto CP_3F; awrKT: case 'store_bind': goto vvXXY; Qz_Lo: $json = array("status" => 1, "msg" => "操作成功"); goto Qmin2; hLwYC: goto WsWC8; goto gbbj_; vvXXY: $request = pdo_update($tablename, array("store" => $_GPC['store']), array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto iX55e; chcov: $json = array("status" => 0, "msg" => "操作失败"); goto b_raP; mdkHP: WsWC8: goto KVlCV; b_raP: echo json_encode($json); goto hLwYC; KVlCV: goto tbZn0; goto NB07E; iX55e: if ($request) { goto ycHjm; } goto chcov; Qmin2: echo json_encode($json); goto mdkHP; gbbj_: ycHjm: goto Qz_Lo; NB07E: case 'shop': goto s7s1w; f0Jxj: $condition['shop_id'] = $_GPC['shop_id']; goto uhcT7; H4SIh: G1Lhy: goto rtWJ5; KUcBe: $json = array("status" => 0, "msg" => "操作失败"); goto GXlVk; aEDED: if ($request) { goto o81bL; } goto KUcBe; S3zbN: goto G1Lhy; goto DPgpg; uhcT7: yGy5A: goto LfbEh; OmEsu: echo json_encode($json); goto H4SIh; sROLz: if (empty($_GPC['shop_id'])) { goto yGy5A; } goto f0Jxj; rtWJ5: goto tbZn0; goto sJgjy; GXlVk: echo json_encode($json); goto S3zbN; DPgpg: o81bL: goto FCcOl; LfbEh: $request = pdo_update($tablename, $condition, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto aEDED; s7s1w: $condition['shop'] = $_GPC['shop']; goto sROLz; FCcOl: $json = array("status" => 1, "msg" => "操作成功"); goto OmEsu; sJgjy: } goto up_bL; RRney: tbZn0: goto oZ5dX; EAYkZ: global $_GPC, $_W; goto UZbXg; up_bL: nIGD2: goto RRney; iHqlj: $ops = array("list", "statuschange", "recharge", "service", "store_bind", "shop", "scorechange"); goto EAYkZ; tlXzt: $op = in_array($_GPC['op'], $ops) ? $_GPC['op'] : 'list'; goto mhqEl; oZ5dX: } public function doWebService_class() { goto YBH6y; vD1fd: M7XFw: goto cu53K; uxqhe: V6IWv: goto vD1fd; r1qE9: $tablename = 'xc_beauty_service_class'; goto umdnd; uUh31: $uniacid = $_W['uniacid']; goto rnvvD; rnvvD: $op = in_array($_GPC['op'], $ops) ? $_GPC['op'] : 'list'; goto r1qE9; XadsV: global $_GPC, $_W; goto uUh31; YBH6y: $ops = array("list", "edit", "savemodel", "delete", "statuschange"); goto XadsV; umdnd: switch ($op) { case 'list': goto ytjRL; QttHf: include $this->template('Service_class/list'); goto t0LHT; t0LHT: goto M7XFw; goto TxnWc; aqUYf: $condition = array(); goto ZFsqo; AKOkd: if (empty($_GPC['xname'])) { goto hK4ST; } goto DAtDw; UWgKk: $pager = pagination($total, $pageindex, $pagesize); goto DZQHz; JIoa6: $condition['name LIKE'] = '%' . $_GPC['xname'] . '%'; goto jNSU7; GJ0_G: if (!isset($_GPC['page'])) { goto dCYXi; } goto sVrX6; sVrX6: $pageindex = intval($_GPC['page']); goto JBfKR; y1G_B: $pagesize = 15; goto UWgKk; jNSU7: hK4ST: goto b_MXO; Vaprb: VHZLt: goto y1G_B; zBo19: $pageindex = 1; goto Vaprb; DAtDw: $xname = $_GPC['xname']; goto JIoa6; DZQHz: $list = pdo_getall($tablename, $condition, array(), '', 'sort DESC,createtime DESC', array($pageindex, $pagesize)); goto QttHf; b_MXO: $request = pdo_getall($tablename, $condition); goto VVbAe; JBfKR: goto VHZLt; goto tOkYz; tOkYz: dCYXi: goto zBo19; ZFsqo: $condition['uniacid'] = $uniacid; goto AKOkd; VVbAe: $total = count($request); goto GJ0_G; ytjRL: $version_id = $_GPC['version_id']; goto aqUYf; TxnWc: case 'edit': goto zMQ0q; FpCiO: w7ra3: goto Vpx4W; Vpx4W: include $this->template('Service_class/edit'); goto WOVRr; zMQ0q: if (!empty($_GPC['id'])) { goto qles1; } goto NbDet; WOVRr: goto M7XFw; goto SlhzN; cu6AI: $list = pdo_get($tablename, array("id" => $_GPC['id'])); goto FpCiO; NbDet: $list['status'] = 1; goto XO6eC; JsOCO: qles1: goto cu6AI; XO6eC: goto w7ra3; goto JsOCO; SlhzN: case 'savemodel': goto bPNIY; zKRBv: $condition['bimg'] = $_GPC['bimg']; goto fZPWC; QrDhd: Mn7se: goto GCDyk; Razko: echo json_encode($json); goto aYIJJ; QZ5Ce: if (!empty($_GPC['index'])) { goto MaJJB; } goto Q9BEA; FtqC0: MaJJB: goto FdiBi; CyDPQ: echo json_encode($json); goto zo3ip; OHnbm: $condition['status'] = -1; goto k53j0; aYIJJ: cT0Fn: goto NTDRK; JsNo_: $json = array("status" => 0, "msg" => "操作失败"); goto CyDPQ; jTErc: $request = pdo_insert($tablename, $condition); goto K7Nja; uFnDU: if (empty($_GPC['id'])) { goto DoTIZ; } goto js4_3; js4_3: $request = pdo_update($tablename, $condition, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto ZBqU9; zo3ip: goto cT0Fn; goto SkyUy; zECPe: goto lh0qC; goto FtqC0; xsDTC: goto zV_8P; goto QrDhd; ZBqU9: goto PsYKi; goto iMpM1; oCHBj: $condition['status'] = $_GPC['status']; goto ClN2B; CIGKr: $condition['sort'] = $_GPC['sort']; goto xsDTC; t0iPt: $json = array("status" => 1, "msg" => "操作成功"); goto Razko; ryMcC: $condition['name'] = $_GPC['name']; goto zKRBv; fZPWC: if (empty($_GPC['status'])) { goto tuzw_; } goto oCHBj; mq_m5: $condition['uniacid'] = $uniacid; goto ryMcC; Jbb6j: lh0qC: goto hBZK7; bPNIY: $condition = array(); goto mq_m5; ClN2B: goto BRzmt; goto fNtiG; SkyUy: Ecyh3: goto t0iPt; fNtiG: tuzw_: goto OHnbm; hBZK7: if (empty($_GPC['sort'])) { goto Mn7se; } goto CIGKr; iMpM1: DoTIZ: goto jTErc; IcmWJ: zV_8P: goto uFnDU; Q9BEA: $condition['index'] = -1; goto zECPe; K7Nja: PsYKi: goto Qknyy; NTDRK: goto M7XFw; goto y7ggL; FdiBi: $condition['index'] = $_GPC['index']; goto Jbb6j; k53j0: BRzmt: goto QZ5Ce; Qknyy: if (!empty($request)) { goto Ecyh3; } goto JsNo_; GCDyk: $condition['sort'] = 0; goto IcmWJ; y7ggL: case 'statuschange': goto vOlKe; WReHs: goto A10V2; goto ZIGK8; IPnZ_: if ($request) { goto F5jh7; } goto O4TdG; HfoxL: echo json_encode($json); goto WReHs; RHZwl: A10V2: goto rczsE; O4TdG: $json = array("status" => 0, "msg" => "操作失败"); goto HfoxL; vOlKe: $request = pdo_update($tablename, array($_GPC['name'] => $_GPC['status']), array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto IPnZ_; wZ6zc: echo json_encode($json); goto RHZwl; rczsE: goto M7XFw; goto Y_UWl; kbnNG: $json = array("status" => 1, "msg" => "操作成功"); goto wZ6zc; ZIGK8: F5jh7: goto kbnNG; Y_UWl: case 'delete': goto QL1GG; J2Zw0: $json = array("status" => 1, "msg" => "操作成功"); goto Dprf9; QeDpC: htEig: goto hsygP; hsygP: goto M7XFw; goto OWv13; ZOnas: if ($request) { goto MSiS3; } goto kCAog; r4z3S: MSiS3: goto J2Zw0; kCAog: $json = array("status" => 0, "msg" => "操作失败"); goto Wo65X; QL1GG: $request = pdo_delete($tablename, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto ZOnas; Wo65X: echo json_encode($json); goto VylFN; Dprf9: echo json_encode($json); goto QeDpC; VylFN: goto htEig; goto r4z3S; OWv13: } goto uxqhe; cu53K: } public function doWebService() { goto HurHP; mnven: $op = in_array($_GPC['op'], $ops) ? $_GPC['op'] : 'list'; goto eaxOM; t53B0: $uniacid = $_W['uniacid']; goto mnven; PGUwW: Q26mW: goto n9Oji; xDFdv: switch ($op) { case 'list': goto VDyKO; EsnOX: $xname = $_GPC['xname']; goto GpL7c; xDWKv: $pager = pagination($total, $pageindex, $pagesize); goto MOxYY; m5Tsq: $theme = $config['content']['theme']; goto sdG2r; WpzZN: ux9bd: goto fMVAY; P2WhN: $theme = 1; goto T0ziF; ANfjk: TtLlJ: goto Un7zW; Un7zW: PBdzD: goto KB2Oc; INsLc: HnyA4: goto kXUv6; GAnlo: $cid = $_GPC['cid']; goto Du1D7; T0ziF: $config = pdo_get('xc_beauty_config', array("xkey" => "theme", "uniacid" => $uniacid)); goto cQE8J; MOxYY: $list = pdo_getall($tablename, $condition, array(), '', 'sort DESC,createtime DESC', array($pageindex, $pagesize)); goto tiyzv; fMVAY: if (empty($_GPC['cid'])) { goto HnyA4; } goto GAnlo; k2ABX: oDIPD: goto f4Ryf; Xz1dy: $total = count($request); goto Bfl11; ZULXJ: goto xzkQN; goto G5M1V; giYdV: $condition = array(); goto BVkQm; VDyKO: $version_id = $_GPC['version_id']; goto giYdV; Bfl11: if (!isset($_GPC['page'])) { goto oDIPD; } goto N9MQ5; UC_zl: PzD6L: goto GyKLW; fzb_e: if (empty($config['content']['theme'])) { goto jUKU4; } goto m5Tsq; DYEE7: bl2XR: goto BSQ0h; SHQ3l: if (!$class) { goto PBdzD; } goto s8020; GpL7c: $condition['name LIKE'] = '%' . $_GPC['xname'] . '%'; goto WpzZN; BSQ0h: htYx5: goto P2WhN; cQE8J: if (!$config) { goto PzD6L; } goto KyK1X; Du1D7: $condition['cid'] = $_GPC['cid']; goto INsLc; A7Oq0: AzHJ9: goto CNUjz; KyK1X: $config['content'] = json_decode($config['content'], true); goto fzb_e; BVkQm: $condition['uniacid'] = $uniacid; goto RJiE3; f4Ryf: $pageindex = 1; goto A7Oq0; N9MQ5: $pageindex = intval($_GPC['page']); goto ZA4dh; sdG2r: jUKU4: goto UC_zl; s8020: foreach ($class as $x) { $datalist[$x['id']] = $x['name']; H9v1t: } goto ANfjk; tiyzv: $class = pdo_getall('xc_beauty_service_class', array("status" => 1, "uniacid" => $uniacid), array(), '', 'sort DESC,createtime DESC'); goto i0M2j; GyKLW: include $this->template('Service/list'); goto ZULXJ; kXUv6: $request = pdo_getall($tablename, $condition); goto Xz1dy; xztbs: if (empty($_GPC['xname'])) { goto ux9bd; } goto EsnOX; RJiE3: $condition['cid !='] = -1; goto xztbs; KB2Oc: if (!$list) { goto htYx5; } goto g02Tt; i0M2j: $datalist = array(); goto SHQ3l; g02Tt: foreach ($list as &$y) { $y['cidname'] = $datalist[$y['cid']]; iTf3j: } goto DYEE7; ZA4dh: goto AzHJ9; goto k2ABX; CNUjz: $pagesize = 15; goto xDWKv; G5M1V: case 'edit': goto o3JDo; ka_Ig: $list['kind'] = json_decode($list['kind'], true); goto ForbN; o3JDo: $class = pdo_getall('xc_beauty_service_class', array("status" => 1, "uniacid" => $uniacid), array(), '', 'sort DESC,createtime DESC'); goto WBBNE; vuQon: include $this->template('Service/edit'); goto H3k8N; ForbN: $list['content'] = json_decode($list['content'], true); goto SuSMJ; yfv0Q: $list['bimg'] = json_decode($list['bimg'], true); goto ka_Ig; ccc2m: $list['store_status'] = 1; goto Q9hE_; H3k8N: goto xzkQN; goto AsVvM; GxtqH: goto SFV_q; goto MqhcR; Q9hE_: $list['content_type'] = 1; goto GxtqH; SuSMJ: $list['store'] = json_decode($list['store'], true); goto sPyiC; WBBNE: if (!empty($_GPC['id'])) { goto BXRVr; } goto mJlPI; mJlPI: $list['status'] = 1; goto ccc2m; lT513: $list['flash_times'] = array("start" => $list['flash_start'], "end" => $list['flash_end']); goto n3rfi; yPwgc: SFV_q: goto vuQon; MqhcR: BXRVr: goto skj2r; uPg2i: if (!($list['flash_status'] == 1)) { goto ELsdA; } goto lT513; skj2r: $list = pdo_get($tablename, array("id" => $_GPC['id'])); goto yfv0Q; sPyiC: $list['parameter'] = json_decode($list['parameter'], true); goto uPg2i; n3rfi: ELsdA: goto yPwgc; AsVvM: case 'savemodel': goto Ca9iS; vXVC1: $json = array("status" => 0, "msg" => "操作失败"); goto HZPDu; f3IHG: r1Fwg: goto ysIOs; fGvt_: $condition['group_head_status'] = $_GPC['group_head_status']; goto Uf6mV; hXd0z: $condition['name'] = $_GPC['name']; goto wBPkG; WNZFJ: $condition['o_price'] = $_GPC['o_price']; goto CZba7; xn_vv: $condition['flash_status'] = -1; goto BrnLi; lp4U8: goto GX0Pm; goto bTx3D; IGnSV: YqCw5: goto lUmJm; gZ43m: $condition['home'] = $_GPC['home']; goto x_5QG; BRcVN: aIpbn: goto CwA91; cj1NK: $condition['group_index'] = $_GPC['group_index']; goto MnAUJ; OzFZl: $condition['level_one'] = $_GPC['level_one']; goto qs9T7; NNM3l: Y10jM: goto ONfoH; x_5QG: Y0MmP: goto P9ErG; UIruw: $condition['status'] = $_GPC['status']; goto usWOq; lWk9x: $request = pdo_update($tablename, $condition, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto zXcxM; JUo9p: if (empty($_GPC['group_index'])) { goto YqCw5; } goto cj1NK; xG4ty: if (empty($_GPC['xbimg'])) { goto IQxm_; } goto LW64G; uJFSy: $condition['parameter'] = htmlspecialchars_decode($_GPC['parameter']); goto lifUa; YfUn4: $condition['store_status'] = $_GPC['store_status']; goto ow32T; CZba7: $condition['sold'] = $_GPC['sold']; goto uJFSy; RnQdC: e0qk3: goto NltXN; pvww_: $condition['price'] = $_GPC['price']; goto WNZFJ; t6XHZ: $condition['simg'] = $_GPC['simg']; goto xG4ty; x0rxk: $condition['flash_index'] = -1; goto X2ZUe; VFwK6: $json = array("status" => 1, "msg" => "操作成功"); goto UiQ2o; quyYe: $condition['flash_end'] = $_GPC['flash_times']['end']; goto f3MrI; avhfW: $condition['flash_order'] = $_GPC['flash_order']; goto oWgBJ; s94zH: goto RCpyg; goto s4x8y; HzC5p: goto nFRHi; goto yYMvF; iIN8E: RCpyg: goto JUo9p; RbSlX: $condition['sort'] = 0; goto NNM3l; Il1J_: $condition['content_type'] = $_GPC['content_type']; goto l3ZCe; L_Bg2: $request = pdo_insert($tablename, $condition); goto sK3I6; AEckj: goto Y10jM; goto oBM2O; GekuI: $condition['group_head_price'] = $_GPC['group_head_price']; goto tTC0e; ysIOs: if (!empty($_GPC['flash_index'])) { goto LN7iA; } goto x0rxk; lFESL: $condition['shop'] = $_GPC['shop']; goto Zz3Jx; Kn4OR: J65u8: goto tVLzy; BIFVY: if (!empty($request)) { goto FfKgk; } goto vXVC1; NltXN: $condition['status'] = -1; goto coepo; CwA91: $condition['sale_status'] = $_GPC['sale_status']; goto k8RPB; wcopR: if (empty($_GPC['sort'])) { goto qRMGw; } goto NU5lk; s4x8y: j1bpg: goto rkNTy; wBPkG: $condition['cid'] = $_GPC['cid']; goto t6XHZ; ON_rO: FfKgk: goto VFwK6; K1L2B: $condition['group_total'] = $_GPC['group_total']; goto sAtEm; Ca9iS: $condition = array(); goto O0APq; rWJaT: $condition['content'] = htmlspecialchars_decode($_GPC['content']); goto YfUn4; qs9T7: $condition['level_two'] = $_GPC['level_two']; goto bhwgc; rkNTy: $condition['group_status'] = -1; goto iIN8E; HZPDu: echo json_encode($json); goto TZSBd; MJvv5: if (!empty($_GPC['home'])) { goto B2m4A; } goto Y_DN0; sK3I6: dEk8R: goto BIFVY; zXcxM: goto dEk8R; goto LGwGk; Uf6mV: GX0Pm: goto MJvv5; vaKl8: IQxm_: goto pvww_; sAtEm: $condition['type'] = $_GPC['type']; goto OzFZl; lifUa: $condition['group_price'] = $_GPC['group_price']; goto bfX5W; vlnZH: $condition['group_status'] = $_GPC['group_status']; goto s94zH; igQDu: $condition['flash_price'] = $_GPC['flash_price']; goto CtLXw; YFLqB: goto b0djU; goto BRcVN; K4IwZ: $condition['shop'] = -1; goto HzC5p; gAlvb: $condition['can_use'] = $_GPC['can_use']; goto Il1J_; CtLXw: $condition['flash_start'] = $_GPC['flash_times']['start']; goto quyYe; coepo: t1Gab: goto oZQVc; ilRsK: $condition['service_time'] = $_GPC['service_time']; goto gAlvb; SRZT9: if (!empty($_GPC['sale_status'])) { goto aIpbn; } goto C_ENv; oErrv: goto Y0MmP; goto S1V8B; Zz3Jx: nFRHi: goto x263J; oBM2O: qRMGw: goto RbSlX; pzUyQ: LN7iA: goto jwdRa; P9ErG: if (!empty($_GPC['shop'])) { goto GjHk2; } goto K4IwZ; C_ENv: $condition['sale_status'] = -1; goto YFLqB; LW64G: $condition['bimg'] = json_encode($_GPC['xbimg']); goto vaKl8; oZQVc: if (empty($_GPC['group_status'])) { goto j1bpg; } goto vlnZH; bhwgc: $condition['level_three'] = $_GPC['level_three']; goto rWJaT; BrnLi: goto r1Fwg; goto Kn4OR; tVLzy: $condition['flash_status'] = $_GPC['flash_status']; goto f3IHG; lUmJm: $condition['group_index'] = -1; goto M7JKI; bfX5W: $condition['group_number'] = $_GPC['group_number']; goto mMGf2; ptaOJ: goto xzkQN; goto JagBB; eSVpU: EMc0H: goto ptaOJ; S1V8B: B2m4A: goto gZ43m; Y_DN0: $condition['home'] = -1; goto oErrv; l3ZCe: $condition['content2'] = $_GPC['content2']; goto igQDu; X2ZUe: goto tVqBY; goto pzUyQ; UiQ2o: echo json_encode($json); goto eSVpU; jwdRa: $condition['flash_index'] = $_GPC['flash_index']; goto aAL3m; k8RPB: b0djU: goto wcopR; bTx3D: s5w8E: goto fGvt_; f3MrI: $condition['flash_member'] = $_GPC['flash_member']; goto avhfW; LGwGk: OVkXT: goto L_Bg2; NU5lk: $condition['sort'] = $_GPC['sort']; goto AEckj; x263J: if (empty($_GPC['status'])) { goto e0qk3; } goto UIruw; M7JKI: sdh1y: goto OpM2J; aAL3m: tVqBY: goto SRZT9; TZSBd: goto EMc0H; goto ON_rO; ONfoH: if (empty($_GPC['id'])) { goto OVkXT; } goto lWk9x; yYMvF: GjHk2: goto lFESL; O0APq: $condition['uniacid'] = $uniacid; goto hXd0z; OpM2J: if (!empty($_GPC['flash_status'])) { goto J65u8; } goto xn_vv; EanRe: $condition['group_stock'] = $_GPC['group_stock']; goto GekuI; tTC0e: if (!empty($_GPC['group_head_status'])) { goto s5w8E; } goto dIAxq; ow32T: $condition['store'] = htmlspecialchars_decode($_GPC['store']); goto ilRsK; dIAxq: $condition['group_head_status'] = -1; goto lp4U8; usWOq: goto t1Gab; goto RnQdC; mMGf2: $condition['group_limit'] = $_GPC['group_limit']; goto K1L2B; oWgBJ: $condition['flash_shu'] = $_GPC['flash_shu']; goto EanRe; MnAUJ: goto sdh1y; goto IGnSV; JagBB: case 'statuschange': goto NjrO9; dsqrl: v6AXH: goto oifig; Y8OR9: $json = array("status" => 0, "msg" => "操作失败"); goto n3o5k; NjrO9: $request = pdo_update($tablename, array($_GPC['name'] => $_GPC['status']), array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto mgjxs; JmySm: goto v6AXH; goto hPPeC; n_znd: $json = array("status" => 1, "msg" => "操作成功"); goto kPQlj; kPQlj: echo json_encode($json); goto dsqrl; hPPeC: TJgi_: goto n_znd; mgjxs: if ($request) { goto TJgi_; } goto Y8OR9; n3o5k: echo json_encode($json); goto JmySm; oifig: goto xzkQN; goto YZZ99; YZZ99: case 'delete': goto Wuhiy; P2bYt: echo json_encode($json); goto q2sKV; FjDWS: aBrI9: goto p_NIg; k9DC8: echo json_encode($json); goto yYO3e; LLRz0: if ($request) { goto aBrI9; } goto AusJ4; yYO3e: goto CvZNF; goto FjDWS; Wuhiy: $request = pdo_delete($tablename, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto LLRz0; p_NIg: $json = array("status" => 1, "msg" => "操作成功"); goto P2bYt; AusJ4: $json = array("status" => 0, "msg" => "操作失败"); goto k9DC8; pbQmQ: goto xzkQN; goto bM3pY; q2sKV: CvZNF: goto pbQmQ; bM3pY: case 'service': goto rK0HV; P88QN: $condition = array(); goto lS4op; RXBEr: N7eOV: goto wB6jE; nQdV9: $pageindex = 1; goto RXBEr; tJ3yR: goto xzkQN; goto oQ20R; NXXoS: include $this->template('Service/service'); goto tJ3yR; aPlyU: $request = pdo_getall($tablename, $condition); goto PR5Qw; vCUiC: g0sRu: goto aPlyU; LPToe: $pageindex = intval($_GPC['page']); goto GPQdd; rK0HV: $tablename = 'xc_beauty_store'; goto mor24; wB6jE: $pagesize = 6; goto S1egA; I_4GX: $condition['name LIKE'] = '%' . $_GPC['xname'] . '%'; goto vCUiC; S1egA: $pager = pagination($total, $pageindex, $pagesize); goto T3PqY; lS4op: $condition['uniacid'] = $uniacid; goto sQ4Xz; HIl6S: $xname = $_GPC['xname']; goto I_4GX; u2Bgx: if (!isset($_GPC['page'])) { goto BLxyk; } goto LPToe; mor24: $version_id = $_GPC['version_id']; goto P88QN; GPQdd: goto N7eOV; goto cIjt4; T3PqY: $list = pdo_getall($tablename, $condition, array(), '', 'sort desc,createtime DESC', array($pageindex, $pagesize)); goto NXXoS; cIjt4: BLxyk: goto nQdV9; PR5Qw: $total = count($request); goto u2Bgx; sQ4Xz: if (empty($_GPC['xname'])) { goto g0sRu; } goto HIl6S; oQ20R: } goto PGUwW; HurHP: $ops = array("list", "edit", "savemodel", "delete", "statuschange", "service"); goto KpjPs; eaxOM: $tablename = 'xc_beauty_service'; goto xDFdv; n9Oji: xzkQN: goto n8pHp; KpjPs: global $_GPC, $_W; goto t53B0; n8pHp: } public function doWebTimes() { goto pTBl9; e9Ad4: $uniacid = $_W['uniacid']; goto EQMRR; yciB1: y0vjC: goto SXg_M; cvOPM: global $_GPC, $_W; goto e9Ad4; EQMRR: $op = in_array($_GPC['op'], $ops) ? $_GPC['op'] : 'list'; goto cSOj6; cSOj6: $tablename = 'xc_beauty_times'; goto vhrW8; vhrW8: switch ($op) { case 'list': goto tqQNm; ceKcS: $condition['name LIKE'] = '%' . $_GPC['xname'] . '%'; goto eMf2Q; Lmiv0: $request = pdo_getall($tablename, $condition); goto EwlHi; OwtLE: $pageindex = 1; goto U1yys; EwlHi: $total = count($request); goto RkXsd; ubY3f: iEVXH: goto OwtLE; SdWOF: olyvG: goto FPax0; vEr5I: $xname = $_GPC['xname']; goto ceKcS; FLWn4: if (!$list) { goto olyvG; } goto LzVFI; ZnmT2: $list = pdo_getall($tablename, $condition, array(), '', 'createtime DESC', array($pageindex, $pagesize)); goto FLWn4; FALzX: $pager = pagination($total, $pageindex, $pagesize); goto ZnmT2; tqQNm: $version_id = $_GPC['version_id']; goto utZCa; vMZ0U: $pagesize = 15; goto FALzX; FPax0: include $this->template('Times/list'); goto KsL5m; LzVFI: foreach ($list as &$x) { goto xu2rM; xu2rM: switch ($x['week']) { case 1: $x['name'] = '周一'; goto rv5EQ; case 2: $x['name'] = '周二'; goto rv5EQ; case 3: $x['name'] = '周三'; goto rv5EQ; case 4: $x['name'] = '周四'; goto rv5EQ; case 5: $x['name'] = '周五'; goto rv5EQ; case 6: $x['name'] = '周六'; goto rv5EQ; case 7: $x['name'] = '周日'; goto rv5EQ; } goto sikNi; asPZe: fiAwW: goto Qusfb; sikNi: C0b0y: goto qbI5R; qbI5R: rv5EQ: goto asPZe; Qusfb: } goto gkq5R; eMf2Q: vSAmr: goto Lmiv0; RkXsd: if (!isset($_GPC['page'])) { goto iEVXH; } goto myUZN; KsL5m: goto y0vjC; goto xlb4S; kdQlo: $condition['uniacid'] = $uniacid; goto nUu2t; utZCa: $condition = array(); goto kdQlo; U1yys: EhLdN: goto vMZ0U; gkq5R: XF2bW: goto SdWOF; myUZN: $pageindex = intval($_GPC['page']); goto tiidi; tiidi: goto EhLdN; goto ubY3f; nUu2t: if (empty($_GPC['xname'])) { goto vSAmr; } goto vEr5I; xlb4S: case 'edit': goto RCFwI; EVONx: rmFSo: goto r_dUL; M5VZX: TdATO: goto WeHub; iI42V: goto TdATO; goto EVONx; aiSbh: $list['status'] = 1; goto iI42V; YSjM7: $list['content'] = json_decode($list['content'], true); goto M5VZX; wajrt: goto y0vjC; goto I3DTl; r_dUL: $list = pdo_get($tablename, array("id" => $_GPC['id'])); goto YSjM7; WeHub: include $this->template('Times/edit'); goto wajrt; RCFwI: if (!empty($_GPC['id'])) { goto rmFSo; } goto aiSbh; I3DTl: case 'savemodel': goto cy8ef; qMJzK: $condition['week'] = $_GPC['week']; goto dUlY7; m6TvJ: vYeB9: goto AJA8M; N2F2F: $json = array("status" => 0, "msg" => "操作失败"); goto fOBwO; cnLgA: k4pBA: goto KfOst; EGS4o: goto rw5ws; goto vseIw; RJ3Fo: $condition['uniacid'] = $uniacid; goto qMJzK; rKL5c: echo json_encode($json); goto cnLgA; JN3EB: pLk5B: goto t9Tm5; vqogB: goto iNIkt; goto m6TvJ; dUlY7: $condition['content'] = htmlspecialchars_decode($_GPC['content']); goto ez8Ju; t9Tm5: $json = array("status" => 1, "msg" => "操作成功"); goto rKL5c; x2RDn: goto k4pBA; goto JN3EB; DSQ6r: if (!empty($request)) { goto pLk5B; } goto N2F2F; nX0ut: $condition['status'] = -1; goto svYln; z2uFZ: if (empty($_GPC['id'])) { goto vYeB9; } goto LoFD4; cy8ef: $condition = array(); goto RJ3Fo; BlZ9n: iNIkt: goto DSQ6r; fOBwO: echo json_encode($json); goto x2RDn; LoFD4: $request = pdo_update($tablename, $condition, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto vqogB; ez8Ju: if (empty($_GPC['status'])) { goto s85yX; } goto BYsMi; svYln: rw5ws: goto z2uFZ; BYsMi: $condition['status'] = $_GPC['status']; goto EGS4o; vseIw: s85yX: goto nX0ut; AJA8M: $request = pdo_insert($tablename, $condition); goto BlZ9n; KfOst: goto y0vjC; goto Jwqi3; Jwqi3: case 'statuschange': goto jIfsC; lTzhL: $json = array("status" => 1, "msg" => "操作成功"); goto L8iT8; L8iT8: echo json_encode($json); goto f1RPg; rRn4Z: hsstU: goto lTzhL; mpyLo: goto y0vjC; goto UibnE; jIfsC: $request = pdo_update($tablename, array($_GPC['name'] => $_GPC['status']), array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto tnkOc; f1RPg: J_1q4: goto mpyLo; M4lb3: echo json_encode($json); goto fduOS; fduOS: goto J_1q4; goto rRn4Z; tnkOc: if ($request) { goto hsstU; } goto twm5p; twm5p: $json = array("status" => 0, "msg" => "操作失败"); goto M4lb3; UibnE: case 'delete': goto P1IQc; KVWGA: if ($request) { goto iUhf3; } goto hRIjl; Ugiq1: goto D27xn; goto JaUnN; Qii2F: echo json_encode($json); goto Ugiq1; JaUnN: iUhf3: goto ypmyi; P1IQc: $request = pdo_delete($tablename, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto KVWGA; hRIjl: $json = array("status" => 0, "msg" => "操作失败"); goto Qii2F; ggLEH: D27xn: goto lPDJK; ypmyi: $json = array("status" => 1, "msg" => "操作成功"); goto ziEle; ziEle: echo json_encode($json); goto ggLEH; lPDJK: goto y0vjC; goto jr27e; jr27e: } goto Y67ge; Y67ge: HLrVP: goto yciB1; pTBl9: $ops = array("list", "edit", "savemodel", "delete", "statuschange"); goto cvOPM; SXg_M: } public function doWebPrize() { goto UKzQi; tq9bB: foFCr: goto l6o79; eGQ3H: $tablename = 'xc_beauty_prize'; goto Qma2O; dMb5x: $uniacid = $_W['uniacid']; goto Pd0qm; gLgli: MTyYa: goto tq9bB; Qma2O: switch ($op) { case 'list': goto DSRwx; BYgPY: $list = pdo_getall($tablename, $condition, array(), '', 'sort DESC,createtime DESC', array($pageindex, $pagesize)); goto ul429; xRO1M: $pagesize = 15; goto n4vEO; DSRwx: $version_id = $_GPC['version_id']; goto ON3kT; icP_c: $request = pdo_getall($tablename, $condition); goto sO1rJ; bCKB3: YfsSM: goto i4I7P; i4I7P: Ba_1h: goto SSfYf; ul429: if (!$list) { goto Ba_1h; } goto hIG6_; I2khS: $xname = $_GPC['xname']; goto UPXs4; xl5Ux: if (empty($_GPC['xname'])) { goto jmcn1; } goto I2khS; C7WH_: $pageindex = 1; goto z7ttl; z7ttl: AnQe_: goto xRO1M; jXE12: $condition['uniacid'] = $uniacid; goto xl5Ux; n4vEO: $pager = pagination($total, $pageindex, $pagesize); goto BYgPY; lTsaR: goto foFCr; goto etm0z; Fijy4: $pageindex = intval($_GPC['page']); goto S6bhG; saPRB: jmcn1: goto icP_c; zJpRJ: if (!isset($_GPC['page'])) { goto c6Bw9; } goto Fijy4; UPXs4: $condition['name LIKE'] = '%' . $_GPC['xname'] . '%'; goto saPRB; ON3kT: $condition = array(); goto jXE12; oWoZP: c6Bw9: goto C7WH_; hIG6_: foreach ($list as &$x) { goto U1HmW; eqK1g: if (!($x['type'] == 3)) { goto mvF0e; } goto rkZp0; tGYJE: tIwJF: goto Ud3vC; Ud3vC: $x['type_name'] = '优惠券'; goto s3Rph; rkZp0: $x['type_name'] = '谢谢参与'; goto DZasH; BgAXr: DfVid: goto tYmtN; DZasH: mvF0e: goto H0hwy; H0hwy: goto wdd81; goto I_iV_; Hf5Aq: wdd81: goto gRJlu; U1HmW: if ($x['type'] == 1) { goto tIwJF; } goto no5zy; s3Rph: vPnar: goto BgAXr; I_iV_: rGIRW: goto eiQDX; no5zy: if ($x['type'] == 2) { goto rGIRW; } goto eqK1g; gRJlu: goto vPnar; goto tGYJE; eiQDX: $x['type_name'] = '实物'; goto Hf5Aq; tYmtN: } goto bCKB3; SSfYf: include $this->template('Prize/list'); goto lTsaR; sO1rJ: $total = count($request); goto zJpRJ; S6bhG: goto AnQe_; goto oWoZP; etm0z: case 'edit': goto MRI_m; MRI_m: if (!empty($_GPC['id'])) { goto KXy0P; } goto FOz7p; Ethup: KXy0P: goto s6wNd; wQJ4R: include $this->template('Prize/edit'); goto ZStYo; FOz7p: $list['status'] = 1; goto LFXZR; mdNHv: Cn0l_: goto wQJ4R; LFXZR: $list['type'] = 1; goto CActw; s6wNd: $list = pdo_get($tablename, array("id" => $_GPC['id'])); goto mdNHv; CActw: goto Cn0l_; goto Ethup; ZStYo: goto foFCr; goto f3s3m; f3s3m: case 'savemodel': goto Ate2Y; BpCi8: if (!($condition['type'] == 3)) { goto ZY3N0; } goto tfX6A; TM9Xy: if ($condition['type'] == 2) { goto dEUvY; } goto BpCi8; EcguI: echo json_encode($json); goto Mw_dI; fudJx: $condition['member'] = $_GPC['member']; goto rwW6z; Dg6g0: $condition['status'] = -1; goto IDbQV; yQMpv: $condition['status'] = $_GPC['status']; goto vknoE; yWN8U: $json = array("status" => 1, "msg" => "操作成功"); goto EcguI; ZGbdZ: $condition['times'] = $_GPC['times']; goto fudJx; tfX6A: $condition['name'] = $_GPC['empty_name']; goto Y5XNO; PsCD5: hEzDo: goto gnIA8; BpajG: f4Wlr: goto yWN8U; FqXf0: $condition['name'] = $_GPC['cid_name']; goto X2A6I; JY7l7: if (empty($_GPC['id'])) { goto AbljH; } goto u52uP; g2w8T: if (!empty($request)) { goto f4Wlr; } goto wrhP4; xnawS: $condition['name'] = $_GPC['prize_name']; goto sA2Bj; Mw_dI: EvliM: goto yI9P7; jvJwC: $condition['uniacid'] = $uniacid; goto yw0BG; rwW6z: if (empty($_GPC['status'])) { goto xTys3; } goto yQMpv; WiwVo: AbljH: goto NqQUr; NqQUr: $request = pdo_insert($tablename, $condition); goto d5tbK; nQdN1: rQ1GP: goto mzUEE; X35jY: goto Av75w; goto WiwVo; d5tbK: Av75w: goto g2w8T; gnIA8: $condition['sort'] = 0; goto piY5k; yw0BG: $condition['type'] = $_GPC['type']; goto KFPE3; Y5XNO: ZY3N0: goto U5HX6; yI9P7: goto foFCr; goto nI_Of; piY5k: HFTpJ: goto JY7l7; X2A6I: $condition['cid'] = $_GPC['cid']; goto nQdN1; mzUEE: $condition['simg'] = $_GPC['simg']; goto ZGbdZ; lRCaV: goto EvliM; goto BpajG; CeIj2: zZ8n6: goto FqXf0; Ate2Y: $condition = array(); goto jvJwC; IKQsl: goto rQ1GP; goto CeIj2; caU8i: echo json_encode($json); goto lRCaV; KFPE3: if ($condition['type'] == 1) { goto zZ8n6; } goto TM9Xy; T5qaA: $condition['sort'] = $_GPC['sort']; goto hFLzC; mPb1I: if (empty($_GPC['sort'])) { goto hEzDo; } goto T5qaA; sA2Bj: jV3vQ: goto IKQsl; vknoE: goto uj2v2; goto cChCB; OTUy_: dEUvY: goto xnawS; hFLzC: goto HFTpJ; goto PsCD5; wrhP4: $json = array("status" => 0, "msg" => "操作失败"); goto caU8i; IDbQV: uj2v2: goto mPb1I; cChCB: xTys3: goto Dg6g0; U5HX6: goto jV3vQ; goto OTUy_; u52uP: $request = pdo_update($tablename, $condition, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto X35jY; nI_Of: case 'statuschange': goto Y4Cdz; S_jZh: if ($request) { goto xy2fN; } goto A2kwH; WsvXe: goto foFCr; goto CXYcW; Y4Cdz: $request = pdo_update($tablename, array($_GPC['name'] => $_GPC['status']), array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto S_jZh; xDCLX: goto FelDN; goto E79Lf; E79Lf: xy2fN: goto MwlqS; C6qsx: echo json_encode($json); goto rk9pr; MwlqS: $json = array("status" => 1, "msg" => "操作成功"); goto C6qsx; AfbYk: echo json_encode($json); goto xDCLX; rk9pr: FelDN: goto WsvXe; A2kwH: $json = array("status" => 0, "msg" => "操作失败"); goto AfbYk; CXYcW: case 'delete': goto sEPNP; sEPNP: $request = pdo_delete($tablename, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto Qebd6; wdchF: mzZOr: goto nW14r; uRj1a: $json = array("status" => 0, "msg" => "操作失败"); goto gj32L; BX2V4: goto mzZOr; goto GXEDv; kK2dt: $json = array("status" => 1, "msg" => "操作成功"); goto M90js; Qebd6: if ($request) { goto IzEjW; } goto uRj1a; M90js: echo json_encode($json); goto wdchF; gj32L: echo json_encode($json); goto BX2V4; nW14r: goto foFCr; goto tNwx8; GXEDv: IzEjW: goto kK2dt; tNwx8: case 'coupon': goto HW6NM; c2BBs: zXDPT: goto Uo1oQ; ez7XF: $condition = array(); goto owWzb; tN8uF: $pagesize = 6; goto AiLCp; aP5ij: $request = pdo_getall($tablename, $condition); goto TVGdE; JJujq: $list = pdo_getall($tablename, $condition, array(), '', 'sort DESC,createtime DESC', array($pageindex, $pagesize)); goto OCpdF; TVGdE: $total = count($request); goto CEOjk; dA23c: KYBBg: goto tN8uF; owWzb: $condition['uniacid'] = $uniacid; goto sl6rN; kmpuH: goto foFCr; goto WXwr1; MhzAq: goto KYBBg; goto cZGYy; sl6rN: $condition['type'] = 4; goto Ntdtn; dGqL7: Pt7Qb: goto c2BBs; AiLCp: $pager = pagination($total, $pageindex, $pagesize); goto JJujq; Ys36b: LD9cb: goto aP5ij; CEOjk: if (!isset($_GPC['page'])) { goto s0SHG; } goto QcUiP; OCpdF: if (!$list) { goto zXDPT; } goto vrsbq; QY5xx: $condition['name LIKE'] = '%' . $_GPC['xname'] . '%'; goto Ys36b; cZGYy: s0SHG: goto OKqoZ; Uo1oQ: include $this->template('Prize/coupon'); goto kmpuH; KDZjA: $xname = $_GPC['xname']; goto QY5xx; HW6NM: $tablename = 'xc_beauty_coupon'; goto ez7XF; OKqoZ: $pageindex = 1; goto dA23c; Ntdtn: if (empty($_GPC['xname'])) { goto LD9cb; } goto KDZjA; vrsbq: foreach ($list as &$x) { goto xg05N; otMFo: if ($x['type'] == 3) { goto DtYNR; } goto MSFsU; kyUgc: $x['type_name'] = '抽奖'; goto wL_aC; FZS3S: Xf0TE: goto D2p8c; sisOr: $x['type_name'] = '会员专享'; goto HE1B9; u50tQ: if ($x['type'] == 2) { goto Y81_g; } goto otMFo; x2DF4: goto b64fd; goto ICWZ5; D2p8c: $x['type_name'] = '通用'; goto wppFl; HE1B9: b64fd: goto v1hzR; etUZ5: UAAOi: goto x2DF4; DcXFr: if ($x['type'] == 1) { goto Xf0TE; } goto u50tQ; ICWZ5: Y81_g: goto sisOr; By6ce: iBMvN: goto pTi4g; v1hzR: goto ov8D1; goto FZS3S; lwlDa: goto UAAOi; goto F1zZK; wppFl: ov8D1: goto By6ce; F1zZK: DtYNR: goto SWrUi; SWrUi: $x['type_name'] = '积分兑换'; goto etUZ5; wL_aC: XJ041: goto lwlDa; xg05N: $x['times'] = json_decode($x['times'], true); goto DcXFr; MSFsU: if (!($x['type'] == 4)) { goto XJ041; } goto kyUgc; pTi4g: } goto dGqL7; QcUiP: $pageindex = intval($_GPC['page']); goto MhzAq; WXwr1: } goto gLgli; w0eTZ: global $_GPC, $_W; goto dMb5x; UKzQi: $ops = array("list", "edit", "savemodel", "delete", "statuschange", "coupon"); goto w0eTZ; Pd0qm: $op = in_array($_GPC['op'], $ops) ? $_GPC['op'] : 'list'; goto eGQ3H; l6o79: } public function doWebCoupon() { goto KBgwp; vuGYw: switch ($op) { case 'list': goto Ba1dG; tdTvU: if (!isset($_GPC['page'])) { goto SE9NJ; } goto EoCcD; mg_40: EJP_m: goto paYtr; bf5ee: $pageindex = 1; goto TQ75N; EoCcD: $pageindex = intval($_GPC['page']); goto U0IB5; FZVRT: xa_ht: goto mg_40; oWG9t: $total = count($request); goto tdTvU; paYtr: include $this->template('Coupon/list'); goto wMDsv; hzzzP: foreach ($list as &$x) { goto PfeIJ; TReWi: goto YTLes; goto uofym; P0LVM: goto uJ1sK; goto L3asL; kD6SH: xHSwg: goto wZDCf; rufyX: goto Jm0nW; goto FBMTG; buAwz: if ($x['type'] == 1) { goto l_hIu; } goto z7DVI; PfeIJ: $x['times'] = json_decode($x['times'], true); goto buAwz; hIyKF: Jm0nW: goto kD6SH; z6Adi: $x['type_name'] = '抽奖'; goto Zl0rO; tZtzU: uJ1sK: goto rufyX; iEFNY: $x['type_name'] = '会员专享'; goto tZtzU; L3asL: hp2Hl: goto iEFNY; hw5Y_: if ($x['type'] == 3) { goto v0oVN; } goto enf8J; FBMTG: l_hIu: goto ZuK4z; ZuK4z: $x['type_name'] = '通用'; goto hIyKF; GN95I: $x['type_name'] = '积分兑换'; goto GMs6i; Zl0rO: CFFG0: goto TReWi; uofym: v0oVN: goto GN95I; z7DVI: if ($x['type'] == 2) { goto hp2Hl; } goto hw5Y_; enf8J: if (!($x['type'] == 4)) { goto CFFG0; } goto z6Adi; GMs6i: YTLes: goto P0LVM; wZDCf: } goto FZVRT; CaZ46: $list = pdo_getall($tablename, $condition, array(), '', 'sort DESC,createtime DESC', array($pageindex, $pagesize)); goto xaV26; xaV26: if (!$list) { goto EJP_m; } goto hzzzP; Ba1dG: $condition = array(); goto q2kQh; wMDsv: goto kibi6; goto UEwgC; IUKMY: $pager = pagination($total, $pageindex, $pagesize); goto CaZ46; bQ10e: $pagesize = 15; goto IUKMY; q2kQh: $condition['uniacid'] = $uniacid; goto pRrpm; TQ75N: fHLVr: goto bQ10e; IU5Ti: SE9NJ: goto bf5ee; M1wl2: $condition['name LIKE'] = '%' . $_GPC['xname'] . '%'; goto T4Tn3; U0IB5: goto fHLVr; goto IU5Ti; T4Tn3: TFnMH: goto UEdw4; pRrpm: if (empty($_GPC['xname'])) { goto TFnMH; } goto zOlmk; zOlmk: $xname = $_GPC['xname']; goto M1wl2; UEdw4: $request = pdo_getall($tablename, $condition); goto oWG9t; UEwgC: case 'edit': goto aAPMO; lhCk2: $list['total'] = -1; goto toJMh; iWEii: $list = pdo_get($tablename, array("id" => $_GPC['id'])); goto acXva; Gs4DU: goto kibi6; goto TXf26; XlBQX: FXAYl: goto N6PBx; N6PBx: include $this->template('Coupon/edit'); goto Gs4DU; jK1cy: $list['status'] = 1; goto lhCk2; toJMh: goto FXAYl; goto VJUFp; aAPMO: if (!empty($_GPC['id'])) { goto psGbJ; } goto jK1cy; VJUFp: psGbJ: goto iWEii; acXva: $list['times'] = json_decode($list['times'], true); goto XlBQX; TXf26: case 'savemodel': goto ikkgc; kljQz: goto kibi6; goto Ll2bS; ul0uM: VVGoM: goto aBqgc; ZznIv: $json = array("status" => 0, "msg" => "操作失败"); goto vOSIg; PjERg: $json = array("status" => 1, "msg" => "操作成功"); goto JJwS5; KMeME: $condition['name'] = $_GPC['name']; goto prleb; GSZxY: paxEW: goto M7S17; gcAdw: c0owu: goto G3Qzy; Zegmh: if ($_GPC['type'] == 3) { goto en8fV; } goto byyDN; W7Qyv: $request = pdo_update($tablename, $condition, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto OyXX0; eofZZ: $condition['sort'] = $_GPC['sort']; goto YzqIA; o4XGL: $condition['total'] = -1; goto Pv7jo; Dm9Wo: hwKT7: goto PjERg; OyXX0: goto c0owu; goto Hr_qL; O6GcQ: $condition['total'] = $_GPC['total']; goto ul0uM; ikkgc: $condition = array(); goto kNui3; aBqgc: if (!empty($_GPC['status'])) { goto paxEW; } goto lnNsP; M7S17: $condition['status'] = $_GPC['status']; goto YaaHz; Pv7jo: goto VVGoM; goto g1Ry2; sELmA: if (empty($_GPC['sort'])) { goto kVHw1; } goto eofZZ; NUWAi: if (empty($_GPC['id'])) { goto PSTGU; } goto W7Qyv; lJ7Sw: $request = pdo_insert($tablename, $condition); goto gcAdw; g1Ry2: PrwSD: goto O6GcQ; Eg8ek: goto p507J; goto GSZxY; lnNsP: $condition['status'] = -1; goto Eg8ek; prleb: $condition['condition'] = $_GPC['condition']; goto VCoOk; YaaHz: p507J: goto sELmA; JtX5X: TCk3o: goto Gu41x; D16af: kVHw1: goto yxin1; G3Qzy: if (!empty($request)) { goto hwKT7; } goto ZznIv; Gu41x: if (!empty($_GPC['istotal'])) { goto PrwSD; } goto o4XGL; kNui3: $condition['uniacid'] = $uniacid; goto KMeME; YzqIA: goto E4SI4; goto D16af; ibr6U: goto hMaiM; goto Dm9Wo; EVNlF: $condition['type'] = $_GPC['type']; goto Zegmh; StX7f: en8fV: goto D0Btn; ud_Ey: goto TCk3o; goto StX7f; JJwS5: echo json_encode($json); goto WyuUL; D0Btn: $condition['score'] = $_GPC['score']; goto JtX5X; byyDN: $condition['score'] = null; goto ud_Ey; vOSIg: echo json_encode($json); goto ibr6U; yxin1: $condition['sort'] = 0; goto oaFV9; oaFV9: E4SI4: goto NUWAi; WyuUL: hMaiM: goto kljQz; VCoOk: $condition['times'] = json_encode($_GPC['times']); goto EVNlF; Hr_qL: PSTGU: goto lJ7Sw; Ll2bS: case 'statuschange': goto MexzV; zRmkq: goto Pm7fa; goto QyIxE; QyIxE: LGd8a: goto juKRV; Nuq9C: goto kibi6; goto SCFsD; qkl83: if ($request) { goto LGd8a; } goto vEF1_; UFyxe: Pm7fa: goto Nuq9C; cqaPv: echo json_encode($json); goto UFyxe; MexzV: $request = pdo_update($tablename, array("status" => $_GPC['status']), array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto qkl83; juKRV: $json = array("status" => 1, "msg" => "操作成功"); goto cqaPv; dZMY_: echo json_encode($json); goto zRmkq; vEF1_: $json = array("status" => 0, "msg" => "操作失败"); goto dZMY_; SCFsD: case 'delete': goto yJ9Cz; PLU5z: echo json_encode($json); goto W6nQ2; WEI7s: iIE0d: goto uPoEL; c1inQ: echo json_encode($json); goto wx8fF; yJ9Cz: $request = pdo_delete($tablename, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto hRmEs; uPoEL: $json = array("status" => 1, "msg" => "操作成功"); goto PLU5z; smns2: $json = array("status" => 0, "msg" => "操作失败"); goto c1inQ; wx8fF: goto wwykD; goto WEI7s; hRmEs: if ($request) { goto iIE0d; } goto smns2; xwsbP: goto kibi6; goto Bfb0Q; W6nQ2: wwykD: goto xwsbP; Bfb0Q: } goto Ztlur; CUGqY: global $_GPC, $_W; goto gtVWM; KBgwp: $ops = array("list", "edit", "savemodel", "delete", "statuschange"); goto CUGqY; Ztlur: AXySM: goto jklO2; gtVWM: $uniacid = $_W['uniacid']; goto VQp0Y; jklO2: kibi6: goto o2uUI; VQp0Y: $op = in_array($_GPC['op'], $ops) ? $_GPC['op'] : 'list'; goto PAQkB; PAQkB: $tablename = 'xc_beauty_coupon'; goto vuGYw; o2uUI: } public function doWebDiscuss() { goto ypS4W; Fyf6s: global $_GPC, $_W; goto nAFp6; HlEoR: IDhHm: goto JLSa1; ypS4W: $ops = array("list", "statuschange", "delete", "list2", "list3", "list4"); goto Fyf6s; J92Dw: $tablename = 'xc_beauty_discuss'; goto rKDGr; X525b: eeGzq: goto HlEoR; rKDGr: switch ($op) { case 'list': goto blNMv; NnoQM: foreach ($list as &$y) { goto B6hVl; B6hVl: $y['pname'] = $datalist[$y['pid']]['name']; goto tuL_d; VVPGe: QSyn1: goto oXV47; tuL_d: $y['imgs'] = json_decode($y['imgs'], true); goto VVPGe; oXV47: } goto UgigC; qZO2T: rxFdz: goto hXd9r; d5gMf: $openid = $_GPC['openid']; goto IMFH2; nyZa9: $pagesize = 15; goto R7vd0; zMzAO: cMPk0: goto iPuBT; iPuBT: $request = pdo_getall($tablename, $condition); goto te_Y1; f0E7b: UNfcC: goto y09Yh; R7vd0: $pager = pagination($total, $pageindex, $pagesize); goto HWTtt; Vsp9q: include $this->template('Discuss/list'); goto vSR5U; hxAca: $service = pdo_getall('xc_beauty_service', array("uniacid" => $uniacid)); goto SDPLz; y09Yh: $pageindex = 1; goto SFUdR; wBxqY: $condition['uniacid'] = $uniacid; goto REcWa; blNMv: $condition = array(); goto wBxqY; QZJMo: if (empty($_GPC['openid'])) { goto cMPk0; } goto d5gMf; VH0k9: $pageindex = intval($_GPC['page']); goto QYah0; vSR5U: goto IDhHm; goto QSnNW; Nf2MR: foreach ($service as $x) { $datalist[$x['id']] = $x; X31Mn: } goto qZO2T; UgigC: vED4R: goto Vsp9q; REcWa: $condition['type'] = 1; goto QZJMo; IMFH2: $condition['openid LIKE'] = '%' . $_GPC['openid'] . '%'; goto zMzAO; R87mh: if (!$service) { goto f22qf; } goto Nf2MR; SDPLz: $datalist = array(); goto R87mh; SFUdR: uv2YM: goto nyZa9; te_Y1: $total = count($request); goto Zx7k1; HWTtt: $list = pdo_getall($tablename, $condition, array(), '', 'createtime DESC', array($pageindex, $pagesize)); goto hxAca; QYah0: goto uv2YM; goto f0E7b; Zx7k1: if (!isset($_GPC['page'])) { goto UNfcC; } goto VH0k9; hXd9r: f22qf: goto NnoQM; QSnNW: case 'list2': goto wlt10; NQfIq: foreach ($service as $x) { $datalist[$x['id']] = $x; JPEEC: } goto IYNgW; TNa2f: tsWFG: goto rcWIH; DXj6M: if (!$service) { goto tsWFG; } goto NQfIq; IYNgW: zIFid: goto TNa2f; wlt10: $condition = array(); goto I0trS; U1jLM: $pageindex = 1; goto ccgrH; rcWIH: foreach ($list as &$y) { $y['name'] = $datalist[$y['pid']]['name']; wM10w: } goto urYvt; Aayup: $list = pdo_getall($tablename, $condition, array(), '', 'createtime DESC', array($pageindex, $pagesize)); goto odyWM; lkU7o: if (!isset($_GPC['page'])) { goto Qf6bq; } goto Gdh8U; DgxlC: Qf6bq: goto U1jLM; Gdh8U: $pageindex = intval($_GPC['page']); goto ZEU7O; DOkm3: $total = count($request); goto lkU7o; urYvt: PC9Rn: goto GDDXE; m_qIb: $openid = $_GPC['openid']; goto UKUnY; wlkkn: goto IDhHm; goto GHbtg; USp6t: juId_: goto tklpi; UKUnY: $condition['openid LIKE'] = '%' . $_GPC['openid'] . '%'; goto USp6t; tklpi: $request = pdo_getall($tablename, $condition); goto DOkm3; ccgrH: HizqA: goto E7BM7; IVGfj: $condition['type'] = 2; goto mJyds; I0trS: $condition['uniacid'] = $uniacid; goto IVGfj; mJyds: if (empty($_GPC['openid'])) { goto juId_; } goto m_qIb; E7BM7: $pagesize = 15; goto q1CfH; q1CfH: $pager = pagination($total, $pageindex, $pagesize); goto Aayup; ZEU7O: goto HizqA; goto DgxlC; odyWM: $service = pdo_getall('xc_beauty_store_member', array("uniacid" => $uniacid)); goto lrApS; GDDXE: include $this->template('Discuss/list2'); goto wlkkn; lrApS: $datalist = array(); goto DXj6M; GHbtg: case 'statuschange': goto eWeHm; YhwnC: if ($request) { goto AyqGD; } goto i29is; Jd5bg: goto IDhHm; goto TXU5U; eWeHm: $request = pdo_update($tablename, array("status" => $_GPC['status']), array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto YhwnC; gyuuk: AyqGD: goto qmkfa; i29is: $json = array("status" => 0, "msg" => "操作失败"); goto eVV2t; wqdDo: zFodE: goto Jd5bg; QE4MR: goto zFodE; goto gyuuk; eVV2t: echo json_encode($json); goto QE4MR; qmkfa: $json = array("status" => 1, "msg" => "操作成功"); goto JHtoZ; JHtoZ: echo json_encode($json); goto wqdDo; TXU5U: case 'delete': goto PmSl7; EFhO1: $data['bad_total'] = $service['bad_total'] - 1; goto tIKte; EC7by: if ($discuss['score'] == 1) { goto pNu2y; } goto QoBvO; R_7up: $data['discuss_total'] = $service['discuss_total'] - 1; goto EC7by; b3OoN: $json = array("status" => 0, "msg" => "操作失败"); goto a6fGv; BFWIy: goto YPeFz; goto ZwcJ3; n3RPz: $request = pdo_delete($tablename, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto ttVEy; FlCf3: if (!$service) { goto HE9Ys; } goto R_7up; Ad0TL: $json = array("status" => 1, "msg" => "操作成功"); goto AgWtI; cwXHY: goto IDhHm; goto l0DGn; QoBvO: if ($discuss['score'] == 2) { goto OOV0S; } goto lPBq4; ttVEy: if ($request) { goto VYi1X; } goto b3OoN; BKKwa: xLDSH: goto BFWIy; bI1jN: $service = pdo_get('xc_beauty_service', array("status" => 1, "id" => $discuss['pid'])); goto FlCf3; xWonQ: VYi1X: goto bI1jN; uioO4: pdo_update('xc_beauty_service', $data, array("status" => 1, "id" => $discuss['pid'])); goto Se0ny; zra8h: $data['good_total'] = $service['good_total'] - 1; goto v_JFe; G4qq_: goto tfMn3; goto xWonQ; Se0ny: HE9Ys: goto Ad0TL; t3wVv: $data['middle_total'] = $service['middle_total'] - 1; goto BKKwa; dDq7j: tfMn3: goto cwXHY; tIKte: xuW8i: goto efKuN; v_JFe: YPeFz: goto uioO4; ZwcJ3: pNu2y: goto zra8h; AgWtI: echo json_encode($json); goto dDq7j; lPBq4: if (!($discuss['score'] == 3)) { goto xuW8i; } goto EFhO1; a6fGv: echo json_encode($json); goto G4qq_; efKuN: goto xLDSH; goto S5SH0; S5SH0: OOV0S: goto t3wVv; PmSl7: $discuss = pdo_get($tablename, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto n3RPz; l0DGn: case 'list3': goto KSUoR; ppEom: $openid = $_GPC['openid']; goto Da_ng; J6gYS: $pagesize = 15; goto FGBMY; Ch8UM: $list = pdo_getall($tablename, $condition, array(), '', 'updatetime DESC,id DESC', array($pageindex, $pagesize)); goto EpzIe; pJNwz: if (!isset($_GPC['page'])) { goto Cj1do; } goto rIDz3; AyoFl: $request = pdo_getall($tablename, $condition); goto MY1vl; FGBMY: $pager = pagination($total, $pageindex, $pagesize); goto Ch8UM; RWUNe: goto IDhHm; goto E3xxK; MY1vl: $total = count($request); goto pJNwz; xY_7L: goto Xq4IG; goto ioofe; rIDz3: $pageindex = intval($_GPC['page']); goto xY_7L; ioofe: Cj1do: goto DRl1B; DRl1B: $pageindex = 1; goto Zjf5S; EpzIe: include $this->template('Discuss/list3'); goto RWUNe; VESMX: MG09p: goto AyoFl; KSUoR: $tablename = 'xc_beauty_onlines'; goto Hh6ST; Hh6ST: $condition = array(); goto czplw; czplw: $condition['uniacid'] = $uniacid; goto Vl2jj; Da_ng: $condition['openid LIKE'] = '%' . $_GPC['openid'] . '%'; goto VESMX; Vl2jj: if (empty($_GPC['openid'])) { goto MG09p; } goto ppEom; Zjf5S: Xq4IG: goto J6gYS; E3xxK: case 'list4': goto nhmRW; kJmSc: goto kGnoU; goto ScPmV; k1E5g: $condition = array(); goto iyj1u; pKec9: if (!isset($_GPC['page'])) { goto RLShN; } goto qoaEL; CtVm7: PnaWY: goto zrSjl; nhmRW: $id = $_GPC['id']; goto C0KWY; C0KWY: $tablename = 'xc_beauty_online_log'; goto k1E5g; gf3xD: $total = count($request); goto pKec9; lQZjV: if (empty($_GPC['openid'])) { goto MJuOf; } goto IsVU6; dtsS2: Yz0X5: goto CtVm7; gPEAm: $condition['pid'] = $_GPC['id']; goto lQZjV; dfJrp: foreach ($list as &$x) { goto ntcnz; P8LaD: rOuqk: goto nvFdM; TYmKP: $x['content'] = base64_decode($x['content']); goto RRtO_; nvFdM: oS5n3: goto dbGUH; ntcnz: if (!($x['type'] == 1)) { goto rOuqk; } goto TYmKP; RRtO_: $x['content'] = emoji($x['content'], $_GPC['m']); goto P8LaD; dbGUH: } goto dtsS2; KZb09: $request = pdo_getall($tablename, $condition); goto gf3xD; W_DEP: MJuOf: goto KZb09; IsVU6: $openid = $_GPC['openid']; goto Zv3va; Zv3va: $condition['openid LIKE'] = '%' . $_GPC['openid'] . '%'; goto W_DEP; qoaEL: $pageindex = intval($_GPC['page']); goto kJmSc; bjxig: $pagesize = 15; goto eAZjv; sOz_u: $list = pdo_getall($tablename, $condition, array(), '', 'id DESC', array($pageindex, $pagesize)); goto cnf8_; cnf8_: if (!$list) { goto PnaWY; } goto dfJrp; ScPmV: RLShN: goto UC375; OR9Dy: kGnoU: goto bjxig; k5Goj: goto IDhHm; goto ppwvt; zrSjl: include $this->template('Discuss/list4'); goto k5Goj; iyj1u: $condition['uniacid'] = $uniacid; goto gPEAm; UC375: $pageindex = 1; goto OR9Dy; eAZjv: $pager = pagination($total, $pageindex, $pagesize); goto sOz_u; ppwvt: } goto X525b; nAFp6: $uniacid = $_W['uniacid']; goto qglpq; qglpq: $op = in_array($_GPC['op'], $ops) ? $_GPC['op'] : 'list'; goto J92Dw; JLSa1: } public function doWebStore() { goto J_0Tj; WE6OR: switch ($op) { case 'list': goto QCGk2; Ehyf7: $list = pdo_getall($tablename, $condition, array(), '', 'sort desc,createtime DESC', array($pageindex, $pagesize)); goto z0_1d; xAUlN: goto Bz1nn; goto G1y7a; CwCr0: goto UrgM4; goto UNwuh; muS7f: $condition = array(); goto lxn93; gII0Y: $pageindex = 1; goto H2HT0; H2HT0: UrgM4: goto twEFs; hkzEx: $total = count($request); goto XhP10; twEFs: $pagesize = 15; goto Xbkb0; lIKPX: $pageindex = intval($_GPC['page']); goto CwCr0; QCGk2: $version_id = $_GPC['version_id']; goto muS7f; fK41i: $xname = $_GPC['xname']; goto VRTBm; zf242: P2KRV: goto biyGy; XhP10: if (!isset($_GPC['page'])) { goto eLYYY; } goto lIKPX; Xbkb0: $pager = pagination($total, $pageindex, $pagesize); goto Ehyf7; lxn93: $condition['uniacid'] = $uniacid; goto eBR4q; UNwuh: eLYYY: goto gII0Y; VRTBm: $condition['name LIKE'] = '%' . $_GPC['xname'] . '%'; goto zf242; z0_1d: include $this->template('Store/list'); goto xAUlN; eBR4q: if (empty($_GPC['xname'])) { goto P2KRV; } goto fK41i; biyGy: $request = pdo_getall($tablename, $condition); goto hkzEx; G1y7a: case 'edit': goto JHhfn; i4UVJ: LkU08: goto zCplG; V00f5: $list['status'] = 1; goto x4LiF; zJBJ4: include $this->template('Store/edit'); goto H5Dxp; zCplG: $list = pdo_get($tablename, array("id" => $_GPC['id'])); goto r44DC; JHhfn: if (!empty($_GPC['id'])) { goto LkU08; } goto V00f5; x4LiF: goto jBzPm; goto i4UVJ; r44DC: $list['map'] = json_decode($list['map'], true); goto RA53p; RA53p: $list['content'] = json_decode($list['content'], true); goto sO7FM; sO7FM: jBzPm: goto zJBJ4; H5Dxp: goto Bz1nn; goto UkIrc; UkIrc: case 'savemodel': goto f_Wiw; omzOK: $condition['machine_code'] = $_GPC['machine_code']; goto pawP7; L_TZl: $condition['print_status'] = $_GPC['print_status']; goto Pn8PH; oOoe7: $request = pdo_insert($tablename, $condition); goto fhl_F; f_Wiw: $condition = array(); goto MHxkd; O9lBV: $request = pdo_update($tablename, $condition, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto YFeUJ; XUCZZ: goto d9tC8; goto epy6b; I0oc2: $condition['simg'] = $_GPC['simg']; goto QG50J; dUJoq: $condition['plan_date'] = $_GPC['plan_date']; goto rdiRM; Sp5Vm: $condition['map'] = array("longitude" => $_GPC['longitude'], "latitude" => $_GPC['latitude']); goto TCav1; FPuCN: echo json_encode($json); goto vyUuP; BEX1G: if (!empty($_GPC['print_status'])) { goto WjjNX; } goto ucGk9; YWSX5: $condition['sort'] = $_GPC['sort']; goto omzOK; Ea5Um: if (empty($_GPC['id'])) { goto EL5o4; } goto O9lBV; COtQn: if (!empty($_GPC['status'])) { goto ZkJWH; } goto kxSsx; epy6b: hEf3T: goto HQuLc; A3yzX: $condition['sms'] = $_GPC['sms']; goto YWSX5; EDt39: ZkJWH: goto moorj; Xy3dj: $condition['sn'] = $_GPC['sn']; goto BEX1G; TCav1: $condition['map'] = json_encode($condition['map']); goto dUJoq; ZXYNi: $condition['address'] = $_GPC['address']; goto Sp5Vm; fhl_F: DeFQW: goto ibIWS; HBU2a: WjjNX: goto L_TZl; QG50J: $condition['mobile'] = $_GPC['mobile']; goto ZXYNi; Pn8PH: MoBHr: goto COtQn; L_YDM: $condition['name'] = $_GPC['name']; goto I0oc2; vyUuP: d9tC8: goto ZfX1r; YFeUJ: goto DeFQW; goto F16pk; ARe3M: X5y2b: goto Ea5Um; pawP7: $condition['msign'] = $_GPC['msign']; goto Xy3dj; MHxkd: $condition['uniacid'] = $uniacid; goto L_YDM; HQuLc: $json = array("status" => 1, "msg" => "操作成功"); goto FPuCN; ibIWS: if (!empty($request)) { goto hEf3T; } goto TmdVN; TmdVN: $json = array("status" => 0, "msg" => "操作失败"); goto rx1Ti; ZfX1r: goto Bz1nn; goto DVtk7; fr0QQ: goto X5y2b; goto EDt39; mDtSA: goto MoBHr; goto HBU2a; rx1Ti: echo json_encode($json); goto XUCZZ; rdiRM: $condition['content'] = htmlspecialchars_decode($_GPC['content']); goto A3yzX; ucGk9: $condition['print_status'] = -1; goto mDtSA; F16pk: EL5o4: goto oOoe7; kxSsx: $condition['status'] = -1; goto fr0QQ; moorj: $condition['status'] = $_GPC['status']; goto ARe3M; DVtk7: case 'statuschange': goto yWXRu; B7WXf: SxG0z: goto y6Jr6; VIWx9: goto Bz1nn; goto EROWH; yWXRu: $request = pdo_update($tablename, array("status" => $_GPC['status']), array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto nt86n; dxXvZ: $json = array("status" => 0, "msg" => "操作失败"); goto sjkoD; YPtxq: goto l2Ax3; goto B7WXf; dDKcS: echo json_encode($json); goto koWiK; sjkoD: echo json_encode($json); goto YPtxq; y6Jr6: $json = array("status" => 1, "msg" => "操作成功"); goto dDKcS; koWiK: l2Ax3: goto VIWx9; nt86n: if ($request) { goto SxG0z; } goto dxXvZ; EROWH: case 'delete': goto OsCoA; z5ZG4: $json = array("status" => 1, "msg" => "操作成功"); goto wuwin; wuwin: echo json_encode($json); goto YWw8K; z5HCX: $json = array("status" => 0, "msg" => "操作失败"); goto Ynk1U; AHhFy: GqPY5: goto z5ZG4; YWw8K: TFbfN: goto crwER; OsCoA: $request = pdo_delete($tablename, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto SJAOs; Ynk1U: echo json_encode($json); goto cjKki; SJAOs: if ($request) { goto GqPY5; } goto z5HCX; crwER: goto Bz1nn; goto R1qus; cjKki: goto TFbfN; goto AHhFy; R1qus: case 'store': goto zn8Ts; rX1dY: $request = pdo_getall($tablename, $condition); goto r1gXQ; R6rOq: $condition['uniacid'] = $uniacid; goto AWTl6; RwWGQ: $list = pdo_getall($tablename, $condition, array(), '', 'sort desc,createtime DESC', array($pageindex, $pagesize)); goto BOe2P; sVd65: $version_id = $_GPC['version_id']; goto uYL8B; GlY8H: $pager = pagination($total, $pageindex, $pagesize); goto RwWGQ; AWTl6: if (empty($_GPC['xname'])) { goto iPkNS; } goto VPSgE; VPSgE: $xname = $_GPC['xname']; goto aNzdx; IIi9v: goto Bz1nn; goto qSTDN; duRG0: $pageindex = intval($_GPC['page']); goto HHcwx; aNzdx: $condition['name LIKE'] = '%' . $_GPC['xname'] . '%'; goto UEgq2; zn8Ts: $tablename = 'xc_beauty_store'; goto sVd65; Wkqcb: $pagesize = 6; goto GlY8H; Izs2s: kUvZm: goto Wkqcb; UEgq2: iPkNS: goto rX1dY; r1gXQ: $total = count($request); goto YTRmv; uYL8B: $condition = array(); goto R6rOq; HHcwx: goto kUvZm; goto ci50a; ci50a: m89fY: goto eQzIw; eQzIw: $pageindex = 1; goto Izs2s; YTRmv: if (!isset($_GPC['page'])) { goto m89fY; } goto duRG0; BOe2P: include $this->template('Store/store'); goto IIi9v; qSTDN: } goto ekXHa; ZJLUY: $op = in_array($_GPC['op'], $ops) ? $_GPC['op'] : 'list'; goto dAd7g; JJr4F: Bz1nn: goto guxEa; xzbqh: global $_GPC, $_W; goto chXcz; dAd7g: $tablename = 'xc_beauty_store'; goto WE6OR; ekXHa: rJQQB: goto JJr4F; chXcz: $uniacid = $_W['uniacid']; goto ZJLUY; J_0Tj: $ops = array("list", "edit", "savemodel", "delete", "statuschange", "store"); goto xzbqh; guxEa: } public function doWebStore_service() { goto Eq7wj; XjoPA: RpTln: goto qTLkX; Og5GA: $tablename = 'xc_beauty_store_service'; goto pmlAr; RfFzl: $op = in_array($_GPC['op'], $ops) ? $_GPC['op'] : 'list'; goto Og5GA; fezfq: $uniacid = $_W['uniacid']; goto RfFzl; pmlAr: switch ($op) { case 'list': goto KzjWS; zSvSJ: $pager = pagination($total, $pageindex, $pagesize); goto giloj; B7qW2: $pageindex = intval($_GPC['page']); goto hM369; Xwseh: $total = count($request); goto V8p1m; xILl4: $condition['name LIKE'] = '%' . $_GPC['xname'] . '%'; goto REGRQ; TnLCl: $pagesize = 15; goto zSvSJ; giloj: $list = pdo_getall($tablename, $condition, array(), '', 'sort DESC,createtime DESC', array($pageindex, $pagesize)); goto JTHLF; REGRQ: eKDSf: goto ymA4t; KzjWS: $version_id = $_GPC['version_id']; goto muDr0; voO8w: R2Bfq: goto ELjov; ELjov: $pageindex = 1; goto a2kco; hM369: goto cNSum; goto voO8w; V8p1m: if (!isset($_GPC['page'])) { goto R2Bfq; } goto B7qW2; a2kco: cNSum: goto TnLCl; muDr0: $condition = array(); goto scimM; scimM: $condition['uniacid'] = $uniacid; goto iYJN9; aCJJr: goto RpTln; goto pVZyL; ymA4t: $request = pdo_getall($tablename, $condition); goto Xwseh; iYJN9: if (empty($_GPC['xname'])) { goto eKDSf; } goto l7uHB; JTHLF: include $this->template('Store_service/list'); goto aCJJr; l7uHB: $xname = $_GPC['xname']; goto xILl4; pVZyL: case 'edit': goto Udk4k; Udk4k: if (!empty($_GPC['id'])) { goto gmPNX; } goto nq5Pz; NCcih: gmPNX: goto g9iNx; nq5Pz: $list['status'] = 1; goto tk39O; fZyim: goto RpTln; goto cMNrP; uwEsB: DzYj2: goto EK8G6; g9iNx: $list = pdo_get($tablename, array("id" => $_GPC['id'])); goto uwEsB; tk39O: goto DzYj2; goto NCcih; EK8G6: include $this->template('Store_service/edit'); goto fZyim; cMNrP: case 'savemodel': goto U7ka4; S_yPt: $condition['name'] = $_GPC['name']; goto Vzb4s; Bkygk: if (!empty($_GPC['home'])) { goto XqOMA; } goto z9yAB; O2ibh: goto azlav; goto VQAbW; qUB5d: FG1jE: goto hlbc8; U7ka4: $condition = array(); goto I7K8G; E4Wtw: iWkB6: goto EYlwP; Wkaf3: if (!empty($_GPC['sale_status'])) { goto ukE9g; } goto xTuWi; karj2: goto RxCMC; goto qUB5d; RnKk0: qlMaW: goto YwHM7; xTuWi: $condition['sale_status'] = -1; goto GIHPm; dNY8H: $request = pdo_update($tablename, $condition, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto q18bg; U2033: $condition['sort'] = 0; goto E4Wtw; tonXu: p1Bnk: goto TGVmm; UhiuU: if (!empty($request)) { goto FG1jE; } goto NM0yD; YwHM7: if (empty($_GPC['sort'])) { goto W9ydl; } goto ki2u5; VQAbW: vzJQV: goto VjVJD; EYlwP: if (empty($_GPC['id'])) { goto amQFX; } goto dNY8H; z9yAB: $condition['home'] = -1; goto osyZH; GIHPm: goto kxWnQ; goto YAclZ; IaS1b: XqOMA: goto vwkwy; I7K8G: $condition['uniacid'] = $uniacid; goto S_yPt; UOEBM: $condition['sale_status'] = $_GPC['sale_status']; goto ao0v7; LHILb: MEaFf: goto Begrr; u1rhg: goto iWkB6; goto FDLqc; q18bg: goto TpaA_; goto dNW70; ao0v7: kxWnQ: goto oTxuQ; Begrr: $condition['status'] = -1; goto RnKk0; VjVJD: $condition['shop'] = $_GPC['shop']; goto zcVGg; wZoKF: $condition['shop'] = -1; goto O2ibh; Uo7OE: $condition['member'] = $_GPC['member']; goto Bkygk; ki2u5: $condition['sort'] = $_GPC['sort']; goto u1rhg; vwkwy: $condition['home'] = $_GPC['home']; goto tonXu; zcVGg: azlav: goto Wkaf3; fPwG4: RxCMC: goto xZxr2; Vzb4s: $condition['price'] = $_GPC['price']; goto Uo7OE; IdzMG: $condition['status'] = $_GPC['status']; goto FOTmV; hlbc8: $json = array("status" => 1, "msg" => "操作成功"); goto S64_k; TGVmm: if (!empty($_GPC['shop'])) { goto vzJQV; } goto wZoKF; osyZH: goto p1Bnk; goto IaS1b; oTxuQ: if (empty($_GPC['status'])) { goto MEaFf; } goto IdzMG; dF2WZ: echo json_encode($json); goto karj2; dNW70: amQFX: goto aaxDn; NM0yD: $json = array("status" => 0, "msg" => "操作失败"); goto dF2WZ; FDLqc: W9ydl: goto U2033; FOTmV: goto qlMaW; goto LHILb; Bnmjx: TpaA_: goto UhiuU; S64_k: echo json_encode($json); goto fPwG4; aaxDn: $request = pdo_insert($tablename, $condition); goto Bnmjx; xZxr2: goto RpTln; goto MlL5D; YAclZ: ukE9g: goto UOEBM; MlL5D: case 'statuschange': goto g9w2t; tjokc: $json = array("status" => 0, "msg" => "操作失败"); goto R01Zv; tG2Yf: nnMcp: goto qA3Rl; SAhLd: goto nnMcp; goto hB20r; g9w2t: $request = pdo_update($tablename, array($_GPC['name'] => $_GPC['status']), array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto l1FlB; XKFH2: echo json_encode($json); goto tG2Yf; qA3Rl: goto RpTln; goto LiOp9; hB20r: GJiBV: goto YywNJ; l1FlB: if ($request) { goto GJiBV; } goto tjokc; R01Zv: echo json_encode($json); goto SAhLd; YywNJ: $json = array("status" => 1, "msg" => "操作成功"); goto XKFH2; LiOp9: case 'delete': goto myiPL; GjP86: echo json_encode($json); goto nNp7w; fvdfP: echo json_encode($json); goto KmQxC; ASIna: $json = array("status" => 1, "msg" => "操作成功"); goto fvdfP; nsIsb: if ($request) { goto Kq2ka; } goto bnWVu; bnWVu: $json = array("status" => 0, "msg" => "操作失败"); goto GjP86; uaqyn: Kq2ka: goto ASIna; nNp7w: goto eNwLb; goto uaqyn; iR71f: goto RpTln; goto hLu8B; KmQxC: eNwLb: goto iR71f; myiPL: $request = pdo_delete($tablename, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto nsIsb; hLu8B: } goto mPguz; mPguz: QbqAZ: goto XjoPA; Eq7wj: $ops = array("list", "edit", "savemodel", "delete", "statuschange"); goto bagJS; bagJS: global $_GPC, $_W; goto fezfq; qTLkX: } public function doWebStore_member() { goto qVgO7; gu_II: $tablename = 'xc_beauty_store_member'; goto TKgZs; ndrTs: $op = in_array($_GPC['op'], $ops) ? $_GPC['op'] : 'list'; goto gu_II; KBcUI: global $_GPC, $_W; goto ECY73; KOlg3: uzKQw: goto T3b1N; qVgO7: $ops = array("list", "edit", "savemodel", "delete", "statuschange", "service"); goto KBcUI; T3b1N: gIsdk: goto uoYi0; TKgZs: switch ($op) { case 'list': goto QGkU0; P_e1U: if (!isset($_GPC['page'])) { goto qSpS7; } goto gGYIP; P7CV9: QndLF: goto HlO0y; Ojv9J: include $this->template('Store_member/list'); goto Yp6Zz; rIzwq: if (!$class) { goto bKzTF; } goto VpoTS; YbylW: $pager = pagination($total, $pageindex, $pagesize); goto w1chW; Yp6Zz: goto gIsdk; goto hQEZv; w1chW: $list = pdo_getall($tablename, $condition, array(), '', 'sort DESC,createtime DESC', array($pageindex, $pagesize)); goto wJbV2; X8M9K: goto mKcJ5; goto Mw3n7; F8JxG: if (!$list) { goto QHbnt; } goto XwCBh; XwCBh: $datalist = array(); goto rIzwq; Mw3n7: qSpS7: goto ZCo1A; ZCo1A: $pageindex = 1; goto z06eQ; IvWDv: JWv_0: goto ouGn4; AWX7E: $pagesize = 15; goto YbylW; gZDLa: $total = count($request); goto P_e1U; XyHRY: $condition['uniacid'] = $uniacid; goto ApKHm; t_CHF: foreach ($list as &$x) { $x['cidname'] = $datalist[$x['cid']]['name']; UtHBX: } goto bD8u0; wJbV2: $class = pdo_getall('xc_beauty_store', array("status" => 1, "uniacid" => $uniacid), array(), '', 'sort DESC,createtime'); goto F8JxG; bE0fc: $condition = array(); goto XyHRY; F0EvD: $condition['name LIKE'] = '%' . $_GPC['xname'] . '%'; goto yvWSu; gGYIP: $pageindex = intval($_GPC['page']); goto X8M9K; CkhaB: if (empty($_GPC['cid'])) { goto JWv_0; } goto cnJUH; bD8u0: vF_Tj: goto e3DYa; QGkU0: $version_id = $_GPC['version_id']; goto bE0fc; HlO0y: bKzTF: goto t_CHF; cnJUH: $cid = $_GPC['cid']; goto uuGnb; ApKHm: if (empty($_GPC['xname'])) { goto yDcf2; } goto s3sJw; uuGnb: $condition['cid'] = $_GPC['cid']; goto IvWDv; ouGn4: $request = pdo_getall($tablename, $condition); goto gZDLa; VpoTS: foreach ($class as $c) { $datalist[$c['id']] = $c; Db3TO: } goto P7CV9; z06eQ: mKcJ5: goto AWX7E; yvWSu: yDcf2: goto CkhaB; s3sJw: $xname = $_GPC['xname']; goto F0EvD; e3DYa: QHbnt: goto Ojv9J; hQEZv: case 'edit': goto bm60P; BAItv: $list = pdo_get($tablename, array("id" => $_GPC['id'])); goto Vilba; ctEp0: $list['status'] = 1; goto K1QC0; KU6Qb: J9j29: goto BAItv; cSAMS: lBfdZ: goto r4z0l; tsnIf: goto gIsdk; goto Ptb9n; Dh10L: if (!empty($_GPC['id'])) { goto J9j29; } goto ctEp0; K1QC0: goto Nfeb2; goto KU6Qb; GAb3u: $pai_list = pdo_getall('xc_beauty_pai', array("status" => 1, "uniacid" => $uniacid)); goto Dh10L; r4z0l: Nfeb2: goto pvIRG; Vilba: if (!$list) { goto lBfdZ; } goto pavnF; pvIRG: include $this->template('Store_member/edit'); goto tsnIf; bm60P: $class = pdo_getall('xc_beauty_store', array("status" => 1, "uniacid" => $uniacid), array(), '', 'sort DESC,createtime'); goto GAb3u; pavnF: $list['service'] = json_decode($list['service'], true); goto cSAMS; Ptb9n: case 'savemodel': goto wk84l; M0_CI: $condition['cid'] = $_GPC['cid']; goto X8cKv; Q2Wzy: $json = array("status" => 1, "msg" => "操作成功"); goto xDlVA; JofvF: $condition['pai2'] = $_GPC['pai2']; goto mIka4; SFT0W: if (!empty($request)) { goto Owza2; } goto g3lUu; CLX0k: $condition['pai_status'] = $_GPC['pai_status']; goto p6WTc; KxGN3: goto rLvWJ; goto bKEf8; p6WTc: goto YMZpd; goto WR4QB; FBnfV: $condition['pai_status'] = -1; goto zvGQZ; x7Dbp: $condition['simg'] = $_GPC['simg']; goto M0_CI; ZgfNK: I6ZYs: goto n8Xdi; t_7Yk: $condition['name'] = $_GPC['name']; goto x7Dbp; YXu4Z: $condition['service'] = htmlspecialchars_decode($_GPC['service']); goto iUeYb; zvGQZ: YMZpd: goto Z1SRI; bHf4R: TvYeK: goto SFT0W; PYLN2: goto Qu7oQ; goto SonOe; X3xev: $condition['status'] = -1; goto MuSKW; xBy5y: $condition['status'] = $_GPC['status']; goto KxGN3; Hwi7A: $condition['content'] = $_GPC['content']; goto K2V3k; HcWhl: $condition['sort'] = $_GPC['sort']; goto EFQuZ; X8cKv: $condition['task'] = $_GPC['task']; goto YXu4Z; K2V3k: $condition['pai1'] = $_GPC['pai1']; goto JofvF; g3lUu: $json = array("status" => 0, "msg" => "操作失败"); goto cxpLI; cxpLI: echo json_encode($json); goto PYLN2; M4TEA: $condition['uniacid'] = $uniacid; goto t_7Yk; Z1SRI: if (empty($_GPC['sort'])) { goto I6ZYs; } goto HcWhl; SonOe: Owza2: goto Q2Wzy; wk84l: $condition = array(); goto M4TEA; WR4QB: GDYWz: goto FBnfV; S3wl0: $request = pdo_update($tablename, $condition, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto YxZ3s; xDlVA: echo json_encode($json); goto jEh4Q; psQwe: if (empty($_GPC['id'])) { goto vVPmf; } goto S3wl0; mIka4: if (empty($_GPC['status'])) { goto M2UA2; } goto xBy5y; EFQuZ: goto BnpV3; goto ZgfNK; ppB7x: $request = pdo_insert($tablename, $condition); goto bHf4R; YxZ3s: goto TvYeK; goto eOh9E; n8Xdi: $condition['sort'] = 0; goto v9aER; v9aER: BnpV3: goto psQwe; HhiUZ: goto gIsdk; goto pp7Bo; bKEf8: M2UA2: goto X3xev; jEh4Q: Qu7oQ: goto HhiUZ; MuSKW: rLvWJ: goto xrb39; xrb39: if (empty($_GPC['pai_status'])) { goto GDYWz; } goto CLX0k; iUeYb: $condition['tag'] = $_GPC['tag']; goto Hwi7A; eOh9E: vVPmf: goto ppB7x; pp7Bo: case 'statuschange': goto UjQ1g; HaDfJ: echo json_encode($json); goto dK5vs; M4yuC: if ($request) { goto xDjFn; } goto njXrn; bbgce: xDjFn: goto Jvpkd; Jvpkd: $json = array("status" => 1, "msg" => "操作成功"); goto pbK1b; e7d_t: O8cTf: goto ukMCK; njXrn: $json = array("status" => 0, "msg" => "操作失败"); goto HaDfJ; dK5vs: goto O8cTf; goto bbgce; pbK1b: echo json_encode($json); goto e7d_t; ukMCK: goto gIsdk; goto s2Y9V; UjQ1g: $request = pdo_update($tablename, array($_GPC['name'] => $_GPC['status']), array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto M4yuC; s2Y9V: case 'delete': goto q31xR; lwE_t: echo json_encode($json); goto d2z83; spbZJ: hl0JX: goto U4OIZ; niS69: goto apmwz; goto spbZJ; q31xR: $request = pdo_delete($tablename, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto sB7C3; a_71b: echo json_encode($json); goto niS69; XHplg: $json = array("status" => 0, "msg" => "操作失败"); goto a_71b; sB7C3: if ($request) { goto hl0JX; } goto XHplg; d2z83: apmwz: goto cyCE4; U4OIZ: $json = array("status" => 1, "msg" => "操作成功"); goto lwE_t; cyCE4: goto gIsdk; goto y_8Mv; y_8Mv: case 'service': goto iSOpn; DM6QG: $pageindex = intval($_GPC['page']); goto kyFX9; Hkcwk: $condition['uniacid'] = $uniacid; goto RhgNb; w_SXz: goto gIsdk; goto lusJq; s65V0: include $this->template('Store_member/service'); goto w_SXz; RhgNb: if (empty($_GPC['xname'])) { goto rk5GO; } goto V9suv; pHudA: if (!isset($_GPC['page'])) { goto EW5JU; } goto DM6QG; G5VFc: $total = count($request); goto pHudA; kyFX9: goto XZ07s; goto wBecy; wBecy: EW5JU: goto KjdMG; o_P1A: $request = pdo_getall($tablename, $condition); goto G5VFc; ISd2R: $pagesize = 6; goto bYcQH; ZNf_k: rk5GO: goto o_P1A; bYcQH: $pager = pagination($total, $pageindex, $pagesize); goto LiOkr; KjdMG: $pageindex = 1; goto RR4Vs; Twbvz: $condition['name LIKE'] = '%' . $_GPC['xname'] . '%'; goto ZNf_k; RR4Vs: XZ07s: goto ISd2R; KZEBQ: $condition = array(); goto Hkcwk; V9suv: $xname = $_GPC['xname']; goto Twbvz; dgX65: $version_id = $_GPC['version_id']; goto KZEBQ; iSOpn: $tablename = 'xc_beauty_store_service'; goto dgX65; LiOkr: $list = pdo_getall($tablename, $condition, array(), '', 'sort DESC,createtime DESC', array($pageindex, $pagesize)); goto s65V0; lusJq: } goto KOlg3; ECY73: $uniacid = $_W['uniacid']; goto ndrTs; uoYi0: } public function doWebStore_pai() { goto HCm1D; deFJV: $tablename = 'xc_beauty_pai'; goto bK3XH; hskTR: $op = in_array($_GPC['op'], $ops) ? $_GPC['op'] : 'list'; goto deFJV; MTtEb: hIqWR: goto CcMvz; K17JJ: global $_GPC, $_W; goto Sae3N; bK3XH: switch ($op) { case 'list': goto JbQBM; ic4BO: $condition['name LIKE'] = '%' . $_GPC['xname'] . '%'; goto XLCAH; Xm65q: $pager = pagination($total, $pageindex, $pagesize); goto RvQr3; QSUtw: ZPyZN: goto QxVET; qSFfR: $pagesize = 15; goto Xm65q; kKXyh: include $this->template('Store_pai/list'); goto JFvQf; HiC_b: if (!isset($_GPC['page'])) { goto ZPyZN; } goto OmhGN; JFvQf: goto hIqWR; goto IyBAA; OmhGN: $pageindex = intval($_GPC['page']); goto FiI2P; FiI2P: goto rbUsp; goto QSUtw; Ti97R: $total = count($request); goto HiC_b; lTcmg: $condition = array(); goto TtHiR; TtHiR: $condition['uniacid'] = $uniacid; goto ZKIWL; ZKIWL: if (empty($_GPC['xname'])) { goto aebGA; } goto Ji1XE; QxVET: $pageindex = 1; goto ce4iY; Ji1XE: $xname = $_GPC['xname']; goto ic4BO; XLCAH: aebGA: goto KRQ16; JbQBM: $version_id = $_GPC['version_id']; goto lTcmg; ce4iY: rbUsp: goto qSFfR; KRQ16: $request = pdo_getall($tablename, $condition); goto Ti97R; RvQr3: $list = pdo_getall($tablename, $condition, array(), '', 'id DESC', array($pageindex, $pagesize)); goto kKXyh; IyBAA: case 'edit': goto pnZ9V; mXE5f: E4yEd: goto RqL_m; K_IeB: f0GV8: goto jSxur; QLGpy: WuLX1: goto VMW_5; VMW_5: $list = pdo_get($tablename, array("id" => $_GPC['id'])); goto JZ0Nl; X2D0L: $content = array(); goto saoQd; s1zjK: if (!$detail) { goto sQwu8; } goto X2D0L; wTwY4: include $this->template('Store_pai/edit'); goto AovAv; dauBY: $list['status'] = 1; goto YrfXY; cEu2g: $detail = pdo_getall('xc_beauty_pai_detail', array("pid" => $_GPC['id'], "uniacid" => $uniacid)); goto s1zjK; YrfXY: goto JVsSt; goto QLGpy; jSxur: JVsSt: goto wTwY4; pnZ9V: if (!empty($_GPC['id'])) { goto WuLX1; } goto dauBY; JZ0Nl: if (!$list) { goto f0GV8; } goto cEu2g; re2Yw: sQwu8: goto K_IeB; saoQd: foreach ($detail as &$x) { $content[$x['weeknum']] = $x; e2sdB: } goto mXE5f; RqL_m: $list['content'] = $content; goto re2Yw; AovAv: goto hIqWR; goto nr9FK; nr9FK: case 'savemodel': goto lVy9E; ozdEP: foreach ($content as $cc) { pdo_insert('xc_beauty_pai_detail', array("uniacid" => $uniacid, "pid" => $id, "weeknum" => $cc['weeknum'], "time1start" => $cc['time1start'], "time1end" => $cc['time1end'], "time2start" => $cc['time2start'], "time2end" => $cc['time2end'], "time3start" => $cc['time3start'], "time3end" => $cc['time3end'], "time4start" => $cc['time4start'], "time4end" => $cc['time4end'], "status" => $cc['status'])); UYw5j: } goto CH3k8; YKvcz: $condition['midflytime'] = date('Y-m-d H:i:s'); goto lPRzH; Pp3ix: z1OR9: goto SASMi; CH3k8: oKGTc: goto CBwPW; Nta2O: k1ORb: goto kdKHX; t3fyF: $condition['status'] = -1; goto B5SxQ; HAzDR: if (!empty($request)) { goto k1ORb; } goto iVzKi; gMibU: $content = json_decode(htmlspecialchars_decode($_GPC['content']), true); goto ozdEP; SASMi: goto hIqWR; goto TqE03; UPZB3: goto p2smG; goto NFhUX; HMwRO: if (empty($_GPC['status'])) { goto pqcUz; } goto uof9y; B5SxQ: XIBTv: goto YKvcz; oqQv2: echo json_encode($json); goto Pp3ix; CBwPW: PNzYg: goto Rx5pS; qhA8f: foreach ($content as $cc) { pdo_update('xc_beauty_pai_detail', array("time1start" => $cc['time1start'], "time1end" => $cc['time1end'], "time2start" => $cc['time2start'], "time2end" => $cc['time2end'], "time3start" => $cc['time3start'], "time3end" => $cc['time3end'], "time4start" => $cc['time4start'], "time4end" => $cc['time4end'], "status" => $cc['status']), array("uniacid" => $uniacid, "pid" => $_GPC['id'], "weeknum" => $cc['weeknum'])); OQ9kC: } goto dfuGq; Rx5pS: p2smG: goto HAzDR; mHVVr: goto XIBTv; goto fhvbs; J2cpN: $content = json_decode(htmlspecialchars_decode($_GPC['content']), true); goto qhA8f; kdKHX: $json = array("status" => 1, "msg" => "操作成功"); goto oqQv2; lDz0l: $id = pdo_insertid(); goto gMibU; lVy9E: $condition = array(); goto xun4y; uof9y: $condition['status'] = $_GPC['status']; goto mHVVr; xun4y: $condition['uniacid'] = $uniacid; goto NVnew; dfuGq: uMTvo: goto N6elE; to2qQ: if (!$request) { goto lXwbq; } goto J2cpN; NFhUX: Za3FU: goto IeMWK; lPRzH: if (empty($_GPC['id'])) { goto Za3FU; } goto sorEp; sorEp: $request = pdo_update($tablename, $condition, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto to2qQ; iVzKi: $json = array("status" => 0, "msg" => "操作失败"); goto gQJbQ; NVnew: $condition['name'] = $_GPC['name']; goto HMwRO; N6elE: lXwbq: goto UPZB3; Ob28n: if (empty($request)) { goto PNzYg; } goto lDz0l; IeMWK: $request = pdo_insert($tablename, $condition); goto Ob28n; waZ_E: goto z1OR9; goto Nta2O; fhvbs: pqcUz: goto t3fyF; gQJbQ: echo json_encode($json); goto waZ_E; TqE03: case 'statuschange': goto WsMDl; zQ2N9: echo json_encode($json); goto IgYJX; WsMDl: $request = pdo_update($tablename, array($_GPC['name'] => $_GPC['status']), array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto BvzdH; paidO: $json = array("status" => 1, "msg" => "操作成功"); goto iAqJp; Heb2X: ZRBVe: goto paidO; iAqJp: echo json_encode($json); goto hWixW; hWixW: n6XxN: goto uEX4f; BvzdH: if ($request) { goto ZRBVe; } goto aGMgI; uEX4f: goto hIqWR; goto A3ZP3; IgYJX: goto n6XxN; goto Heb2X; aGMgI: $json = array("status" => 0, "msg" => "操作失败"); goto zQ2N9; A3ZP3: case 'delete': goto OPsTg; ncOz7: $json = array("status" => 0, "msg" => "操作失败"); goto nVlyL; h1qAe: if ($request) { goto Rh_Kl; } goto ncOz7; tidwB: goto hIqWR; goto LlJLO; JXqHr: imAld: goto tidwB; ehIC3: pdo_delete('xc_beauty_pai_detail', array("uniacid" => $uniacid, "pid" => $_GPC['id'])); goto BHHh0; OPsTg: $request = pdo_delete($tablename, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto h1qAe; BHHh0: $json = array("status" => 1, "msg" => "操作成功"); goto vmWeE; BSmb3: Rh_Kl: goto ehIC3; nVlyL: echo json_encode($json); goto WVmP5; vmWeE: echo json_encode($json); goto JXqHr; WVmP5: goto imAld; goto BSmb3; LlJLO: } goto RH0lT; HCm1D: $ops = array("list", "edit", "savemodel", "delete", "statuschange"); goto K17JJ; Sae3N: $uniacid = $_W['uniacid']; goto hskTR; RH0lT: a5M1Q: goto MTtEb; CcMvz: } public function doWebStore_order() { goto Ghw59; AAOIV: $op = in_array($_GPC['op'], $ops) ? $_GPC['op'] : 'list'; goto OjkGF; LARu8: PW2Ln: goto XT8zE; JNdRl: $uniacid = $_W['uniacid']; goto AAOIV; Ghw59: $ops = array("list", "statuschange", "add_orders", "timeschange", "yan"); goto EoL3E; SRGEs: switch ($op) { case 'list': goto os_rg; ih6E0: VQ2Dg: goto xU5Ug; N5jA2: $datalist = array(); goto Ovdc5; mcrJE: $condition['uniacid'] = $uniacid; goto Xb4KR; A2CEW: $member_list = array(); goto RMARd; Y7Jy2: $times = $_GPC['times']; goto eMh96; I2Ecp: mDhB7: goto yIkSq; jVTec: $pay_type = $_GPC['pay_type']; goto a8aWY; Ovdc5: if (!$service) { goto v0b4Q; } goto jr6XH; p9xNb: $condition['out_trade_no LIKE'] = '%' . $_GPC['out_trade_no'] . '%'; goto f9TkW; E4TiP: f5UEL: goto wmI87; eMh96: $condition['createtime >='] = $_GPC['times']['start']; goto Gfgyk; UpM7V: $condition['use'] = $_GPC['use']; goto JHium; Z1_2j: $store_list = array(); goto FbF97; xU5Ug: if (empty($_GPC['use'])) { goto wOjHc; } goto KkXV2; iHwhi: dm2fw: goto KZY1T; FbF97: if (!$store) { goto dm2fw; } goto Tt_Ee; LuHh4: tn61d: goto z2k7t; Kb3DH: uwv37: goto iHwhi; yIkSq: if (empty($_GPC['pay_type'])) { goto s1tAG; } goto jVTec; VlvqZ: goto LLOea; goto vBPS_; JHium: wOjHc: goto y0HGO; R9sGU: foreach ($member as $m) { $member_list[$m['id']] = $m; MJLVR: } goto Wxeba; L4TIF: $pagesize = 15; goto I6UN3; Xb4KR: if (empty($_GPC['out_trade_no'])) { goto l6bu0; } goto aOd6z; W74gn: goto PW2Ln; goto BvxFj; a8aWY: $condition['pay_type'] = $_GPC['pay_type']; goto g_1N2; v6qPN: $condition['order_type'] = 4; goto mcrJE; jqlge: $request = pdo_getall($tablename, $condition); goto Cu1Me; os_rg: $condition = array(); goto IZF4s; J1N5D: LLOea: goto L4TIF; n0DGB: $condition['userinfo LIKE'] = '%' . $_GPC['content'] . '%'; goto I2Ecp; wmI87: foreach ($list as &$x) { goto XsBiI; FsXNC: $x['service'] = $datalist[$x['pid']]['name']; goto vyHRi; xcDOB: $x['he_log'] = json_decode($x['he_log'], true); goto MW3iD; D0vKu: $x['pay_name'] = '微信支付'; goto es3T5; vgN6I: goto sqeWe; goto jT4oC; QMgKE: Z2QCf: goto D0vKu; hy21l: $x['store_name'] = $store_list[$x['store']]['name']; goto vgN6I; jT4oC: LpniS: goto Wh48G; KE2gS: $x['pay_name'] = '余额支付'; goto moa2Z; Ub23N: if (!($x['pay_type'] == 2)) { goto FvBgK; } goto KE2gS; es3T5: Kyw3q: goto FsXNC; Wh48G: $x['store_name'] = $title; goto p2DlV; UKOd8: goto Kyw3q; goto QMgKE; V2q3a: if ($x['pay_type'] == 1) { goto Z2QCf; } goto Ub23N; vyHRi: if ($x['store'] == -1) { goto LpniS; } goto hy21l; XsBiI: $x['userinfo'] = json_decode($x['userinfo'], true); goto V2q3a; moa2Z: FvBgK: goto UKOd8; yz7GY: $x['member_name'] = $member_list[$x['member']]['name']; goto xcDOB; MW3iD: tH6Dd: goto broxS; p2DlV: sqeWe: goto yz7GY; broxS: } goto gNAET; WXv4a: $condition['store'] = $_GPC['store_id']; goto LuHh4; xOQh1: $list = pdo_getall($tablename, $condition, array(), '', 'createtime DESC', array($pageindex, $pagesize)); goto Mw3GW; DOkv_: $member = pdo_getall('xc_beauty_store_member', array("uniacid" => $uniacid)); goto A2CEW; aOd6z: $out_trade_no = $_GPC['out_trade_no']; goto p9xNb; Gdepq: $pageindex = 1; goto J1N5D; jr6XH: foreach ($service as $x2) { $datalist[$x2['id']] = $x2; y8kU8: } goto g_4Ko; e2np1: $service = pdo_getall('xc_beauty_store_service', array("uniacid" => $uniacid)); goto N5jA2; y4a_x: if (!$config) { goto f5UEL; } goto WX4JW; gNAET: t1rXC: goto DxGNn; Cu1Me: $total = count($request); goto WT779; usu5K: include $this->template('Store_order/list'); goto W74gn; tmfui: $condition['openid LIKE'] = '%' . $_GPC['openid'] . '%'; goto ih6E0; A9bLZ: SS7Wx: goto jqlge; g_4Ko: IgjEM: goto GaOwp; GaOwp: v0b4Q: goto DOkv_; IZF4s: $condition['status IN'] = array(-1, 1); goto v6qPN; RMARd: if (!$member) { goto Mq8FC; } goto R9sGU; kN46J: $title = ''; goto y4a_x; DxGNn: t3QBL: goto usu5K; isGIi: Mq8FC: goto zhhjr; yDLeg: $content = $_GPC['content']; goto n0DGB; y0HGO: if (empty($_GPC['content'])) { goto mDhB7; } goto yDLeg; PJz43: if (empty($_GPC['store_id'])) { goto tn61d; } goto JrtXX; YnTIW: if (empty($_GPC['openid'])) { goto VQ2Dg; } goto bkIw5; Hz3Kp: $title = $config['content']['title']; goto E4TiP; I6UN3: $pager = pagination($total, $pageindex, $pagesize); goto xOQh1; WT779: if (!isset($_GPC['page'])) { goto ZV_BR; } goto VdS24; Tt_Ee: foreach ($store as $s) { $store_list[$s['id']] = $s; s6xZD: } goto Kb3DH; Wxeba: cR4kV: goto isGIi; Mw3GW: $store = pdo_getall('xc_beauty_store', array("uniacid" => $uniacid), array(), '', 'sort DESC,createtime DESC'); goto Z1_2j; f9TkW: l6bu0: goto YnTIW; KZY1T: if (!$list) { goto t3QBL; } goto e2np1; JrtXX: $store_id = $_GPC['store_id']; goto WXv4a; vBPS_: ZV_BR: goto Gdepq; g_1N2: s1tAG: goto PJz43; z2k7t: if (empty($_GPC['times'])) { goto SS7Wx; } goto Y7Jy2; WX4JW: $config['content'] = json_decode($config['content'], true); goto Hz3Kp; VdS24: $pageindex = intval($_GPC['page']); goto VlvqZ; zhhjr: $config = pdo_get('xc_beauty_config', array("xkey" => "web", "uniacid" => $uniacid)); goto kN46J; KkXV2: $use = $_GPC['use']; goto UpM7V; bkIw5: $openid = $_GPC['openid']; goto tmfui; Gfgyk: $condition['createtime <='] = $_GPC['times']['end']; goto A9bLZ; BvxFj: case 'statuschange': goto Ofyvy; PV4xE: if (!empty($order['he_log'])) { goto mk0Sv; } goto NNnIF; AltQg: $order['he_log'] = array(); goto c73tw; TEqOf: $request = pdo_update($tablename, $condition, array("status" => 1, "uniacid" => $uniacid, "id" => $_GPC['id'])); goto eW9GM; WSRq6: goto a_0r2; goto ri6ur; P5ajH: if (!(intval($condition['is_use']) == intval($order['can_use']))) { goto ta3Eq; } goto jLS3f; Sr0EU: pvHpI: goto zX9x3; VwyPg: if (!$share) { goto W2CeD; } goto Fy5GZ; YSgQK: goto x3el8; goto uohal; oSCoz: echo json_encode($json); goto YSgQK; ri6ur: mk0Sv: goto nIAHV; c73tw: pXswL: goto e75qp; e75qp: $order['he_log'][] = array("name" => "后台", "time" => date('Y-m-d H:i:s')); goto NnpdV; TvPbO: $order['he_log'][] = array("name" => "后台", "time" => date('Y-m-d H:i:s')); goto IM6uG; iY5Xr: ta3Eq: goto PV4xE; XVF8Z: $condition['is_use'] = intval($order['is_use']) + 1; goto P5ajH; QLh_U: $json = array("status" => 0, "msg" => "操作失败"); goto oSCoz; uohal: oWEuu: goto gtfHY; EIZI8: $share = pdo_getall('xc_beauty_share', array("status" => -1, "uniacid" => $uniacid, "out_trade_no" => $order['out_trade_no'])); goto VwyPg; eW9GM: if ($request) { goto oWEuu; } goto QLh_U; YPzGS: mdCes: goto xZGqQ; asrZU: if (is_array($order['he_log'])) { goto pXswL; } goto AltQg; rl3KN: a_0r2: goto TEqOf; gtfHY: if (empty($condition['use'])) { goto mdCes; } goto EIZI8; ywK92: goto PW2Ln; goto zXIrP; IM6uG: $condition['he_log'] = json_encode($order['he_log']); goto WSRq6; NNnIF: $order['he_log'] = array(); goto TvPbO; gBRAX: echo json_encode($json); goto O8a3t; NnpdV: $condition['he_log'] = json_encode($order['he_log']); goto rl3KN; O8a3t: x3el8: goto ywK92; xZGqQ: $json = array("status" => 1, "msg" => "操作成功"); goto gBRAX; Fy5GZ: foreach ($share as $x) { goto lqD6w; YYy95: pdo_update('xc_beauty_userinfo', array("share_amount" => $share_amount, "share_o_amount" => $share_o_amount), array("status" => 1, "uniacid" => $uniacid, "openid" => $x['openid'])); goto Ev9lJ; ymP9h: if (!$userinfo) { goto LPBW2; } goto KWTlB; Ev9lJ: LPBW2: goto KNyU0; KWTlB: $share_amount = round(floatval($userinfo['share_amount']) + floatval($x['amount']), 2); goto ymO3r; n_PCm: gVSxc: goto OiAK7; lqD6w: $userinfo = pdo_get('xc_beauty_userinfo', array("status" => 1, "uniacid" => $uniacid, "openid" => $x['openid'])); goto ymP9h; ymO3r: $share_o_amount = round(floatval($userinfo['share_o_amount']) + floatval($x['amount']), 2); goto YYy95; KNyU0: pdo_update('xc_beauty_share', array("status" => 1), array("uniacid" => $uniacid, "id" => $x['id'])); goto n_PCm; OiAK7: } goto Sr0EU; Ofyvy: $order = pdo_get($tablename, array("status" => 1, "uniacid" => $uniacid, "id" => $_GPC['id'])); goto XVF8Z; nIAHV: $order['he_log'] = json_decode($order['he_log'], true); goto asrZU; jLS3f: $condition['use'] = 1; goto iY5Xr; zX9x3: W2CeD: goto YPzGS; zXIrP: case 'delete': goto YSd0R; lfZao: rTMeJ: goto zfT3E; iKEBG: $json = array("status" => 0, "msg" => "操作失败"); goto JFWIU; y7WD4: goto rTMeJ; goto VuLBM; P3sNJ: $json = array("status" => 1, "msg" => "操作成功"); goto sjKul; YSd0R: $request = pdo_delete($tablename, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto Y0SHc; VuLBM: nEN3r: goto P3sNJ; JFWIU: echo json_encode($json); goto y7WD4; sjKul: echo json_encode($json); goto lfZao; Y0SHc: if ($request) { goto nEN3r; } goto iKEBG; zfT3E: goto PW2Ln; goto MAqYV; MAqYV: case 'timeschange': goto RtW0T; oNZQd: LN8zX: goto Qo1XV; Sc3IT: $json = array("status" => 1, "msg" => "操作成功"); goto M0ncQ; Qo1XV: goto PW2Ln; goto iEmc5; zO7x7: echo json_encode($json); goto rQUBA; M0ncQ: echo json_encode($json); goto oNZQd; ZETVq: $json = array("status" => 0, "msg" => "操作失败"); goto zO7x7; X3eHo: if ($request) { goto ax8DW; } goto ZETVq; Jix61: ax8DW: goto Sc3IT; rQUBA: goto LN8zX; goto Jix61; RtW0T: $request = pdo_update($tablename, array("is_use" => $_GPC['time'], "use" => -1), array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto X3eHo; iEmc5: case 'yan': goto yX1eM; zFaDL: $json = array("status" => 1, "msg" => $result['trade_state_desc']); goto N2IqO; wTdfM: echo json_encode($json); goto vZdLw; HG2GD: if ($result['trade_state'] == 'SUCCESS') { goto jRp2R; } goto o3JfG; XhiV6: uSLky: goto qJvlB; gf4sM: $string = array2url($params); goto UIKvr; gt4Mm: $json = array("status" => 1, "msg" => "未支付"); goto ICvFS; d2yz0: exit; goto kYb9N; D7HcZ: goto hbFET; goto hjJ1p; DuE3i: $result = ihttp_request('https://api.mch.weixin.qq.com/pay/orderquery', $xml, $params); goto bCG02; Bnpg_: Nouo1: goto lhRnL; haZul: $xml = array2xml($params); goto DuE3i; sZxb5: $json = array("status" => 1, "msg" => "已支付"); goto G1HFA; ojfzK: $total_fee = $result['total_fee'] / 100; goto Qcj4n; JHIdM: goto N8NfJ; goto Bnpg_; vZdLw: goto FJGDW; goto R07Vv; lhRnL: if ($pay['status'] == 1) { goto uSLky; } goto BzpmW; yX1eM: $order = pdo_get($tablename, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto eq0MT; LG4hq: goto q62vS; goto XhiV6; XI72g: Ag3yv: goto jett3; P5YXt: $json = array("status" => 1, "msg" => "金额不同"); goto wTdfM; TmNxi: ZFBDC: goto hwkWW; O3v6S: exit; goto wqCKI; hjJ1p: jRp2R: goto ojfzK; BzpmW: $setting = uni_setting_load('payment', $_W['uniacid']); goto xq4tX; NwVW0: $pay = pdo_get('core_paylog', array("uniacid" => $uniacid, "openid" => $order['openid'], "tid" => $order['out_trade_no'])); goto FbFmH; fiUgd: FJGDW: goto u4Ggm; ICvFS: echo json_encode($json); goto JHIdM; hwkWW: goto PW2Ln; goto CO3uA; Qcj4n: if (floatval($total_fee) == floatval($order['wxpay'])) { goto J88q8; } goto P5YXt; qJvlB: pdo_update($tablename, array("status" => 1), array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto sZxb5; N2IqO: echo json_encode($json); goto fiUgd; mKhEo: pdo_update($tablename, array("status" => 1), array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto zFaDL; kYb9N: Fe9gm: goto HG2GD; eaOYu: echo json_encode($json); goto O3v6S; bCG02: $result = xml2array($result['content']); goto HXO4C; z5pXT: if ($pay) { goto Nouo1; } goto gt4Mm; UIKvr: $string = $string . "&key={$setting['payment']['wechat']['signkey']}"; goto iEgxc; eq0MT: if ($order) { goto S2sZS; } goto CEBtz; p329x: exit; goto D7HcZ; o3JfG: $json = array("status" => 1, "msg" => $result['trade_state_desc']); goto YGZwU; Rdt3j: $json = array("status" => 1, "msg" => $result['return_msg']); goto eaOYu; FgsnR: N8NfJ: goto TmNxi; wzt6Q: S2sZS: goto zdX0E; zdX0E: if (!empty($order['wq_out_trade_no'])) { goto Ag3yv; } goto NwVW0; Aaehf: echo json_encode($json); goto d2yz0; jett3: $pay = pdo_get('core_paylog', array("uniacid" => $uniacid, "openid" => $order['openid'], "tid" => $order['wq_out_trade_no'])); goto SCUl0; DETkr: ksort($params); goto gf4sM; I9eWd: q62vS: goto FgsnR; SCUl0: tBVBh: goto z5pXT; G1HFA: echo json_encode($json); goto I9eWd; FbFmH: goto tBVBh; goto XI72g; g58yG: goto ZFBDC; goto wzt6Q; R07Vv: J88q8: goto mKhEo; bvHGt: load()->func('communication'); goto haZul; u4Ggm: hbFET: goto LG4hq; sxTqY: $params['out_trade_no'] = $pay['uniontid']; goto DETkr; wqCKI: DsmeM: goto FHN6h; YGZwU: echo json_encode($json); goto p329x; HXO4C: if (!is_error($result)) { goto DsmeM; } goto Rdt3j; xq4tX: $params = array("appid" => $_W['account']['key'], "mch_id" => $setting['payment']['wechat']['mchid'], "nonce_str" => random(32)); goto sxTqY; xBp0z: $json = array("status" => 1, "msg" => $result['err_code_des']); goto Aaehf; FHN6h: if (!($result['result_code'] != 'SUCCESS')) { goto Fe9gm; } goto xBp0z; iUNaT: echo json_encode($json); goto g58yG; iEgxc: $string = md5($string); goto deUwd; deUwd: $params['sign'] = strtoupper($string); goto bvHGt; CEBtz: $json = array("status" => 1, "msg" => "订单不存在"); goto iUNaT; CO3uA: } goto G1q4J; EoL3E: global $_GPC, $_W; goto JNdRl; OjkGF: $tablename = 'xc_beauty_order'; goto SRGEs; G1q4J: spIca: goto LARu8; XT8zE: } public function doWebPrize_order() { goto eN28U; BqzUY: switch ($op) { case 'list': goto EzoMm; HeX0C: $status = $_GPC['status']; goto IeOMU; xucZH: if (empty($_GPC['openid'])) { goto bQPt4; } goto Ow7q1; UennS: $list = pdo_getall($tablename, $condition, array(), '', 'createtime DESC', array($pageindex, $pagesize)); goto Sf2NA; DwLl_: if (empty($_GPC['status'])) { goto KX2qt; } goto HeX0C; KqUOP: $pager = pagination($total, $pageindex, $pagesize); goto UennS; gh0AL: xpGhC: goto KJ475; Mv5WE: $pageindex = 1; goto gh0AL; a5Wo8: if (empty($_GPC['title'])) { goto LZWzs; } goto wo92O; NT9ir: $condition['type'] = 2; goto QK7Gs; qyoSm: $total = count($request); goto UBkCs; zHS4m: bQPt4: goto a5Wo8; UBkCs: if (!isset($_GPC['page'])) { goto Lphph; } goto lzKwE; hoJAP: goto xpGhC; goto M6I_h; cFUUd: $condition['title LIKE'] = '%' . $_GPC['title'] . '%'; goto LNgef; KKLzv: KX2qt: goto j2mKm; IeOMU: $condition['status'] = $_GPC['status']; goto KKLzv; EzoMm: $condition = array(); goto NT9ir; j2mKm: $request = pdo_getall($tablename, $condition); goto qyoSm; Ow7q1: $openid = $_GPC['openid']; goto Yhc0B; KJ475: $pagesize = 15; goto KqUOP; QK7Gs: $condition['uniacid'] = $uniacid; goto xucZH; wo92O: $title = $_GPC['title']; goto cFUUd; lzKwE: $pageindex = intval($_GPC['page']); goto hoJAP; LNgef: LZWzs: goto DwLl_; Yhc0B: $condition['openid LIKE'] = '%' . $_GPC['openid'] . '%'; goto zHS4m; AaaKs: goto zG5G_; goto JUXjK; Sf2NA: include $this->template('Prize_order/list'); goto AaaKs; M6I_h: Lphph: goto Mv5WE; JUXjK: case 'statuschange': goto vnd4S; ePK6f: ahAsF: goto hpsvn; HRybM: echo json_encode($json); goto JsMdn; O2I8m: echo json_encode($json); goto njRKT; hpsvn: $json = array("status" => 1, "msg" => "操作成功"); goto HRybM; yQ2mT: $json = array("status" => 0, "msg" => "操作失败"); goto O2I8m; vnd4S: $request = pdo_update($tablename, array("status" => 1), array("uniacid" => $uniacid, "id" => $_GPC['id'])); goto ysV5W; njRKT: goto p6JfO; goto ePK6f; ysV5W: if ($request) { goto ahAsF; } goto yQ2mT; JsMdn: p6JfO: goto UhQ2I; UhQ2I: goto zG5G_; goto LtOGm; LtOGm: case 'delete': goto abG24; LRk3Y: echo json_encode($json); goto cLX_N; CIthQ: $json = array("status" => 1, "msg" => "操作成功"); goto k0ho_; Sgq1k: goto zG5G_; goto Yg3Iv; nYqEG: czYZd: goto Sgq1k; cLX_N: goto czYZd; goto pL5rd; Oyfwl: if ($request) { goto KFPOA; } goto tJgfP; abG24: $request = pdo_delete($tablename, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto Oyfwl; pL5rd: KFPOA: goto CIthQ; k0ho_: echo json_encode($json); goto nYqEG; tJgfP: $json = array("status" => 0, "msg" => "操作失败"); goto LRk3Y; Yg3Iv: } goto U6rUl; U6rUl: qprp8: goto Yhr9Q; KbQ5q: $uniacid = $_W['uniacid']; goto ejmMg; fF1sx: $tablename = 'xc_beauty_rotate_log'; goto BqzUY; eN28U: $ops = array("list", "statuschange", "add_orders"); goto oYxnQ; oYxnQ: global $_GPC, $_W; goto KbQ5q; Yhr9Q: zG5G_: goto pKoXE; ejmMg: $op = in_array($_GPC['op'], $ops) ? $_GPC['op'] : 'list'; goto fF1sx; pKoXE: } public function doWebNav() { goto x7T4I; COPGB: switch ($op) { case 'list': goto ylfF3; XN_WT: $request = pdo_getall($tablename, $condition); goto m6y9W; hFslr: include $this->template('Nav/list'); goto mb3aX; jg2Jl: $pagesize = 15; goto ayCVB; r7_Pb: $pageindex = 1; goto QACSp; rv5xe: $list = pdo_getall($tablename, $condition, array(), '', 'sort DESC,createtime DESC', array($pageindex, $pagesize)); goto hFslr; ayCVB: $pager = pagination($total, $pageindex, $pagesize); goto rv5xe; mb3aX: goto kCX9y; goto IPTkU; OeRaZ: $condition = array(); goto fLIb8; Ld4l1: $condition['name LIKE'] = '%' . $_GPC['xname'] . '%'; goto bEP5j; fLIb8: $condition['uniacid'] = $uniacid; goto MXi0x; bEP5j: OPOh1: goto XN_WT; Fp5aS: goto cKQXL; goto DIzhF; QACSp: cKQXL: goto jg2Jl; m6y9W: $total = count($request); goto HTUgK; HTUgK: if (!isset($_GPC['page'])) { goto IOEua; } goto wNe1e; ylfF3: $version_id = $_GPC['version_id']; goto OeRaZ; wNe1e: $pageindex = intval($_GPC['page']); goto Fp5aS; DIzhF: IOEua: goto r7_Pb; ZlhxV: $xname = $_GPC['xname']; goto Ld4l1; MXi0x: if (empty($_GPC['xname'])) { goto OPOh1; } goto ZlhxV; IPTkU: case 'edit': goto Wu3RY; lDQ6A: goto xHPgO; goto pwaXz; Wu3RY: if (!empty($_GPC['id'])) { goto FEE0h; } goto i_l2Y; GxgK7: $list = pdo_get($tablename, array("id" => $_GPC['id'])); goto XWc8e; pwaXz: FEE0h: goto GxgK7; unD3p: include $this->template('Nav/edit'); goto QJhLQ; i_l2Y: $list['status'] = 1; goto lDQ6A; XWc8e: xHPgO: goto unD3p; QJhLQ: goto kCX9y; goto fo2oG; fo2oG: case 'savemodel': goto jIEP6; wPJkd: $condition['link'] = $_GPC['link']; goto yCDau; L9jm4: goto Px0xC; goto n60ga; cLWal: $condition['status'] = -1; goto C2wn4; cZG04: $condition['status'] = $_GPC['status']; goto Iu1cR; l5Bo6: Px0xC: goto vaeyU; Hh8jM: echo json_encode($json); goto BRWZ3; YlWbZ: goto kCX9y; goto KvaH4; mxj93: $condition['simg'] = $_GPC['simg']; goto wPJkd; C2wn4: sq9mr: goto ZTEHL; Iu1cR: goto sq9mr; goto l3DAo; DSrZE: $condition['uniacid'] = $uniacid; goto bmM9K; PBLOO: aIn6k: goto jU17r; l3DAo: sTQrK: goto cLWal; sjKxg: $request = pdo_update($tablename, $condition, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto qdqSG; jU17r: if (!empty($request)) { goto OJBMF; } goto PGOst; I8xhu: $condition['sort'] = $_GPC['sort']; goto L9jm4; bmM9K: $condition['name'] = $_GPC['name']; goto mxj93; BRWZ3: goto t21fP; goto RTkmT; kFFuB: t21fP: goto YlWbZ; PGOst: $json = array("status" => 0, "msg" => "操作失败"); goto Hh8jM; n60ga: QQ69f: goto S5gob; S5gob: $condition['sort'] = 0; goto l5Bo6; qdqSG: goto aIn6k; goto GI1xn; z5QbH: echo json_encode($json); goto kFFuB; ZTEHL: if (empty($_GPC['sort'])) { goto QQ69f; } goto I8xhu; RTkmT: OJBMF: goto CRZ2i; gGhRw: $request = pdo_insert($tablename, $condition); goto PBLOO; jIEP6: $condition = array(); goto DSrZE; CRZ2i: $json = array("status" => 1, "msg" => "操作成功"); goto z5QbH; yCDau: if (empty($_GPC['status'])) { goto sTQrK; } goto cZG04; vaeyU: if (empty($_GPC['id'])) { goto yMvvU; } goto sjKxg; GI1xn: yMvvU: goto gGhRw; KvaH4: case 'statuschange': goto Fc7YS; VXA2R: echo json_encode($json); goto YfLG_; EVndi: echo json_encode($json); goto nCCwl; j9jfU: CICXJ: goto QLfP_; QLfP_: $json = array("status" => 1, "msg" => "操作成功"); goto VXA2R; YfLG_: TBT56: goto WAFki; nCCwl: goto TBT56; goto j9jfU; stl5P: $json = array("status" => 0, "msg" => "操作失败"); goto EVndi; Fc7YS: $request = pdo_update($tablename, array($_GPC['name'] => $_GPC['status']), array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto Quve4; WAFki: goto kCX9y; goto n2F8c; Quve4: if ($request) { goto CICXJ; } goto stl5P; n2F8c: case 'delete': goto db4wf; ZPxj7: kWnp1: goto zMml8; mYrG8: $json = array("status" => 0, "msg" => "操作失败"); goto STn0s; STn0s: echo json_encode($json); goto qQTiV; zMml8: $json = array("status" => 1, "msg" => "操作成功"); goto RweQc; db4wf: $request = pdo_delete($tablename, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto EIj7G; JIq2G: oZvUD: goto jv64A; jv64A: goto kCX9y; goto KKqOa; EIj7G: if ($request) { goto kWnp1; } goto mYrG8; qQTiV: goto oZvUD; goto ZPxj7; RweQc: echo json_encode($json); goto JIq2G; KKqOa: } goto LZWEL; YHsy3: $tablename = 'xc_beauty_nav'; goto COPGB; x7T4I: $ops = array("list", "edit", "savemodel", "delete", "statuschange"); goto tDUzk; HHNRA: kCX9y: goto RyTOI; rkdpR: $uniacid = $_W['uniacid']; goto rBkZb; LZWEL: tp1bm: goto HHNRA; rBkZb: $op = in_array($_GPC['op'], $ops) ? $_GPC['op'] : 'list'; goto YHsy3; tDUzk: global $_GPC, $_W; goto rkdpR; RyTOI: } public function doWebPick_class() { goto eXWpg; bIbkb: $tablename = 'xc_beauty_pick_class'; goto NVq0y; M0ADI: global $_GPC, $_W; goto oegMy; eXWpg: $ops = array("list", "edit", "savemodel", "delete", "statuschange"); goto M0ADI; pHDtM: $op = in_array($_GPC['op'], $ops) ? $_GPC['op'] : 'list'; goto bIbkb; ZNNZJ: WzsZs: goto Yc60q; oegMy: $uniacid = $_W['uniacid']; goto pHDtM; Yc60q: Hk846: goto H8yF_; NVq0y: switch ($op) { case 'list': goto T3KdF; J2DNy: $pageindex = 1; goto ND28b; dMI3b: $condition['name LIKE'] = '%' . $_GPC['xname'] . '%'; goto e0B5u; e0B5u: qFBHf: goto zVhfk; fJMSj: if (empty($_GPC['xname'])) { goto qFBHf; } goto EcZat; c7Cpw: $pageindex = intval($_GPC['page']); goto MklYU; sZHKS: $total = count($request); goto OBQ8k; DJpl_: xozuW: goto J2DNy; MklYU: goto GZH6u; goto DJpl_; ND28b: GZH6u: goto UFUEH; zVhfk: $request = pdo_getall($tablename, $condition); goto sZHKS; GC613: include $this->template('Pick_class/list'); goto RqmZL; OBQ8k: if (!isset($_GPC['page'])) { goto xozuW; } goto c7Cpw; UFUEH: $pagesize = 15; goto pakUH; pakUH: $pager = pagination($total, $pageindex, $pagesize); goto tddqj; shZij: $condition['uniacid'] = $uniacid; goto fJMSj; T3KdF: $version_id = $_GPC['version_id']; goto nOia7; tddqj: $list = pdo_getall($tablename, $condition, array(), '', 'sort DESC,createtime DESC', array($pageindex, $pagesize)); goto GC613; RqmZL: goto Hk846; goto YVzC1; EcZat: $xname = $_GPC['xname']; goto dMI3b; nOia7: $condition = array(); goto shZij; YVzC1: case 'edit': goto kdSms; n5sV0: $list = pdo_get($tablename, array("id" => $_GPC['id'])); goto pM3f2; tXF66: $list['status'] = 1; goto lT0B0; lT0B0: goto cB7S2; goto v8fQ2; CcDRt: include $this->template('Pick_class/edit'); goto SVmMt; v8fQ2: S1s3W: goto n5sV0; NRlZb: $dm = array("shuang_liu" => 1, "ben_tian" => 1, "lv_chang" => 1); goto CcDRt; kdSms: if (!empty($_GPC['id'])) { goto S1s3W; } goto tXF66; pM3f2: cB7S2: goto NRlZb; SVmMt: goto Hk846; goto F_rqW; F_rqW: case 'savemodel': goto F82GV; dG_yT: c68HP: goto FYNKd; Aq0yr: if (empty($_GPC['sort'])) { goto jQo_4; } goto OKD2P; RPYhm: $condition['sort'] = 0; goto b4T5v; bZn5H: $condition['name'] = $_GPC['name']; goto czU1S; YgaPA: echo json_encode($json); goto t6Pv_; IEeXM: $condition['status'] = $_GPC['status']; goto rKu3i; wr2K0: echo json_encode($json); goto Qh0Eu; h76KX: I7W8u: goto Aq0yr; r4UY0: if (empty($_GPC['id'])) { goto buUwU; } goto AEmIH; rKu3i: goto I7W8u; goto dG_yT; OJ_5X: if (!empty($request)) { goto qO3iV; } goto tXhaw; b4T5v: U2ywX: goto r4UY0; F6CQ2: qO3iV: goto s5FN8; orsWb: $condition['uniacid'] = $uniacid; goto bZn5H; T_UOf: goto uVLRr; goto bracz; czU1S: if (empty($_GPC['status'])) { goto c68HP; } goto IEeXM; bracz: buUwU: goto uMHoA; F82GV: $condition = array(); goto orsWb; AEmIH: $request = pdo_update($tablename, $condition, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto T_UOf; OKD2P: $condition['sort'] = $_GPC['sort']; goto QgwtZ; FYNKd: $condition['status'] = -1; goto h76KX; QgwtZ: goto U2ywX; goto ZDeHj; ZDeHj: jQo_4: goto RPYhm; Qh0Eu: Fs2mg: goto vj0oG; qdXYq: uVLRr: goto OJ_5X; s5FN8: $json = array("status" => 1, "msg" => "操作成功"); goto wr2K0; uMHoA: $request = pdo_insert($tablename, $condition); goto qdXYq; t6Pv_: goto Fs2mg; goto F6CQ2; tXhaw: $json = array("status" => 0, "msg" => "操作失败"); goto YgaPA; vj0oG: goto Hk846; goto Gt8Aj; Gt8Aj: case 'statuschange': goto yl_jx; nBOmC: goto Hk846; goto au1up; GHme2: if ($request) { goto pE7cD; } goto goTRA; jwLYA: echo json_encode($json); goto Damau; nkvcd: echo json_encode($json); goto OlmpQ; yl_jx: $request = pdo_update($tablename, array($_GPC['name'] => $_GPC['status']), array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto GHme2; p0l_G: $json = array("status" => 1, "msg" => "操作成功"); goto nkvcd; faxjp: pE7cD: goto p0l_G; Damau: goto Hom1H; goto faxjp; OlmpQ: Hom1H: goto nBOmC; goTRA: $json = array("status" => 0, "msg" => "操作失败"); goto jwLYA; au1up: case 'delete': goto EZUR7; ItYdl: if ($request) { goto qoEz3; } goto NZCse; Q8RZi: echo json_encode($json); goto CC6sv; hk3QA: goto P58jI; goto QQhHb; I8ELF: echo json_encode($json); goto hk3QA; EZUR7: $request = pdo_delete($tablename, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto ItYdl; NZCse: $json = array("status" => 0, "msg" => "操作失败"); goto I8ELF; CC6sv: P58jI: goto Ovrpa; msY9s: $json = array("status" => 1, "msg" => "操作成功"); goto Q8RZi; QQhHb: qoEz3: goto msY9s; Ovrpa: goto Hk846; goto R2ycN; R2ycN: } goto ZNNZJ; H8yF_: } public function doWebPick() { goto rznq_; bOm4A: aXuyT: goto lpQGp; ZnKgp: switch ($op) { case 'list': goto voKIz; LJlD9: $request = pdo_getall($tablename, $condition); goto bVwxI; t5X1x: foreach ($class as $c) { $datalist[$c['id']] = $c; fC3mf: } goto bfFQa; kerwZ: $xname = $_GPC['xname']; goto rIqG0; l3lMG: $list = pdo_getall($tablename, $condition, array(), '', 'sort DESC,createtime DESC', array($pageindex, $pagesize)); goto BAmgT; bVwxI: $total = count($request); goto OPG00; ilVka: $condition['cid'] = $_GPC['cid']; goto NnE9K; BAmgT: $class = pdo_getall('xc_beauty_pick_class', array("uniacid" => $uniacid)); goto r_G_9; XnqKi: Cq7up: goto vRFyC; ZnkdG: goto Tp8yC; goto f1ZDf; V3LWX: if (empty($_GPC['xname'])) { goto ceGTb; } goto kerwZ; bfFQa: vZHD9: goto vaKtd; n_0IE: $pagesize = 15; goto md7vM; vaKtd: nFjZC: goto ZbGZZ; sm3H_: if (empty($_GPC['cid'])) { goto zdR7_; } goto OnIsw; u1iKl: uRGW1: goto n_0IE; u32qi: $pageindex = 1; goto u1iKl; md7vM: $pager = pagination($total, $pageindex, $pagesize); goto l3lMG; XsKZw: foreach ($list as &$x) { $x['cid_name'] = $datalist[$x['cid']]['name']; Ybgkj: } goto XnqKi; qtEgV: if (!$class) { goto nFjZC; } goto t5X1x; V4MGR: $condition = array(); goto dW4Ik; r_G_9: $datalist = array(); goto qtEgV; voKIz: $version_id = $_GPC['version_id']; goto V4MGR; zhFJH: ceGTb: goto sm3H_; ZbGZZ: if (!$list) { goto RTmoI; } goto XsKZw; iS0hJ: goto uRGW1; goto Hkl6X; OnIsw: $cid = $_GPC['cid']; goto ilVka; rIqG0: $condition['name LIKE'] = '%' . $_GPC['xname'] . '%'; goto zhFJH; NnE9K: zdR7_: goto LJlD9; Hkl6X: llEvC: goto u32qi; dW4Ik: $condition['uniacid'] = $uniacid; goto V3LWX; DNTyj: $pageindex = intval($_GPC['page']); goto iS0hJ; qkS0Q: include $this->template('Pick/list'); goto ZnkdG; vRFyC: RTmoI: goto qkS0Q; OPG00: if (!isset($_GPC['page'])) { goto llEvC; } goto DNTyj; f1ZDf: case 'edit': goto oXbLL; Iitiy: roOId: goto CPI4g; ljCEJ: goto MFIwZ; goto Iitiy; v8pWu: $list['status'] = 1; goto ljCEJ; nNgjR: if (!empty($_GPC['id'])) { goto roOId; } goto v8pWu; CPI4g: $list = pdo_get($tablename, array("id" => $_GPC['id'])); goto tE24w; tE24w: MFIwZ: goto LOC7u; glk6e: goto Tp8yC; goto jmQXC; LOC7u: include $this->template('Pick/edit'); goto glk6e; oXbLL: $class = pdo_getall('xc_beauty_pick_class', array("status" => 1, "uniacid" => $uniacid), array(), '', 'sort DESC,createtime DESC'); goto nNgjR; jmQXC: case 'savemodel': goto QRP6Q; Pb01F: $condition['unit'] = $_GPC['unit']; goto SMCMV; f98qs: goto JH3IY; goto A0Q6q; kRn7B: $condition['uniacid'] = $uniacid; goto WjcEU; vR84G: JH3IY: goto Gldoz; wQ_N3: $condition['sort'] = $_GPC['sort']; goto Xw4om; ZrBTG: goto pENsD; goto vTRbl; JJxEs: kQNqD: goto ACdlx; QRP6Q: $condition = array(); goto kRn7B; HznZK: echo json_encode($json); goto ZrBTG; TT5JL: $condition['status'] = $_GPC['status']; goto f98qs; SMCMV: if (empty($_GPC['status'])) { goto kfrq8; } goto TT5JL; L7seU: Oa7b1: goto jiSlA; qSrEh: $json = array("status" => 0, "msg" => "操作失败"); goto HznZK; VDtIC: $condition['status'] = -1; goto vR84G; ItVJl: echo json_encode($json); goto mZKmX; g3aFL: goto hxy6J; goto L7seU; a1kQB: if (!empty($request)) { goto fc70U; } goto qSrEh; gTV08: $json = array("status" => 1, "msg" => "操作成功"); goto ItVJl; TfXca: $condition['price'] = $_GPC['price']; goto Pb01F; WjcEU: $condition['name'] = $_GPC['name']; goto b49Uj; QobLS: goto Tp8yC; goto LYmgF; TXVbE: if (empty($_GPC['id'])) { goto Oa7b1; } goto SmXo_; A0Q6q: kfrq8: goto VDtIC; jiSlA: $request = pdo_insert($tablename, $condition); goto xLyTh; czgGo: Adlcb: goto TXVbE; Xw4om: goto Adlcb; goto JJxEs; ACdlx: $condition['sort'] = 0; goto czgGo; Gldoz: if (empty($_GPC['sort'])) { goto kQNqD; } goto wQ_N3; xLyTh: hxy6J: goto a1kQB; vTRbl: fc70U: goto gTV08; SmXo_: $request = pdo_update($tablename, $condition, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto g3aFL; b49Uj: $condition['cid'] = $_GPC['cid']; goto TfXca; mZKmX: pENsD: goto QobLS; LYmgF: case 'statuschange': goto iC1pS; QtAUV: Kh6r0: goto XgRcK; fAyXm: echo json_encode($json); goto QtAUV; k1lyb: YvfST: goto vKy2A; VH0P8: echo json_encode($json); goto Xu7Dv; Xu7Dv: goto Kh6r0; goto k1lyb; iC1pS: $request = pdo_update($tablename, array($_GPC['name'] => $_GPC['status']), array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto DZ3J2; yNI8T: $json = array("status" => 0, "msg" => "操作失败"); goto VH0P8; vKy2A: $json = array("status" => 1, "msg" => "操作成功"); goto fAyXm; DZ3J2: if ($request) { goto YvfST; } goto yNI8T; XgRcK: goto Tp8yC; goto waICx; waICx: case 'delete': goto gh0e8; t9y3x: $json = array("status" => 1, "msg" => "操作成功"); goto rh1nv; TQMjc: m6e2S: goto yuBrF; yuBrF: goto Tp8yC; goto Jao_V; bilUU: $json = array("status" => 0, "msg" => "操作失败"); goto MQsK3; NjozS: goto m6e2S; goto YkJ_q; gh0e8: $request = pdo_delete($tablename, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto vJwR2; MQsK3: echo json_encode($json); goto NjozS; vJwR2: if ($request) { goto cQGw9; } goto bilUU; rh1nv: echo json_encode($json); goto TQMjc; YkJ_q: cQGw9: goto t9y3x; Jao_V: } goto bOm4A; EZIoY: $op = in_array($_GPC['op'], $ops) ? $_GPC['op'] : 'list'; goto OrMkl; tc0Ie: global $_GPC, $_W; goto QctMw; lpQGp: Tp8yC: goto w8JP_; QctMw: $uniacid = $_W['uniacid']; goto EZIoY; rznq_: $ops = array("list", "edit", "savemodel", "delete", "statuschange"); goto tc0Ie; OrMkl: $tablename = 'xc_beauty_pick_service'; goto ZnKgp; w8JP_: } public function doWebPick_order() { goto AOfx9; yJHfQ: hGhK8: goto EWKeB; cSiJi: DAYOz: goto yJHfQ; XvTg_: $uniacid = $_W['uniacid']; goto NC2hn; B2H8c: switch ($op) { case 'list': goto n3wuy; HfloR: $condition['status'] = $_GPC['status']; goto xn_c1; h7xUH: $datalist = array(); goto MShWq; NhICZ: $service = pdo_getall('xc_beauty_pick_service', array("uniacid" => $uniacid)); goto h7xUH; RwjG4: goto FPFox; goto e59gn; F3WXj: $out_trade_no = $_GPC['out_trade_no']; goto KuAxQ; vwxFf: goto hGhK8; goto lYsGm; dvOZN: if (!isset($_GPC['page'])) { goto NdUI6; } goto cHqWJ; MShWq: if (!$service) { goto F8TVS; } goto J2NzD; J3yH7: if (!$list) { goto z3PGd; } goto NhICZ; hOhnc: $pager = pagination($total, $pageindex, $pagesize); goto vHuj9; e59gn: NdUI6: goto MJRB1; J2NzD: foreach ($service as $x2) { $datalist[$x2['id']] = $x2; urW0o: } goto YFRjj; Lsft5: Aw2OW: goto cvOad; Y7qhi: $openid = $_GPC['openid']; goto BSUY2; WGOXg: if (empty($_GPC['status'])) { goto zoFFP; } goto z7AO7; FqpY_: $pagesize = 15; goto hOhnc; z7AO7: $status = $_GPC['status']; goto HfloR; n3wuy: $condition = array(); goto xMP1r; KuAxQ: $condition['out_trade_no LIKE'] = '%' . $_GPC['out_trade_no'] . '%'; goto eHGxe; DpXtb: $store = pdo_getall('xc_beauty_store', array("uniacid" => $uniacid)); goto Df7OZ; YHWPv: FPFox: goto FqpY_; qNOmb: if (empty($_GPC['out_trade_no'])) { goto wuawU; } goto F3WXj; T5tDk: foreach ($store as $s) { $store_list[$s['id']] = $s; SL1SZ: } goto Lsft5; HZ8zA: z3PGd: goto kPo3R; oYR3L: $total = count($request); goto dvOZN; Fcr_Q: $request = pdo_getall($tablename, $condition); goto oYR3L; eHGxe: wuawU: goto tpCyF; SpHu_: foreach ($list as &$x) { goto z5AT1; SRpst: dAPXs: goto dGKEK; DrCV5: $x['pid'] = json_decode($x['pid'], true); goto rWyLp; z5AT1: $x['store_name'] = $store_list[$x['store']]['name']; goto DrCV5; QlzhZ: LsITr: goto SRpst; T8TOy: foreach ($x['pid'] as &$pp) { $pp['name'] = $datalist[$pp['id']]['name']; CbuDo: } goto QlzhZ; rWyLp: if (!(!empty($x['pid']) && is_array($x['pid']))) { goto dAPXs; } goto T8TOy; dGKEK: FtiQ_: goto KPq8B; KPq8B: } goto KP02z; YFRjj: CgCbd: goto wq5zI; xn_c1: zoFFP: goto Fcr_Q; Df7OZ: $store_list = array(); goto QcT30; kPo3R: include $this->template('Pick_order/list'); goto vwxFf; KP02z: a0t0V: goto HZ8zA; QcT30: if (!$store) { goto UX9yy; } goto T5tDk; MJRB1: $pageindex = 1; goto YHWPv; wq5zI: F8TVS: goto DpXtb; cvOad: UX9yy: goto SpHu_; BSUY2: $condition['openid LIKE'] = '%' . $_GPC['openid'] . '%'; goto I3MZT; tpCyF: if (empty($_GPC['openid'])) { goto zTXqx; } goto Y7qhi; xMP1r: $condition['uniacid'] = $uniacid; goto qNOmb; vHuj9: $list = pdo_getall($tablename, $condition, array(), '', 'createtime DESC', array($pageindex, $pagesize)); goto J3yH7; cHqWJ: $pageindex = intval($_GPC['page']); goto RwjG4; I3MZT: zTXqx: goto WGOXg; lYsGm: case 'statuschange': goto kvsGG; rghS1: $json = array("status" => 1, "msg" => "操作成功"); goto CqTJ_; rA5Sj: Sto0J: goto a26Hg; KapS_: $json = array("status" => 0, "msg" => "操作失败"); goto McM8t; a26Hg: goto hGhK8; goto MBv90; CqTJ_: echo json_encode($json); goto rA5Sj; waqoe: if ($request) { goto KYIxi; } goto KapS_; q2eiv: KYIxi: goto rghS1; qjeo1: goto Sto0J; goto q2eiv; kvsGG: $request = pdo_update($tablename, array("status" => 1), array("uniacid" => $uniacid, "id" => $_GPC['id'])); goto waqoe; McM8t: echo json_encode($json); goto qjeo1; MBv90: case 'delete': goto j7diD; o4n1V: goto hGhK8; goto XC3O1; yAaUP: $json = array("status" => 1, "msg" => "操作成功"); goto aIfKx; j7diD: $request = pdo_delete($tablename, array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto sJUCJ; jsb7Z: goto fehq6; goto TtdQm; TcbYp: echo json_encode($json); goto jsb7Z; rybUi: fehq6: goto o4n1V; aIfKx: echo json_encode($json); goto rybUi; N4VsX: $json = array("status" => 0, "msg" => "操作失败"); goto TcbYp; TtdQm: k7L0U: goto yAaUP; sJUCJ: if ($request) { goto k7L0U; } goto N4VsX; XC3O1: } goto cSiJi; AOfx9: $ops = array("list", "statuschange", "add_orders"); goto OVZTW; t2uHP: $tablename = 'xc_beauty_pick_order'; goto B2H8c; NC2hn: $op = in_array($_GPC['op'], $ops) ? $_GPC['op'] : 'list'; goto t2uHP; OVZTW: global $_GPC, $_W; goto XvTg_; EWKeB: } public function doWebExport() { goto tqyfa; eMPIB: if (empty($_GPC['use'])) { goto rVkgK; } goto iRc0Y; hH3aP: header('Content-Disposition: attachment; filename=order.xls'); goto q1Hqx; OGTdA: fZsCI: goto YkUjo; jhRdW: if (!$store) { goto DIajz; } goto zO7P8; D1UYU: rVkgK: goto JYFvt; LH6Es: mQKdY: goto xER4u; BrICi: $condition['openid LIKE'] = '%' . $_GPC['openid'] . '%'; goto F1dOG; QQIi4: foreach ($order as $v) { goto eid88; v07Xs: $data = $data . '<td>' . $v['userinfo']['name'] . '</td>'; goto Km03x; wIPVI: $data = $data . '<td>' . $v['store_name'] . '</td>'; goto LYm31; aZu9O: $data = $data . '<td>' . $v['userinfo']['address'] . '</td>'; goto MDmwL; MDmwL: $data = $data . '<td>' . $v['plan_date'] . '</td>'; goto UF9fr; yAd3K: $data = $data . '<td style=\'vnd.ms-excel.numberformat:@\'>' . $v['out_trade_no'] . '</td>'; goto nev7R; nhbBT: goto OhUSj; goto ucfjo; JWnei: $data = $data . '</tr>'; goto lF0gP; Km03x: $data = $data . '<td>' . $v['userinfo']['mobile'] . '</td>'; goto aZu9O; oVPTR: $data = $data . '<tr>'; goto yAd3K; LYm31: $data = $data . '<td>' . $v['member_name'] . '</td>'; goto FVBzf; I6jVW: if (!($v['pay_type'] == 2)) { goto Ntaxe; } goto NuWnS; FVBzf: $data = $data . '<td>' . $v['coupon_price'] . '</td>'; goto gEBYH; H19KM: $v['pay_name'] = '余额支付'; goto ou6as; NuWnS: $v['pay_name'] = '微信支付'; goto OqqJ5; UF9fr: $data = $data . '<td>' . $v['content'] . '</td>'; goto JWnei; GYOD5: $data = $data . '<td>' . $v['o_amount'] . '</td>'; goto XNLdh; lF0gP: MYMsJ: goto rAHaP; OqqJ5: Ntaxe: goto nhbBT; XNLdh: $data = $data . '<td>' . $v['total'] . '</td>'; goto v07Xs; nev7R: $data = $data . '<td style=\'vnd.ms-excel.numberformat:@\'>' . $v['pay_name'] . '</td>'; goto PEo_W; PEo_W: $data = $data . '<td>' . $v['service'] . '</td>'; goto wIPVI; gEBYH: $data = $data . '<td>' . $v['amount'] . '</td>'; goto GYOD5; ucfjo: SmDSI: goto H19KM; ou6as: OhUSj: goto oVPTR; eid88: if ($v['pay_type'] == 1) { goto SmDSI; } goto I6jVW; rAHaP: } goto GBKVd; Gy_YU: $service = pdo_getall('xc_beauty_service', array("uniacid" => $uniacid)); goto E9eSA; mYw7G: $condition['pay_type'] = $_GPC['pay_type']; goto OGTdA; OSR3B: $times = $_GPC['times']; goto rXXHS; sPAmm: $data = '<table border=\'1\'>' . $data . '</table>'; goto bSfH1; nOFC3: $order = pdo_getall('xc_beauty_order', $condition, array(), '', 'createtime DESC'); goto mx5Zy; bSfH1: echo $data . '	'; goto yTrfK; LlVZa: Q510X: goto nOFC3; UdKPJ: echo '无订单记录'; goto HQB0I; GBKVd: Ydr6M: goto sPAmm; dNddh: $member = pdo_getall('xc_beauty_store_member', array("uniacid" => $uniacid)); goto azsTI; pRRmL: HGP1O: goto ojrSw; rXXHS: $condition['createtime >='] = $_GPC['times']['start']; goto iciF2; C_IJj: if (empty($_GPC['openid'])) { goto qYodH; } goto BrICi; BOYnK: s_km9: goto jTrOl; E9eSA: $datalist = array(); goto JygZa; ga_uO: if (!$member) { goto pB45r; } goto Cvmun; zO7P8: foreach ($store as $s) { $store_list[$s['id']] = $s; wV0sd: } goto pRRmL; xER4u: pB45r: goto lDXFd; EpAW4: $condition['status'] = 1; goto tNycG; wiOff: $condition['store'] = $_GPC['store_id']; goto Q5jxh; q07nZ: SH_Gz: goto XXkot; YkUjo: if (empty($_GPC['store_id'])) { goto EaGZD; } goto wiOff; tqyfa: global $_GPC, $_W; goto XyXE0; iAhAt: if (empty($_GPC['out_trade_no'])) { goto YyKcy; } goto sH0XG; XXkot: $store = pdo_getall('xc_beauty_store', array("uniacid" => $uniacid), array(), '', 'sort DESC,createtime DESC'); goto R9P02; YsZU0: $condition['uniacid'] = $uniacid; goto iAhAt; ekQl6: YyKcy: goto C_IJj; Uk7PX: Exh_R: goto dNddh; iciF2: $condition['createtime <='] = $_GPC['times']['end']; goto LlVZa; jTrOl: if (empty($_GPC['pay_type'])) { goto fZsCI; } goto mYw7G; JygZa: if (!$service) { goto Exh_R; } goto PCVu_; zGdtY: e333U: goto Uk7PX; yTrfK: jKwo2: goto JcVF7; q1Hqx: $data = '<tr><th>订单号</th><th>订单支付方式</th><th>服务项目</th><th>门店</th><th>店员</th><th>优惠（元）</th><th>应付款（元）</th><th>实付款（元）</th><th>总件数</th><th>姓名</th><th>手机号</th><th>地址</th><th>日期</th><th>备注</th></tr>'; goto QQIi4; HQB0I: goto jKwo2; goto q07nZ; vWVvI: if (empty($_GPC['times'])) { goto Q510X; } goto OSR3B; XyXE0: $uniacid = $_W['uniacid']; goto EpAW4; mx5Zy: if ($order) { goto SH_Gz; } goto UdKPJ; ppoUV: header('Content-type: application/vnd.ms-excel; charset=utf8'); goto hH3aP; ojrSw: DIajz: goto Gy_YU; sH0XG: $condition['out_trade_no LIKE'] = '%' . $_GPC['out_trade_no'] . '%'; goto ekQl6; F1dOG: qYodH: goto eMPIB; DYgu5: qPGm1: goto ppoUV; iRc0Y: $condition['use'] = $_GPC['use']; goto D1UYU; Cvmun: foreach ($member as $m) { $member_list[$m['id']] = $m; y3U0d: } goto LH6Es; lt4D2: $condition['userinfo LIKE'] = '%' . $_GPC['content'] . '%'; goto BOYnK; JYFvt: if (empty($_GPC['content'])) { goto s_km9; } goto lt4D2; tNycG: $condition['order_type'] = 1; goto YsZU0; lDXFd: foreach ($order as &$x) { goto FNW_2; jXOKX: $x['store_name'] = $store_list[$x['store']]['name']; goto Akbez; FNW_2: $x['service'] = $datalist[$x['pid']]['name']; goto qmTNn; Akbez: $x['member_name'] = $member_list[$x['member']]['name']; goto ndxmA; qmTNn: $x['userinfo'] = json_decode($x['userinfo'], true); goto jXOKX; ndxmA: CxbD4: goto YEI5D; YEI5D: } goto DYgu5; Q5jxh: EaGZD: goto vWVvI; PCVu_: foreach ($service as $x2) { $datalist[$x2['id']] = $x2; sPn_r: } goto zGdtY; azsTI: $member_list = array(); goto ga_uO; R9P02: $store_list = array(); goto jhRdW; JcVF7: } public function doWebExport2() { goto PXvxL; ub2Bh: $datalist = array(); goto G71px; YZ32H: header('Content-Disposition: attachment; filename=order.xls'); goto pjxER; lu9lO: if (!$group) { goto Zo3Do; } goto gnUNf; S6pwI: htV1w: goto V9tP9; V9tP9: aYBIz: goto hJM01; ZZmg1: echo '无订单记录'; goto d0pHD; TX4PM: header('Content-type: application/vnd.ms-excel; charset=utf8'); goto YZ32H; qlI_K: $group_id = array(); goto t5MMG; lYEzz: $order = pdo_getall('xc_beauty_order', array("status" => 1, "uniacid" => $uniacid, "order_type" => 3, "group IN" => $group_id), array(), '', 'createtime DESC'); goto Tq_aK; Tq_aK: if ($order) { goto LS0zR; } goto ZZmg1; d0pHD: goto CskIX; goto UZj5E; GvvIM: echo $data . '	'; goto bhAt0; eEmMZ: $uniacid = $_W['uniacid']; goto qlI_K; bhAt0: CskIX: goto qY5Bd; rMU2_: foreach ($order as $v) { goto I0uIA; vTP4Q: $data = $data . '<td>' . $v['total'] . '</td>'; goto tWxqe; OVWdZ: T2W1y: goto fOnh8; YSsvV: if (!($v['pay_type'] == 2)) { goto W3Qbi; } goto GqGls; Ccj7g: zWZ3g: goto DSugh; I0uIA: if ($v['pay_type'] == 1) { goto T2W1y; } goto YSsvV; tKWlq: $data = $data . '<td style=\'vnd.ms-excel.numberformat:@\'>' . $v['pay_name'] . '</td>'; goto cD2Lc; ohCUt: $data = $data . '<td>' . $v['userinfo']['mobile'] . '</td>'; goto gkkla; vOfFC: $data = $data . '<td>' . $v['plan_date'] . '</td>'; goto tZ2pQ; tWxqe: $data = $data . '<td>' . $v['userinfo']['name'] . '</td>'; goto ohCUt; IMH1p: $data = $data . '</tr>'; goto Ccj7g; tZ2pQ: $data = $data . '<td>' . $v['content'] . '</td>'; goto IMH1p; T3Zmy: $data = $data . '<td>' . $v['amount'] . '</td>'; goto PWcdi; zalDS: $data = $data . '<td>' . $v['coupon_price'] . '</td>'; goto T3Zmy; SC2Sa: W3Qbi: goto QtKBe; GqGls: $v['pay_name'] = '微信支付'; goto SC2Sa; IJ_2h: A9mS8: goto GPHkw; PWcdi: $data = $data . '<td>' . $v['o_amount'] . '</td>'; goto vTP4Q; QtKBe: goto A9mS8; goto OVWdZ; LS_uK: $data = $data . '<td style=\'vnd.ms-excel.numberformat:@\'>' . $v['out_trade_no'] . '</td>'; goto tKWlq; gkkla: $data = $data . '<td>' . $v['userinfo']['address'] . '</td>'; goto vOfFC; fOnh8: $v['pay_name'] = '余额支付'; goto IJ_2h; cD2Lc: $data = $data . '<td>' . $v['service'] . '</td>'; goto zalDS; GPHkw: $data = $data . '<tr>'; goto LS_uK; DSugh: } goto GX_dV; WpfrP: $service = pdo_getall('xc_beauty_service', array("uniacid" => $uniacid)); goto ub2Bh; pjxER: $data = '<tr><th>订单号</th><th>订单支付方式</th><th>服务项目</th><th>优惠（元）</th><th>应付款（元）</th><th>实付款（元）</th><th>总件数</th><th>姓名</th><th>手机号</th><th>地址</th><th>日期</th><th>备注</th></tr>'; goto rMU2_; hJM01: foreach ($order as &$x) { goto BMiZ6; BMiZ6: $x['service'] = $datalist[$x['pid']]['name']; goto FPRaj; CPFoR: QxUAa: goto tmYKk; FPRaj: $x['userinfo'] = json_decode($x['userinfo'], true); goto CPFoR; tmYKk: } goto urgqv; FeAMV: $data = '<table border=\'1\'>' . $data . '</table>'; goto GvvIM; G71px: if (!$service) { goto aYBIz; } goto znMvo; L7II5: WxY8t: goto QZ84C; znMvo: foreach ($service as $x2) { $datalist[$x2['id']] = $x2; BOZ_8: } goto S6pwI; QZ84C: Zo3Do: goto lYEzz; UZj5E: LS0zR: goto WpfrP; PXvxL: global $_GPC, $_W; goto eEmMZ; GX_dV: KtNIC: goto FeAMV; urgqv: zGSYV: goto TX4PM; t5MMG: $group = pdo_getall('xc_beauty_group', array("status" => 1, "uniacid" => $uniacid)); goto lu9lO; gnUNf: foreach ($group as $g) { $group_id[] = $g['id']; etwfP: } goto L7II5; qY5Bd: } public function doWebExport3() { goto Q2kRT; biOtq: $condition['userinfo LIKE'] = '%' . $_GPC['content'] . '%'; goto Dtt_e; R0Uit: $condition['use'] = $_GPC['use']; goto PAEHp; HMQ0D: $data = '<table border=\'1\'>' . $data . '</table>'; goto hQpGZ; Q7ReS: if (empty($_GPC['pay_type'])) { goto LW6i7; } goto tVaIn; t4aWk: $times = $_GPC['times']; goto lxXsZ; U8OR3: gctv4: goto kDLqv; sDJdD: if (empty($_GPC['openid'])) { goto OQAcu; } goto bEoDF; Bn2un: $datalist = array(); goto N3xsc; hQpGZ: echo $data . '	'; goto aN0OD; rsBSb: rFX21: goto hIs8f; RE2oE: UEckB: goto xf_aI; snySN: header('Content-type: application/vnd.ms-excel; charset=utf8'); goto EehQ2; xYni2: foreach ($order as $v) { goto emS3M; Dfxea: $data = $data . '<td style=\'vnd.ms-excel.numberformat:@\'>' . $v['out_trade_no'] . '</td>'; goto UvGiI; MrJ9k: $data = $data . '<td>' . $v['userinfo']['address'] . '</td>'; goto KIt8X; goIdj: CjPet: goto CNrKh; t4nsn: $data = $data . '<td>' . $v['o_amount'] . '</td>'; goto huXNy; KIt8X: $data = $data . '<td>' . $v['plan_date'] . '</td>'; goto mMiwP; CNrKh: goto wkFcf; goto MjGOE; EKDXY: $data = $data . '<td>' . $v['userinfo']['name'] . '</td>'; goto Gr40C; EIQY7: NtZ65: goto Q9S8L; Gr40C: $data = $data . '<td>' . $v['userinfo']['mobile'] . '</td>'; goto MrJ9k; w8cde: $data = $data . '<td>' . $v['coupon_price'] . '</td>'; goto Ytned; IbfzA: $v['pay_name'] = '余额支付'; goto R4RTi; emS3M: if ($v['pay_type'] == 2) { goto yU69L; } goto Bshfi; Rwckc: $data = $data . '</tr>'; goto EIQY7; hblYK: $v['pay_name'] = '微信支付'; goto goIdj; mMiwP: $data = $data . '<td>' . $v['content'] . '</td>'; goto Rwckc; n7_xk: $data = $data . '<td>' . $v['store_name'] . '</td>'; goto LY3JF; MjGOE: yU69L: goto IbfzA; LY3JF: $data = $data . '<td>' . $v['member_name'] . '</td>'; goto w8cde; Ytned: $data = $data . '<td>' . $v['amount'] . '</td>'; goto t4nsn; UvGiI: $data = $data . '<td style=\'vnd.ms-excel.numberformat:@\'>' . $v['pay_name'] . '</td>'; goto aAUaJ; dczAK: $data = $data . '<tr>'; goto Dfxea; R4RTi: wkFcf: goto dczAK; huXNy: $data = $data . '<td>' . $v['total'] . '</td>'; goto EKDXY; Bshfi: if (!($v['pay_type'] == 1)) { goto CjPet; } goto hblYK; aAUaJ: $data = $data . '<td>' . $v['service'] . '</td>'; goto n7_xk; Q9S8L: } goto MLd2u; N3xsc: if (!$service) { goto NkzVM; } goto KXk1a; hIs8f: X9kkn: goto stMIp; B1NZd: $condition['uniacid'] = $uniacid; goto nIUpn; bEoDF: $condition['openid LIKE'] = '%' . $_GPC['openid'] . '%'; goto Wc4U6; qwUwU: $service = pdo_getall('xc_beauty_store_service', array("uniacid" => $uniacid)); goto Bn2un; KXk1a: foreach ($service as $x2) { $datalist[$x2['id']] = $x2; zltdj: } goto gIRyP; aN0OD: mqojU: goto RYAWc; T6IBp: if (!$store) { goto UEckB; } goto zQhKc; EehQ2: header('Content-Disposition: attachment; filename=order.xls'); goto ic1iN; njqzm: echo '无订单记录'; goto MerAt; rokPT: foreach ($order as &$x) { goto rGzgH; z2SMq: ibS9X: goto SlhPt; Bh1ea: tBFZm: goto sp22z; gw1Q1: PACyc: goto ITHgu; rGzgH: $x['service'] = $datalist[$x['pid']]['name']; goto AGyez; xoc5e: $x['store_name'] = $store_list[$x['store']]['name']; goto PrVYB; SlhPt: $x['member_name'] = $member_list[$x['member']]['name']; goto gw1Q1; PrVYB: goto ibS9X; goto Bh1ea; sp22z: $x['store_name'] = $title; goto z2SMq; AGyez: $x['userinfo'] = json_decode($x['userinfo'], true); goto fBNug; fBNug: if ($x['store'] == -1) { goto tBFZm; } goto xoc5e; ITHgu: } goto wewIF; jOVO7: $condition['order_type'] = 4; goto B1NZd; yhPXk: $condition['status'] = 1; goto jOVO7; Q2kRT: global $_GPC, $_W; goto Wd2Xq; kDLqv: if (empty($_GPC['times'])) { goto nzmXU; } goto t4aWk; LMWnH: $title = ''; goto rokPT; lxXsZ: $condition['createtime >='] = $_GPC['times']['start']; goto R6J7e; zQhKc: foreach ($store as $s) { $store_list[$s['id']] = $s; DbEhf: } goto VERqa; HkskW: if (empty($_GPC['store_id'])) { goto gctv4; } goto fUmhR; Uy9O7: $order = pdo_getall('xc_beauty_order', $condition, array(), '', 'createtime DESC'); goto RUZWL; VGFSN: NkzVM: goto Kg4TO; xf_aI: $member = pdo_getall('xc_beauty_store_member', array("uniacid" => $uniacid)); goto ZrgV8; Tnure: qVsQQ: goto sDJdD; PAEHp: ZRLVW: goto YepBH; Wc4U6: OQAcu: goto WUQzb; wewIF: EAygd: goto snySN; tVaIn: $condition['pay_type'] = $_GPC['pay_type']; goto QDEMP; ic1iN: $data = '<tr><th>订单号</th><th>订单支付方式</th><th>服务项目</th><th>门店</th><th>店员</th><th>优惠（元）</th><th>应付款（元）</th><th>实付款（元）</th><th>总件数</th><th>姓名</th><th>手机号</th><th>地址</th><th>日期</th><th>备注</th></tr>'; goto xYni2; CrimG: nzmXU: goto Uy9O7; RUZWL: if ($order) { goto Tzgbi; } goto njqzm; fUmhR: $condition['store'] = $_GPC['store_id']; goto U8OR3; FBJf3: if (!$member) { goto X9kkn; } goto IpuIu; QDEMP: LW6i7: goto HkskW; IpuIu: foreach ($member as $m) { $member_list[$m['id']] = $m; TzLQ7: } goto rsBSb; WUQzb: if (empty($_GPC['use'])) { goto ZRLVW; } goto R0Uit; Ghuf0: $store_list = array(); goto T6IBp; nIUpn: if (empty($_GPC['out_trade_no'])) { goto qVsQQ; } goto BeFcN; gIRyP: uTtyO: goto VGFSN; Kg4TO: $store = pdo_getall('xc_beauty_store', array("uniacid" => $uniacid)); goto Ghuf0; Wd2Xq: $uniacid = $_W['uniacid']; goto yhPXk; PKv1v: Tzgbi: goto qwUwU; BeFcN: $condition['out_trade_no LIKE'] = '%' . $_GPC['out_trade_no'] . '%'; goto Tnure; ZrgV8: $member_list = array(); goto FBJf3; Dtt_e: T4qPk: goto Q7ReS; YepBH: if (empty($_GPC['content'])) { goto T4qPk; } goto biOtq; R6J7e: $condition['createtime <='] = $_GPC['times']['end']; goto CrimG; stMIp: $config = pdo_get('xc_beauty_config', array("xkey" => "web", "uniacid" => $uniacid)); goto LMWnH; MerAt: goto mqojU; goto PKv1v; MLd2u: CPdl1: goto HMQ0D; VERqa: tOZT6: goto RE2oE; RYAWc: } public function doWebPost() { goto RoeNg; JNL1v: $url = $_GPC['url']; goto cNkki; Dcuz4: foreach ($get as $x3) { goto eUYrC; eUYrC: if (empty($url_data)) { goto b8CgN; } goto X3Iqf; EO3_D: $url_data = urlencode($x3['attr']) . '=' . urlencode($x3['value']); goto u1Y3M; u1Y3M: npPBT: goto HDoxC; cdkVY: goto npPBT; goto BZg1J; BZg1J: b8CgN: goto EO3_D; HDoxC: L2V91: goto yr1UW; X3Iqf: $url_data = $url_data . '&' . urlencode($x3['attr']) . '=' . urlencode($x3['value']); goto cdkVY; yr1UW: } goto HbdtU; clEWO: load()->func('communication'); goto JNL1v; QawRj: $post = str_replace('{{amount}}', '199元', $post); goto rXczu; ha2of: echo $request_get['content']; goto dfUYC; QQn0m: ChPEu: goto NkYz8; yInU3: $url = $header['Location'][count($header['Location']) - 1]; goto HIzRQ; L4Z2v: $post = str_replace('{{webnamex}}', '美容', $post); goto iaGEf; ERsVM: $url_data = ''; goto Dcuz4; QmSHd: $url = $header['Location']; goto eSIK_; LrAqf: $url = $url . '?' . $url_data; goto gd5s_; rXczu: $post = str_replace('{{namex}}', '张三', $post); goto hd8oQ; UvB4T: $post = json_decode($post, true); goto iqX2s; EVp3c: $post = str_replace('{{addrx}}', '中国北京', $post); goto IR7Yk; svMVf: if (strpos($url, '?') !== false) { goto Vr0Eg; } goto LrAqf; XLIVg: xX3LO: goto L4Z2v; WTTCm: J3P88: goto E2pbd; G5p5R: K6av8: goto xTyLx; eQn67: NkKYP: goto XLIVg; VpwDA: $url = $url . $url_data; goto A0mzf; oA70S: if (is_array($header['Location'])) { goto FB3Qt; } goto QmSHd; iaGEf: $post = str_replace('{{trade}}', '1220171127101100000017', $post); goto QawRj; dfUYC: Ed0KR: goto aXiUM; HbdtU: rwS49: goto svMVf; gd5s_: goto B5KXn; goto LtOek; pmtWn: foreach ($customize as $x) { $get = str_replace('{{' . $x['attr'] . '}}', $x['value'], $get); GBezP: } goto IS8PM; HIpGV: if (!is_array($customize)) { goto xX3LO; } goto tqfqK; RoeNg: global $_GPC, $_W; goto clEWO; W5mnk: foreach ($post as $x2) { $data[$x2['attr']] = $x2['value']; RoKFS: } goto WTTCm; aCMIA: if (!(is_array($get) && !empty($get))) { goto Ed0KR; } goto gGALV; A8HVe: if (!(is_array($post) && !empty($post))) { goto ChPEu; } goto Wre8U; eSIK_: goto UcNhi; goto UmyYr; UXftR: $get = str_replace('{{trade}}', '1220171127101100000017', $get); goto bh1mA; Wre8U: $post = json_encode($post); goto HIpGV; gGALV: $get = json_encode($get); goto xw1nb; LtOek: Vr0Eg: goto VpwDA; xw1nb: if (!is_array($customize)) { goto K6av8; } goto pmtWn; aXiUM: dMXAs: goto Mj3TG; IS8PM: kXf06: goto G5p5R; eM_Bj: $get = str_replace('{{namex}}', '张三', $get); goto eglgX; NkYz8: $get = $sms['content']['get']; goto aCMIA; hd8oQ: $post = str_replace('{{phonex}}', '18888888888', $post); goto EVp3c; yy9Aa: $sms['content'] = json_decode($sms['content'], true); goto qZhCO; qZhCO: $customize = $sms['content']['customize']; goto oD_Xf; xTyLx: $get = str_replace('{{webnamex}}', '美容', $get); goto UXftR; NYBUO: $get = str_replace('{{datex}}', date('Y-m-d H:i'), $get); goto II2yG; cNkki: $sms = pdo_get('xc_beauty_config', array("xkey" => "sms")); goto tgxp1; eglgX: $get = str_replace('{{phonex}}', '18888888888', $get); goto ra0Qx; Fn753: if (!(strpos($header[0], '301') || strpos($header[0], '302'))) { goto PQhpf; } goto oA70S; tqfqK: foreach ($customize as $x) { $post = str_replace('{{' . $x['attr'] . '}}', $x['value'], $post); a1E6U: } goto eQn67; E2pbd: $request_post = ihttp_post($url, $data); goto QQn0m; IR7Yk: $post = str_replace('{{datex}}', date('Y-m-d H:i'), $post); goto UvB4T; iqX2s: $data = array(); goto W5mnk; oD_Xf: $post = $sms['content']['post']; goto y5Q4E; HIzRQ: UcNhi: goto tyMbt; A0mzf: B5KXn: goto xVCIQ; tgxp1: if (!$sms) { goto dMXAs; } goto yy9Aa; II2yG: $get = json_decode($get, true); goto ERsVM; tyMbt: PQhpf: goto A8HVe; ra0Qx: $get = str_replace('{{addrx}}', '中国北京', $get); goto NYBUO; bh1mA: $get = str_replace('{{amount}}', '199元', $get); goto eM_Bj; xVCIQ: $request_get = ihttp_get($url); goto ha2of; y5Q4E: $header = get_headers($url . '&_xcdebug=1', 1); goto Fn753; UmyYr: FB3Qt: goto yInU3; Mj3TG: } public function doWebPage() { $page = array("status" => "1233"); } public function doWebOrderRefund() { goto ymijQ; r4zwg: exit; goto Hw29H; snGjM: jdbcN: goto R0QR4; qNbEq: $json = array("status" => -1, "msg" => "失败"); goto pkoYv; nKULj: $result = json_decode($result, true); goto GVcqz; sVll_: BML1g: goto AzNsh; Pjbcy: QnFEN: goto RfmKQ; qVoa3: $url = 'https://api.mch.weixin.qq.com/secapi/pay/refund'; goto t1nzV; Hw29H: i1qWa: goto MOmkV; rtBkz: $ch = curl_init(); goto utWFm; V7_U3: $cert = pdo_get('xc_beauty_config', array("uniacid" => $uniacid, "xkey" => "refund")); goto LvTg8; ZTO_P: if ($data['return_code'] == 'SUCCESS') { goto Xtmyl; } goto QfCIE; WJYKW: s6lRO: goto AOwmu; PaFPh: if ($data) { goto BML1g; } goto zlaUj; A5Gz1: curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false); goto JAnkW; MwTZY: if (!$config) { goto Y4ruL; } goto ErPxD; Kze8X: $request = pdo_update('xc_beauty_userinfo', array("money" => $money), array("status" => 1, "openid" => $order['openid'], "uniacid" => $uniacid)); goto GZPIi; XlZHS: $share_o_amount = round(floatval($userinfo['share_o_amount']) - floatval($share['amount']), 2); goto u9s0_; Rr5NV: exit; goto EzKDH; n3U3_: $transaction_id = $order['wx_out_trade_no']; goto m3_3_; kHXQy: $AppKey = ''; goto NER58; JAnkW: $data = curl_exec($ch); goto Uhs4F; AbzSr: curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 1); goto pbO_A; rk_eH: pdo_update('xc_beauty_userinfo', array("share_o_amount" => $share_o_amount, "share_empty" => $share_empty), array("status" => 1, "openid" => $order['openid'], "uniacid" => $uniacid)); goto gI6pG; pkoYv: echo json_encode($json); goto Jaus2; XhZ5s: exit; goto ETr06; Dxj24: if (fwrite($TxtRes, $StrConents)) { goto MJoPP; } goto MBxd9; EzKDH: goto EzAfA; goto sVll_; k08s7: curl_setopt($ch, CURLOPT_SSLCERT, $cert_file); goto vKelD; QFoJ9: if ($tiangong == 1) { goto s6lRO; } goto HulQ2; pciGP: $agent_id = ''; goto Ycar1; Tqavp: $cert['content'] = json_decode($cert['content'], true); goto Hwa7S; R0QR4: QZHuF: goto UV9cn; MQiH0: echo json_encode($json); goto cPCip; J7W0B: if ($data['result_code'] == 'SUCCESS') { goto pvkV6; } goto qZVwt; cYG2a: echo json_encode($json); goto aE5QS; P_1T0: exit; goto gbVnl; jE2LV: fclose($TxtRes); goto FAsrN; AkbmN: curl_setopt($ch, CURLOPT_POST, 1); goto DdzcI; h0Wj2: $key_file = '../addons/' . $_GPC['m'] . '/resource/' . rand(100000, 999999) . '.pem'; goto yXLQ8; D8WHU: unlink($key_file); goto PaFPh; rKOLf: echo json_encode($json); goto HUp_4; srMFr: $config = pdo_get('xc_beauty_config', array("xkey" => "web", "uniacid" => $uniacid)); goto MwTZY; u9s0_: $share_empty = round(floatval($userinfo['share_empty']) + floatval($share['amount'])); goto rk_eH; JLKLA: pvkV6: goto hVy_E; rg0nT: goto jdbcN; goto FjT3g; OULq5: $json = array("status" => -1, "msg" => $result['emsg']); goto rKOLf; ymijQ: global $_GPC, $_W; goto m1V3t; Ycar1: $user_id = ''; goto srMFr; woUrD: $url = 'https://api.teegon.com/router?method=teegon.agent.mfuser.get.pay.secret&app_key=' . $AppKey . '&client_secret=' . $AppSecret; goto ruSIZ; gX4oP: dWhev: goto HSsJW; EYIy7: ClYwf: goto ZThyw; Jiqo3: UR7lU: goto tWOxj; biABO: $share = pdo_get('xc_beauty_share', array("status" => 1, "uniacid" => $uniacid, "openid" => $order['openid'], "out_trade_no" => $order['out_trade_no'])); goto REmpv; a2kcO: cpC2f: goto IgT5s; tAmLh: $appid = $_W['account']['key']; goto n3U3_; iSPC1: if (!(floatval($order['canpay']) != 0)) { goto T2hKB; } goto Uhmzb; bpzY2: if ($order) { goto hdLd7; } goto j_zXd; buIqj: echo json_encode($json); goto exqLp; b5hox: $agent_id = $config['content']['agent_id']; goto IPfYN; QfCIE: $json = array("status" => -1, "msg" => "操作失败1"); goto buIqj; m8PHw: exit; goto S1u4b; Z0VYc: if (empty($_GPC['amount'])) { goto zVI18; } goto eUbYw; m6IJ_: if (!(($TxtRes = fopen($cert_file, 'w+')) === FALSE)) { goto cpC2f; } goto gWzdz; ZThyw: $request = pdo_update('xc_beauty_order', array("refund_status" => 1, "status" => 2), array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto laq4h; HUp_4: exit; goto tRTwR; xdcgq: goto cKkTB; goto qCLpb; gI6pG: pdo_update('xc_beauty_share', array("status" => 2), array("status" => 1, "uniacid" => $uniacid, "openid" => $order['openid'], "out_trade_no" => $order['out_trade_no'])); goto EYIy7; GZPIi: T2hKB: goto biABO; nrt9f: goto lPrqn; goto WJYKW; VDpSB: echo json_encode($json); goto m8PHw; LACZJ: $json = array("status" => -1, "msg" => "操作失败3"); goto MQiH0; Hwa7S: if (!empty($cert['content']['cert']) && !empty($cert['content']['key'])) { goto qhLfd; } goto LACZJ; BIq77: cKkTB: goto bpRiF; t1nzV: $ref = strtoupper(md5('appid=' . $appid . '&mch_id=' . $config['payment']['wechat']['mchid'] . '&nonce_str=123456' . '&out_refund_no=' . $transaction_id . '&out_trade_no=' . $transaction_id . '&refund_fee=' . $refund_fee . '&total_fee=' . $total_fee . '&key=' . $config['payment']['wechat']['signkey'])); goto a1c2X; HSsJW: EzAfA: goto xV2HL; Ld4xQ: echo json_encode($json); goto IRjsg; LvTg8: if (!($config && $cert)) { goto Ess3k; } goto Tqavp; NER58: $AppSecret = ''; goto pciGP; o1N0c: $data = xmlToArray($data); goto ZTO_P; GVcqz: if (!empty($result['result'])) { goto o05uh; } goto OULq5; HulQ2: $config = pdo_get('uni_settings', array("uniacid" => $uniacid)); goto V7_U3; FAsrN: exit; goto Xf61l; nhXVw: DX83F: goto woUrD; IArpI: curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false); goto A5Gz1; wiZs1: if (!(!empty($config['content']['tiangong']) && !empty($config['content']['AppKey']) && !empty($config['content']['AppSecret']))) { goto UR7lU; } goto jHUvV; G2rf0: $result = vpost($url, $data); goto nKULj; AzNsh: curl_close($ch); goto o1N0c; GO8gh: goto dWhev; goto vGEP8; fG2ZC: $tiangong = -1; goto kHXQy; fkLMD: kZMR9: goto hBgNk; CKCjI: exit; goto a2kcO; ruSIZ: $data = array("agent_id" => $agent_id, "user_id" => $user_id, "secret_type" => 1); goto iWoQE; bUQap: $result = json_decode($result, true); goto h53jI; S5mON: uPZOs: goto iSPC1; bh3Ji: if (!(floatval($order['wxpay']) != 0)) { goto kZMR9; } goto fG2ZC; vvMlI: goto QZHuF; goto nhXVw; IRjsg: exit; goto xdcgq; Jaus2: exit; goto vvMlI; Uhs4F: unlink($cert_file); goto D8WHU; RfmKQ: $json = array("status" => 1, "msg" => "操作成功"); goto W_tS7; HMmAH: curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); goto AbzSr; jbIgN: $json = array("status" => -1, "msg" => "操作失败2"); goto z5dVV; xcjNU: curl_setopt($ch, CURLOPT_SSLKEY, $key_file); goto AkbmN; a1c2X: $refund = array("appid" => $appid, "mch_id" => $config['payment']['wechat']['mchid'], "nonce_str" => "123456", "out_refund_no" => $transaction_id, "out_trade_no" => $transaction_id, "refund_fee" => $refund_fee, "total_fee" => $total_fee, "sign" => $ref); goto Yrfwt; AOwmu: if (!empty($order['charge_id']) && !empty($AppKey) && !empty($AppSecret)) { goto DX83F; } goto qNbEq; exqLp: exit; goto GO8gh; gWzdz: echo '创建可写文件：' . $cert_file . '失败'; goto CKCjI; ZWG3b: $cert_file = '../addons/' . $_GPC['m'] . '/resource/' . rand(100000, 999999) . '.pem'; goto m6IJ_; Mp64j: curl_setopt($ch, CURLOPT_HEADER, 0); goto HMmAH; DdzcI: curl_setopt($ch, CURLOPT_POSTFIELDS, $xml); goto IArpI; jHUvV: $tiangong = $config['content']['tiangong']; goto UL87K; REmpv: if (!$share) { goto ClYwf; } goto XlZHS; hVy_E: LPZnA: goto gX4oP; Uhmzb: $money = round(floatval($userinfo['money']) + floatval($order['canpay']), 2); goto Kze8X; vGEP8: Xtmyl: goto J7W0B; tWOxj: Y4ruL: goto QFoJ9; hBgNk: if (empty($order['score'])) { goto uPZOs; } goto tlvQF; ezgr9: curl_close($ch); goto jbIgN; h7ToO: if (empty($_GPC['amount'])) { goto bteIW; } goto uQxi9; iix2Z: $AppSecret = $config['content']['AppSecret']; goto b5hox; qCLpb: hdLd7: goto bpHcq; tlvQF: $score = $userinfo['score'] - $order['score']; goto NyE8S; m1V3t: $uniacid = $_W['uniacid']; goto zkYqg; Xf61l: MJoPP: goto mO8C1; zlaUj: $error = curl_errno($ch); goto ezgr9; eBkhE: zVI18: goto qVoa3; ErPxD: $config['content'] = json_decode($config['content'], true); goto wiZs1; q2d50: $StrConents = $cert['content']['key']; goto ByRfq; z5dVV: echo json_encode($json); goto Rr5NV; xV2HL: Vp_xC: goto bX7KY; MOmkV: fclose($TxtRes); goto xcjNU; h53jI: if (!empty($result['result'])) { goto fVtFK; } goto nDrR9; HFnTl: echo '创建可写文件：' . $key_file . '失败'; goto P_1T0; eUbYw: $refund_fee = floatval($_GPC['amount']) * 100; goto eBkhE; yXLQ8: if (!(($TxtRes = fopen($key_file, 'w+')) === FALSE)) { goto RsrDM; } goto HFnTl; NyE8S: pdo_update('xc_beauty_userinfo', array("score" => $score), array("status" => 1, "openid" => $order['openid'], "uniacid" => $uniacid)); goto S5mON; KbxNy: fclose($TxtRes); goto r4zwg; IPfYN: $user_id = $config['content']['user_id']; goto Jiqo3; MBxd9: echo '尝试向文件' . $cert_file . '写入' . $StrConents . '失败！'; goto jE2LV; IgT5s: $StrConents = $cert['content']['cert']; goto Dxj24; pbO_A: curl_setopt($ch, CURLOPT_SSLCERTTYPE, 'pem'); goto ZWG3b; bpHcq: $userinfo = pdo_get('xc_beauty_userinfo', array("status" => 1, "openid" => $order['openid'], "uniacid" => $uniacid)); goto bh3Ji; Yrfwt: $xml = arrayToXml($refund); goto rtBkz; UV9cn: lPrqn: goto fkLMD; vKelD: curl_setopt($ch, CURLOPT_SSLCERTTYPE, 'pem'); goto h0Wj2; FjT3g: fVtFK: goto rdTIP; UL87K: $AppKey = $config['content']['AppKey']; goto iix2Z; laq4h: if ($request) { goto QnFEN; } goto ng7rE; EID9s: $data = array("charge_id" => $order['charge_id'], "amount" => $order['wxpay']); goto h7ToO; m3_3_: $total_fee = floatval($order['wxpay']) * 100; goto t_OeM; tRTwR: o05uh: goto snGjM; utWFm: curl_setopt($ch, CURLOPT_URL, $url); goto Mp64j; zYGcj: echo '尝试向文件' . $key_file . '写入' . $StrConents . '失败！'; goto KbxNy; t_OeM: $refund_fee = floatval($order['wxpay']) * 100; goto Z0VYc; zbeqQ: goto KmIvI; goto Pjbcy; QNp1b: echo json_encode($json); goto WDg0Z; uQxi9: $data['amount'] = $_GPC['amount']; goto G5kRX; ETr06: KmIvI: goto BIq77; rdTIP: $url = 'https://api.teegon.com/router?method=teegon.payment.charge.refund&app_key=' . $result['result']['key'] . '&client_secret=' . $result['result']['secret']; goto EID9s; WDg0Z: exit; goto zbeqQ; mO8C1: fclose($TxtRes); goto k08s7; W_tS7: echo json_encode($json); goto XhZ5s; zkYqg: $order = pdo_get('xc_beauty_order', array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto bpzY2; nDrR9: $json = array("status" => -1, "msg" => "失败"); goto cYG2a; bX7KY: Ess3k: goto nrt9f; MY8KD: goto Vp_xC; goto xMASQ; gbVnl: RsrDM: goto q2d50; G5kRX: bteIW: goto G2rf0; qZVwt: $json = array("status" => -1, "msg" => $data['err_code_des']); goto VDpSB; j_zXd: $json = array("status" => -1, "msg" => "操作失败4"); goto Ld4xQ; aE5QS: exit; goto rg0nT; b1XHA: $config['payment'] = unserialize($config['payment']); goto tAmLh; cPCip: exit; goto MY8KD; S1u4b: goto LPZnA; goto JLKLA; ng7rE: $json = array("status" => -1, "msg" => "操作失败5"); goto QNp1b; xMASQ: qhLfd: goto b1XHA; ByRfq: if (fwrite($TxtRes, $StrConents)) { goto i1qWa; } goto zYGcj; iWoQE: $result = vpost($url, $data); goto bUQap; bpRiF: } function doMobileTGong() { goto Ps3tq; rp7gW: vWAbY: goto qJIZE; ur406: if ($order['order_type'] == 1 || $order['order_type'] == 3 || $order['order_type'] == 4) { goto sLEAT; } goto pbdqK; z98cN: NBwzK: goto iJdCn; XTWz8: rT1cy: goto gBobI; t1ePo: pdo_insert('xc_beauty_count', array("uniacid" => $uniacid, "plan_date" => date('Y-m'), "order" => 1, "amount" => $order['amount'], "store" => $order['store'])); goto B1c4k; uJp_J: BCMDR: goto dcPfB; ye1jt: $post = str_replace('{{webnamex}}', $config['content']['title'], $post); goto aP0Qk; pp1sx: goto irIEd; goto yUAFP; mbqbU: B_JJY: goto ZOfcr; ni11A: curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); goto ZDZ5L; CA4bY: Lhn6b: goto FsrPg; tPqYa: Yw1xs: goto j76_l; LaKPw: $money = round(floatval($money) + floatval($order['gift']), 2); goto nAmU9; Ohi2I: xu46S: goto LcerK; PNVmm: PIfh7: goto uS6WH; YnWu8: foreach ($card['content']['level'] as $card_l) { goto dShSS; dShSS: if (!(floatval($level_data['card_amount']) >= floatval($card_l['amount']))) { goto KoJfv; } goto lfbIs; vrZZT: $level_data['card_price'] = $card_l['price']; goto sHswB; sHswB: KoJfv: goto phGVf; lfbIs: $level_data['card_name'] = $card_l['name']; goto vrZZT; phGVf: K7Mwh: goto uhbst; uhbst: } goto GjEhF; lfCCT: $sms['content']['url'] = $header['Location'][count($header['Location']) - 1]; goto pvkuk; fwAvB: $tpl_value = '#webnamex#=' . $config['content']['title'] . '&#trade#=' . $order['out_trade_no'] . '&#amount#=' . $order['o_amount'] . '&#namex#=' . $order['userinfo']['name'] . '&#phonex#=' . $order['userinfo']['mobile'] . '&#datex#=' . $order['plan_date']; goto OylIb; lCRO5: goto OKW0W; goto VodP2; Ps3tq: $input = file_get_contents('php://input'); goto BFtAl; dGjxD: $share_condition['one_amount'] = null; goto sma3K; aRD7C: curl_close($ch); goto djJlT; M0QRF: NEsMR: goto d9isR; UXLVS: $userinfo = pdo_get('xc_beauty_userinfo', array("status" => 1, "openid" => $order['openid'])); goto ctalh; XWZJi: if (!($sms['content']['status'] == 1)) { goto w5ek1; } goto xJ9GR; bfjFu: ytOFd: goto riQHA; iJdCn: logging_run('input:' . json_encode($data)); goto bb2AV; eym2S: $send = new sms(); goto b9JkD; b71hT: $share_condition['one_amount'] = $share_config['one']; goto QNGnp; rYu6E: Tso69: goto K1u5k; sf0bV: pdo_update('xc_beauty_count', array("order" => $orders, "amount" => $amount), array("uniacid" => $uniacid, "plan_date" => date('Y-m'), "store" => $order['store'])); goto GmYww; yUAFP: l3R5w: goto YSAd6; ON_mu: $output = curl_exec($ch); goto aRD7C; Y3gFx: $print['content'] = json_decode($print['content'], true); goto OJd9I; MCPaG: if (!($share_config['level'] >= 3 && !empty($share_config['three']) && !empty($two['share']))) { goto oPEGE; } goto SdzSx; lt3Ja: R9vs0: goto NTK5P; s8Nif: if (!(!empty($order['store']) && $order['store'] != -1)) { goto je7uJ; } goto C1I7N; dwpZp: $group_data = array(); goto L4OlN; MakOD: if (empty($input)) { goto lYH5b; } goto tyBkg; qFd4c: if (empty($service['type'])) { goto SpJRt; } goto QBM3y; JJxWW: pdo_insert('xc_beauty_count', array("uniacid" => $uniacid, "plan_date" => date('Y-m'), "order" => 1, "amount" => $order['wxpay'], "store" => -1)); goto B6UuG; rB02z: pdo_update('xc_beauty_times_log', array("total" => $times_log_total), array("uniacid" => $uniacid, "id" => $times_log['id'])); goto sRIte; oGyYX: goto TKpyh; goto uJp_J; dHCjU: WfNnh: goto U3l5v; VsJrm: L0g_9: goto QID3O; CHpLN: if (empty($order['content'])) { goto OrYwe; } goto lsQ_U; ZDZ5L: curl_setopt($ch, CURLOPT_HEADER, 0); goto H04YZ; v9JEf: if (!($group_data['status'] == 1)) { goto jbMO2; } goto H9ge4; jytIG: $level_data = array(); goto e8VmT; KFwkW: curl_setopt($ch, CURLOPT_URL, $sms['content']['url']); goto ni11A; kpAUT: goto TVE2_; goto n2IqT; bgiUR: $content .= '总件数：' . $order['total'] . '\\r\\n'; goto Ue3kL; tRsdi: if (empty($order['coupon_id'])) { goto pyg2M; } goto Y3Cu7; fvXRE: $order['userinfo'] = json_decode($order['userinfo'], true); goto mtpDQ; SdzSx: $share_condition['three_openid'] = $two['share']; goto qp4iT; hki2D: if (empty($order['coupon_id'])) { goto Tso69; } goto cLoZq; slbGc: $result = vpost($url, $ttt); goto anTfu; uRq38: $group_data['team_total'] = $group['team_total'] + 1; goto IHJMk; geTgE: $userinfo = pdo_get('xc_beauty_userinfo', array("status" => 1, "openid" => $order['openid'])); goto t5CxU; R8hDM: $print = pdo_get('xc_beauty_config', array("xkey" => "print", "uniacid" => $uniacid)); goto On14a; SraOh: $result = json_decode($result, true); goto V2MqS; VFFCF: B080_: goto hki2D; I34AQ: if ($store_count) { goto MqamX; } goto t1ePo; Ejju2: curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); goto u0F6e; H9ge4: $list = pdo_getall('xc_beauty_order', array("status" => 1, "order_type" => 3, "group" => $order['group'])); goto ZySFC; Oiyay: pdo_insert('xc_beauty_count', array("uniacid" => $uniacid, "plan_date" => date('Y-m'), "order" => 1, "amount" => $order['amount'], "store" => -1)); goto pp1sx; sYZNs: pdo_update('xc_beauty_userinfo', $level_data, array("openid" => $order['openid'], "uniacid" => $uniacid)); goto d3J2Y; TOG7N: $amount = round(floatval($store_count['amount']) + floatval($order['amount']), 2); goto uLOjz; vrxJ6: if (!$request) { goto mcnrT; } goto cX3a1; uS6WH: $orders = $count['order'] + 1; goto lQ8u0; RzByI: if (!$content) { goto j1lvq; } goto D337g; tgDyh: $request = push($requestInfo, $requestUrl); goto sqD1P; nUkZ2: $score = null; goto GJMUS; PUMkq: $share_config = array("level" => 3, "type" => "", "one" => "", "two" => "", "three" => ""); goto TH6oZ; K1u5k: $request = pdo_update('xc_beauty_order', array("status" => 1, "wx_out_trade_no" => $data['out_trade_no']), array("id" => $order['id'], "uniacid" => $uniacid)); goto zTdzZ; ZgV43: if (!(strpos($header[0], '301') || strpos($header[0], '302'))) { goto xMXcc; } goto fZLoG; VodP2: s2yHY: goto mZm2B; liZ3M: header('Content-Type: text/plain; charset=utf-8'); goto rLxlo; Lo2ao: $error_code = $result['error_code']; goto CQ86m; cLAzs: if (!(is_array($post) && !empty($post))) { goto rT1cy; } goto piB99; xGAMu: YkwM6: goto M3b2L; Bvnpl: $share_condition['two_openid'] = $one['share']; goto MWMP7; M252L: MtVU2: goto ukZvK; ypsor: $url = 'https://api.weixin.qq.com/cgi-bin/message/wxopen/template/send?access_token=' . $token; goto pDnKn; yrErR: curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); goto onfu1; g1KhE: $post_data['page'] = 'xc_beauty/pages/base/base'; goto vHbu2; XLNcQ: drgys: goto VsJrm; MKHmQ: mLDMT: goto qFd4c; CQ86m: j1lvq: goto rLGJ0; saEXh: pdo_insert('xc_beauty_share', array("uniacid" => $uniacid, "openid" => $share_condition['three_openid'], "title" => "三级订单结算奖励", "out_trade_no" => $order['out_trade_no'], "amount" => $share_condition['three_amount'], "level" => 3, "status" => -1)); goto M0QRF; qOHSU: xMXcc: goto lyAaH; B6UuG: goto eWZum; goto PNVmm; lQ8u0: $amount = round(floatval($count['amount']) + floatval($order['wxpay']), 2); goto CRxxD; Vpw00: TVE2_: goto geTgE; zTdzZ: if (!$request) { goto mZpnB; } goto tVApz; FsrPg: $service_name = $service['name']; goto rdgG3; j8ObC: if (!($share_config['type'] == 2)) { goto IdkhV; } goto hkZkq; hJV39: $orderInfo .= '应付款：' . $order['amount'] . '<BR>'; goto e1VR_; mIzGM: CqGin: goto ylMlx; zSflc: if (!($print['content']['type'] == 2)) { goto b_ty3; } goto sdkdt; Vhy0x: logging_run('天工'); goto MakOD; anTfu: logging_run('result:' . $result); goto SraOh; c4K8p: pdo_update('xc_beauty_count', array("order" => $orders, "amount" => $amount), array("uniacid" => $uniacid, "plan_date" => date('Y-m'), "store" => -1)); goto haC1n; aKesm: if (!$card) { goto hVe1V; } goto WMCAJ; z67v2: pdo_update('xc_beauty_user_coupon', array("status" => 1), array("id" => $use_coupon['id'], "uniacid" => $uniacid)); goto rYu6E; N7qGw: $url_data = ''; goto edltx; aMju8: pdo_update('xc_beauty_user_coupon', array("status" => 1), array("id" => $use_coupon['id'], "uniacid" => $uniacid)); goto y07BH; On14a: if (!$print) { goto NS0np; } goto Y3gFx; YCjZf: goto gkmHy; goto bfjFu; sEG7K: bCpzF: goto R8hDM; t5CxU: if (!(floatval($order['canpay']) != 0)) { goto S3IOs; } goto YP5W7; lnQie: $get = json_decode($get, true); goto N7qGw; qJIZE: header('content-type:text/html;charset=utf-8'); goto aib5i; t6WOG: $count = pdo_get('xc_beauty_count', array("uniacid" => $uniacid, "plan_date" => date('Y-m'), "store" => -1)); goto dnVQl; qp4iT: if ($share_config['type'] == 1) { goto LWGLi; } goto j8ObC; MC__E: if ($count) { goto PIfh7; } goto JJxWW; rUQU0: dw8CT: goto hRxcI; og9EL: AmfkY: goto FnPBY; jY1ny: $post_data['template_id'] = $config['content']['template_id']; goto g1KhE; pvkuk: hsx1W: goto qOHSU; eE1Np: MxqPU: goto foPdo; QNGnp: l3BXU: goto htQfH; rMHHV: WlIfg: goto lTZmP; bXL89: lfFZB: goto qGUmk; gXiZV: if (!empty($order['userinfo']['address'])) { goto R9vs0; } goto qMU2K; VFD7X: $orderInfo .= '--------------------------------<BR>'; goto o0c_y; fOJeF: mZpnB: goto x7LDL; nAmU9: m9UR4: goto cHeRJ; fZLoG: if (is_array($header['Location'])) { goto VJF78; } goto Qf8Os; BZQAt: $post = str_replace('{{amount}}', $order['o_amount'] . '元', $post); goto hFfwc; DeM46: if (!($share_config['level'] >= 1 && !empty($share_config['one']) && !empty($userinfo['share']))) { goto MtVU2; } goto Yzt90; emzgP: if (empty($share['content']['level'])) { goto m8k37; } goto wv99V; yuHd5: $data = array(); goto GyrZ6; tHy9U: oPEGE: goto tSWL0; Dzv_S: if (!($card['content']['score_status'] == 1 && !empty($card['content']['score_attr']) && !empty($card['content']['score_value']) && $userinfo['card'] == 1)) { goto WfNnh; } goto VV70u; Ymakw: if (!empty($order['userinfo']['address'])) { goto MxqPU; } goto suBds; o0c_y: $orderInfo .= '服务项目：' . $service['name'] . '<BR>'; goto X5YQ3; FdTad: set_time_limit(0); goto liZ3M; gTuG6: if ($sms['content']['type'] == 2) { goto vWAbY; } goto nXOUX; HbISB: H1GbB: goto H1RDm; VOlyq: VJF78: goto lfCCT; nQ0GI: $share_condition['three_openid'] = null; goto gUEnO; kcdLp: if (empty($sms['content']['url'])) { goto HmcKr; } goto iWY0K; vrKIK: if (strpos($sms['content']['url'], '?') !== false) { goto s2yHY; } goto vRw8d; YSsrV: if ($count) { goto cckUB; } goto udKFf; nlkVO: if ($order['order_type'] == 1 || $order['order_type'] == 4) { goto ytOFd; } goto NM4OV; Gey07: foreach ($list as $l) { goto O_HQD; Al8GE: ETXas: goto Wn6eT; UzTQb: $orders = $count['order'] + 1; goto Ejruh; qzT82: $level_data['card_amount'] = round(floatval($userinfo['card_amount']) + floatval($l['o_amount']), 2); goto jjk9C; O_HQD: if (empty($l['score'])) { goto XhVVu; } goto Kzw4H; UqphD: pdo_insert('xc_beauty_share', array("uniacid" => $uniacid, "openid" => $l['three_openid'], "title" => "三级订单结算奖励", "out_trade_no" => $l['out_trade_no'], "amount" => $l['three_amount'], "level" => 3, "status" => -1)); goto PYC2I; IW1ge: goto QxC8k; goto orFMP; KCBoJ: if (!($card && $card['content']['level_status'] == 1 && $userinfo['card'] == 1)) { goto ETXas; } goto dR2RQ; AyG7d: pdo_insert('xc_beauty_share', array("uniacid" => $uniacid, "openid" => $l['one_openid'], "title" => "一级订单结算奖励", "out_trade_no" => $l['out_trade_no'], "amount" => $l['one_amount'], "level" => 1, "status" => -1)); goto ryUei; Wn6eT: if (empty($l['one_openid'])) { goto TvDTQ; } goto AyG7d; IQMfk: VhojS: goto aUH8Y; PAl1X: HRiEj: goto n60On; Ejruh: $amount = round(floatval($count['amount']) + floatval($l['wxpay']), 2); goto fvXbT; oViWu: $count = pdo_get('xc_beauty_count', array("uniacid" => $uniacid, "plan_date" => date('Y-m'), "store" => -1)); goto vngW8; rDW4j: pdo_update('xc_beauty_userinfo', $level_data, array("openid" => $l['openid'], "uniacid" => $uniacid)); goto Al8GE; xzLHy: $store_count = pdo_get('xc_beauty_count', array("uniacid" => $uniacid, "plan_date" => date('Y-m'), "store" => $l['store'])); goto WjJFa; dR2RQ: $level_data = array(); goto qzT82; C0Gqt: foreach ($card['content']['level'] as $card_l) { goto vBWuz; sMElL: $level_data['card_name'] = $card_l['name']; goto NKr2S; Nj864: ulP9X: goto JYpt4; deMFu: MnqvC: goto Nj864; NKr2S: $level_data['card_price'] = $card_l['price']; goto deMFu; vBWuz: if (!(floatval($level_data['card_amount']) >= floatval($card_l['amount']))) { goto MnqvC; } goto sMElL; JYpt4: } goto IQMfk; fvXbT: pdo_update('xc_beauty_count', array("order" => $orders, "amount" => $amount), array("uniacid" => $uniacid, "plan_date" => date('Y-m'), "store" => -1)); goto ouTg8; Kzw4H: $userinfo = pdo_get('xc_beauty_userinfo', array("status" => 1, "openid" => $l['openid'])); goto jL0BD; Btamt: pdo_update('xc_beauty_count', array("order" => $orders, "amount" => $amount), array("uniacid" => $uniacid, "plan_date" => date('Y-m'), "store" => $l['store'])); goto ETDYz; ryUei: TvDTQ: goto XRGzP; oY4Xw: Z_i5K: goto U6VeW; PYC2I: hMZC9: goto oViWu; RYAAZ: pdo_update('xc_beauty_userinfo', array("score" => $user_score), array("status" => 1, "openid" => $l['openid'], "uniacid" => $uniacid)); goto TWuEX; HeUFI: pdo_insert('xc_beauty_share', array("uniacid" => $uniacid, "openid" => $l['two_openid'], "title" => "二级订单结算奖励", "out_trade_no" => $l['out_trade_no'], "amount" => $l['two_amount'], "level" => 2, "status" => -1)); goto oY4Xw; XkSU0: pdo_insert('xc_beauty_count', array("uniacid" => $uniacid, "plan_date" => date('Y-m'), "order" => 1, "amount" => $l['wxpay'], "store" => $l['store'])); goto Wl6iu; TWuEX: pdo_insert('xc_beauty_score', array("uniacid" => $uniacid, "openid" => $l['openid'], "status" => 1, "score" => $l['score'], "over" => $user_score, "title" => "消费")); goto Fvqck; orFMP: XpQzv: goto UzTQb; fDTxg: $orders = $store_count['order'] + 1; goto XLIzc; XRGzP: if (empty($l['two_openid'])) { goto Z_i5K; } goto HeUFI; ouTg8: QxC8k: goto jS2Kt; Wl6iu: goto jxVNi; goto OWd71; n60On: p2JHZ: goto bCHHW; WjJFa: if ($store_count) { goto egJJN; } goto XkSU0; jjk9C: if (!(!empty($card['content']['level']) && is_array($card['content']['level']))) { goto WnWUt; } goto C0Gqt; Mdgkl: pdo_insert('xc_beauty_count', array("uniacid" => $uniacid, "plan_date" => date('Y-m'), "order" => 1, "amount" => $l['wxpay'], "store" => -1)); goto IW1ge; aUH8Y: WnWUt: goto rDW4j; vngW8: if ($count) { goto XpQzv; } goto Mdgkl; jL0BD: $user_score = $userinfo['score'] + $l['score']; goto RYAAZ; Fvqck: XhVVu: goto KCBoJ; XLIzc: $amount = round(floatval($store_count['amount']) + floatval($l['wxpay']), 2); goto Btamt; U6VeW: if (empty($l['three_openid'])) { goto hMZC9; } goto UqphD; jS2Kt: if (!(!empty($l['store']) && $l['store'] != -1)) { goto HRiEj; } goto xzLHy; OWd71: egJJN: goto fDTxg; ETDYz: jxVNi: goto PAl1X; bCHHW: } goto iyNQK; C1I7N: $store_count = pdo_get('xc_beauty_count', array("uniacid" => $uniacid, "plan_date" => date('Y-m'), "store" => $order['store'])); goto Lf1IU; XTQ1h: $orderInfo .= '手机：' . $order['userinfo']['mobile'] . '<BR>'; goto KAZJG; TH6oZ: $share_status = 1; goto A5Gwj; AyeSQ: $ch = curl_init(); goto buscc; NVyGM: $content .= '日期：' . $order['plan_date'] . '\\r\\n'; goto wG_5h; dQF4y: $orderInfo .= '小程序名：' . $config['content']['title'] . '<BR>'; goto VFD7X; e1VR_: $orderInfo .= '实付款：' . $order['o_amount'] . '<BR>'; goto NnSDw; ZySFC: if (!$list) { goto XgQ0T; } goto Gey07; Q8MZs: tbAbf: goto Sx0k1; l2GhB: $data = array(); goto RIphl; ottOH: goto Nl2wC; goto xkYG3; Dfkn_: B6P2B: goto Y172z; aib5i: $sendUrl = 'http://v.juhe.cn/sms/send'; goto fwAvB; jDjyw: $service_data = array(); goto VRoFd; NMsT5: $post = $sms['content']['post']; goto cLAzs; Ly0cW: $orders = $store_count['order'] + 1; goto TOG7N; wO269: oK8NH: goto ykL7k; kbNjW: $orderInfo .= '地址：无<BR>'; goto miXoO; MWMP7: if ($share_config['type'] == 1) { goto uqsFk; } goto i328I; P5vls: if (!empty($order['userinfo']['address'])) { goto cWjro; } goto AKb7F; S7bht: $ch = curl_init(); goto EIsrO; qAvfC: define('STIME', time()); goto beejv; piWBL: curl_close($ch); goto rMHHV; aP0Qk: $post = str_replace('{{trade}}', $order['out_trade_no'], $post); goto BZQAt; Z3Jfs: sLEAT: goto MeHd5; j5h42: m8k37: goto E3lah; lTZmP: HmcKr: goto C91qO; zk0CW: $group = pdo_getall('xc_beauty_group', array("uniacid" => $uniacid, "openid" => $order['openid']), array(), '', 'id DESC'); goto b007a; po_c6: QyOMX: goto fvXRE; Qf8Os: $sms['content']['url'] = $header['Location']; goto KwrQC; paIm2: $share_condition['one_openid'] = null; goto dGjxD; K1QWY: OrYwe: goto SAPQv; ctalh: if (!(floatval($order['canpay']) != 0)) { goto B080_; } goto EgN75; yE007: if (!($share_config['level'] >= 2 && !empty($share_config['two']) && !empty($one['share']))) { goto HOFF7; } goto Bvnpl; iV1FR: $amount = round(floatval($count['amount']) + floatval($order['wxpay']), 2); goto ytfK5; udKFf: pdo_insert('xc_beauty_count', array("uniacid" => $uniacid, "plan_date" => date('Y-m'), "order" => 1, "amount" => $order['wxpay'])); goto nY8pa; ujcZ4: curl_close($ch); goto XTWz8; o5508: if (!$sms) { goto bCpzF; } goto b9AKy; y9U80: $post = str_replace('{{phonex}}', $order['userinfo']['mobile'], $post); goto Ymakw; dnVQl: if ($count) { goto l3R5w; } goto Oiyay; A2ZQj: if (!$order) { goto ODKv_; } goto rY6zB; d5O5P: $post_data['data'] = $postdata; goto ypsor; MmKmj: if (empty($share_condition['one_openid'])) { goto R7QcY; } goto Dtgsp; vRw8d: $sms['content']['url'] = $sms['content']['url'] . '?' . $url_data; goto lCRO5; haC1n: irIEd: goto Snpo5; PgBC2: CFPP9: goto K6Zyw; Dtgsp: pdo_insert('xc_beauty_share', array("uniacid" => $uniacid, "openid" => $share_condition['one_openid'], "title" => "一级订单结算奖励", "out_trade_no" => $order['out_trade_no'], "amount" => $share_condition['one_amount'], "level" => 1, "status" => -1)); goto evHa4; BP6Xl: $templateParam['addrx'] = '无'; goto XIoSj; dtjI7: $get = str_replace('{{datex}}', $order['plan_date'], $get); goto lnQie; cwcAV: if (!(!empty($card['content']['level']) && is_array($card['content']['level']))) { goto QdZHr; } goto y7xAl; sRIte: jploq: goto nSMx9; WMCAJ: $card['content'] = json_decode($card['content'], true); goto Dzv_S; KgTzH: S75hd: goto Ap9yo; phtM4: $orders = $count['order'] + 1; goto iV1FR; Y3Cu7: $use_coupon = pdo_get('xc_beauty_user_coupon', array("status" => -1, "openid" => $order['openid'], "uniacid" => $uniacid, "cid" => $order['coupon_id'])); goto aMju8; JinlG: $count = pdo_get('xc_beauty_count', array("uniacid" => $uniacid, "plan_date" => date('Y-m'))); goto YSsrV; DV6Wy: $share_config['one'] = $service['level_one']; goto nMbvR; ZNEm2: mcnrT: goto e5XE_; ZY5yv: pdo_update('xc_beauty_count', array("order" => $orders, "amount" => $amount), array("uniacid" => $uniacid, "plan_date" => date('Y-m'), "store" => $order['store'])); goto iegC7; u0F6e: curl_setopt($ch, CURLOPT_POST, 1); goto wcCLD; qCtr0: $group_data['team'] = json_decode($group['team'], true); goto DjzE8; j76_l: $one = pdo_get('xc_beauty_userinfo', array("status" => 1, "openid" => $userinfo['share'], "uniacid" => $uniacid)); goto yE007; suBds: $post = str_replace('{{addrx}}', '无', $post); goto l1xL0; DjzE8: $group_data['team'][] = $order['openid']; goto Luj59; q52hm: $share_condition['score'] = $score; goto CAPCt; ROsYz: aSGFd: goto BSA5t; vjGZt: n4wsv: goto NVyGM; oNn5K: require_once dirname(__FILE__) . '/resource/WeChat.class.php'; goto lmr9H; CEYox: $level_data['card_amount'] = round(floatval($userinfo['card_amount']) + floatval($order['o_amount']), 2); goto oaSBI; pyNY1: if (!$config) { goto XOtvt; } goto hH7n3; hkZkq: $share_condition['three_amount'] = $share_config['three']; goto ESG5R; l4agj: xRYks: goto KwPoU; e37CQ: $share_config['two'] = $share['content']['level_two']; goto Lgxiq; rXv9m: pdo_update('xc_beauty_userinfo', $level_data, array("openid" => $order['openid'], "uniacid" => $uniacid)); goto rX6Cy; OJd9I: if (!($print['content']['status'] == 1)) { goto tIfPa; } goto QTc7P; CmdWV: $service_list = pdo_getall('xc_cake_service', array("uniacid" => $uniacid)); goto jDjyw; x5rtb: F0KQW: goto G99jE; LSGyl: $ttt = array("charge_id" => $data['charge_id']); goto slbGc; VY59T: sPi0Z: goto tHy9U; QrHJN: curl_setopt($ch, CURLOPT_POSTFIELDS, $data); goto IypJu; qMU2K: $content .= '地址：无\\r\\n'; goto dTxzb; tiWaH: $times_log_total = intval($times_log['total']) + 1; goto rB02z; hfdzh: $content = juhecurl($sendUrl, $smsConf, 1); goto RzByI; nSMx9: pNyMn: goto EPuUU; Xh20k: xkJmZ: goto G82It; kAYXt: if (!$share) { goto mLDMT; } goto Yb67K; G99jE: goto eSFZZ; goto PgBC2; b2Nvj: pdo_insert('xc_beauty_score', array("uniacid" => $uniacid, "openid" => $order['openid'], "status" => 1, "score" => $score, "over" => $user_score, "title" => "消费")); goto po_c6; zJeWQ: if (!$request) { goto CqGin; } goto D7A2D; e5XE_: AKSJK: goto T5Dw2; mwqpe: NS0np: goto gGtky; b007a: pdo_update('xc_beauty_order', array("group" => $group[0]['id']), array("id" => $order['id'], "uniacid" => $uniacid)); goto x5rtb; b9JkD: $result = $send->sendSms($sms['content']['AccessKeyId'], $sms['content']['AccessKeySecret'], $sms['content']['sign'], $sms['content']['code'], $sms['content']['mobile'], $templateParam); goto wHW1w; oAswT: $get = str_replace('{{namex}}', $order['userinfo']['name'], $get); goto PGuP6; ukZvK: iewfy: goto VMsH_; Ry_qN: if (!$request) { goto drgys; } goto nlkVO; dVY_n: $content .= '姓名：' . $order['userinfo']['name'] . '\\r\\n'; goto s6G3D; n2IqT: MdlDZ: goto juEME; U7vDY: EpmLa: goto S7bht; u_MSp: pYJvw: goto mIzGM; ytfK5: pdo_update('xc_beauty_count', array("order" => $orders, "amount" => $amount), array("uniacid" => $uniacid, "plan_date" => date('Y-m'))); goto uVM8v; FlxrF: pdo_update('xc_beauty_userinfo', array("score" => $user_score), array("status" => 1, "openid" => $order['openid'], "uniacid" => $uniacid)); goto b2Nvj; wcJKA: vw140: goto YzvFD; D68lS: goto sPi0Z; goto OlRqN; ha7dS: pdo_insert('xc_beauty_share', array("uniacid" => $uniacid, "openid" => $share_condition['two_openid'], "title" => "二级订单结算奖励", "out_trade_no" => $order['out_trade_no'], "amount" => $share_condition['two_amount'], "level" => 2, "status" => -1)); goto xGAMu; UTIEF: $amount = round(floatval($store_count['amount']) + floatval($order['wxpay']), 2); goto sf0bV; LcerK: $smsConf = array("key" => $sms['content']['key'], "mobile" => $sms['content']['mobile'], "tpl_id" => $sms['content']['tpl_id'], "tpl_value" => $tpl_value); goto hfdzh; chS51: $group_data['team'] = array($order['openid']); goto ottOH; SAPQv: $request = wp_print(SN, $orderInfo, 1); goto UBh3o; YP5W7: $moeny = round(floatval($userinfo['money']) - floatval($order['canpay']), 2); goto Ca_mp; JmEKo: if (empty($score)) { goto QyOMX; } goto aJKRp; Ca_mp: pdo_update('xc_beauty_userinfo', array("money" => $moeny), array("status" => 1, "openid" => $order['openid'])); goto WLbvI; B33BT: $orderInfo .= '总件数：' . $order['total'] . '<BR>'; goto hJV39; l9ZbT: if (!is_array($customize)) { goto lfFZB; } goto nlEgs; vcK24: if (empty($config['content']['template_id'])) { goto T4Cg_; } goto oNn5K; mD461: $two = pdo_get('xc_beauty_userinfo', array("status" => 1, "openid" => $one['share'], "uniacid" => $uniacid)); goto MCPaG; Y172z: $post = str_replace('{{datex}}', $order['plan_date'], $post); goto R2mpK; hFfwc: $post = str_replace('{{namex}}', $order['userinfo']['name'], $post); goto y9U80; GjEhF: iDAqd: goto xbW5m; PGuP6: $get = str_replace('{{phonex}}', $order['userinfo']['mobile'], $get); goto P5vls; vtM8d: $content .= '实付款：' . $order['o_amount'] . '\\r\\n'; goto dVY_n; PdyOD: goto ZuEhi; goto lX1l_; xJ9GR: if ($sms['content']['type'] == 1) { goto ysUDf; } goto gTuG6; sqD1P: oqJLd: goto e17Wu; wfnQ0: $token = $wechat->checkAuth('wx71d04d820fea94b1', '2afdad649b8a5bcd61dd1837b424d7cf'); goto rQs5M; uK9_B: $store_count = pdo_get('xc_beauty_count', array("uniacid" => $uniacid, "plan_date" => date('Y-m'), "store" => $order['amount'])); goto I34AQ; uJ998: $order = pdo_get('xc_beauty_order', array("out_trade_no" => $data['order_no'], "status" => -1)); goto ZN8Mb; ESG5R: IdkhV: goto D68lS; GyrZ6: foreach ($data_dd as &$dddd) { goto kPDPB; ebalS: $data[$dddd[0]] = $dddd[1]; goto l3XwZ; l3XwZ: rmrrq: goto ygC2S; kPDPB: $dddd = explode('=', $dddd); goto ebalS; ygC2S: } goto z98cN; QID3O: echo 'SUCCESS'; goto mbqbU; miXoO: goto aSGFd; goto rUQU0; e17Wu: tIfPa: goto mwqpe; rY6zB: $url = 'https://api.teegon.com/router?method=teegon.payment.charge.info&app_key=MRpZFBi&client_secret=6A8mDpirh2bhyjwG7GSC'; goto LSGyl; ThxH5: $share_config['type'] = $share['content']['type']; goto pyaqj; u4eDg: pg8oY: goto emzgP; uVM8v: JVVDS: goto aFwbE; XYTYB: w5ek1: goto sEG7K; bb2AV: logging_run('666:' . $data['order_no']); goto uJ998; iNLmD: SMIs6: goto dxz0g; ykL7k: QdZHr: goto sYZNs; xkYG3: iRjkE: goto qCtr0; OlRqN: LWGLi: goto NdatB; cX3a1: pdo_update('xc_beauty_service', array("group_total" => $service['group_total'] + $order['total']), array("id" => $order['pid'], "uniacid" => $uniacid)); goto v9JEf; mtpDQ: $config = pdo_get('xc_beauty_config', array("xkey" => "web", "uniacid" => $uniacid)); goto pyNY1; Lf1IU: if ($store_count) { goto H1GbB; } goto YHbBn; Z591z: $share_condition['two_amount'] = null; goto nQ0GI; nlEgs: foreach ($customize as $x) { $get = str_replace('{{' . $x['attr'] . '}}', $x['value'], $get); cfqGy: } goto xwuAU; U7Y1E: $service = pdo_get('xc_beauty_service', array("uniacid" => $uniacid, "id" => $order['pid'])); goto kpAUT; G2hWf: require_once '../addons/xc_beauty/resource/sms/sendSms.php'; goto FdTad; GNKs0: $money = floatval($userinfo['money']) + floatval($order['amount']); goto w73uT; djJlT: T4Cg_: goto sJXzt; C292N: if (!(!empty($share_config['type']) && $share_status == 1)) { goto iewfy; } goto DeM46; l8t53: Os3Hv: goto MKHmQ; dcPfB: $userinfo = pdo_get('xc_beauty_userinfo', array("status" => 1, "uniacid" => $uniacid, "openid" => $order['openid'])); goto GNKs0; pyaqj: $share_config['one'] = $share['content']['level_one']; goto e37CQ; Ap9yo: goto y1Wze; goto zS_xl; KwrQC: goto hsx1W; goto VOlyq; A5Gwj: $share = pdo_get('xc_beauty_config', array("xkey" => "share", "uniacid" => $uniacid)); goto kAYXt; edltx: foreach ($get as $x3) { goto dYqhq; FZXJA: $url_data = $url_data . '&' . urlencode($x3['attr']) . '=' . urlencode($x3['value']); goto lDm5p; lDm5p: goto jfVwq; goto QXDLM; RuS8U: jfVwq: goto qXXFf; qXXFf: Zb95I: goto O8Fzl; QXDLM: lM3af: goto LSWwV; dYqhq: if (empty($url_data)) { goto lM3af; } goto FZXJA; LSWwV: $url_data = urlencode($x3['attr']) . '=' . urlencode($x3['value']); goto RuS8U; O8Fzl: } goto l1Xiv; IypJu: $output = curl_exec($ch); goto ujcZ4; k6WNg: MqamX: goto Ly0cW; CfKyW: foreach ($customize as $x) { $post = str_replace('{{' . $x['attr'] . '}}', $x['value'], $post); gnm7s: } goto l4agj; cMGu5: goto L0g_9; goto Z3Jfs; Z455i: pdo_update('xc_beauty_service', array("group_total" => $service['group_total'] + $order['total']), array("id" => $order['pid'], "uniacid" => $uniacid)); goto zk0CW; NM4OV: if (!($order['order_type'] == 3)) { goto z5Fn4; } goto djUS8; eV4Zq: goto CFKGq; goto rp7gW; OxvCg: $tpl_value = $tpl_value . '&#addrx#=' . $order['userinfo']['address']; goto Ohi2I; s006N: if (!empty($order['userinfo']['address'])) { goto xkJmZ; } goto BP6Xl; lmr9H: $wechat = new Wechat(); goto wfnQ0; jO3dX: je7uJ: goto fOJeF; PBIkY: kCgWz: goto eym2S; Yzt90: $share_condition['one_openid'] = $userinfo['share']; goto uo_ky; qGUmk: $get = str_replace('{{webnamex}}', $config['content']['title'], $get); goto b3aHu; TwnIf: XN5ed: goto tiWaH; NTK5P: $content .= '地址：' . $order['userinfo']['address'] . '\\r\\n'; goto vjGZt; cHeRJ: $request = pdo_update('xc_beauty_order', array("status" => 1, "money" => $money, "wx_out_trade_no" => $data['out_trade_no']), array("id" => $order['id'], "uniacid" => $uniacid)); goto zJeWQ; rdgG3: $time = time(); goto PwCkm; onfu1: curl_setopt($ch, CURLOPT_POST, 1); goto QrHJN; qJIx8: if (!(is_array($get) && !empty($get))) { goto WlIfg; } goto AkQGJ; Eg92x: foreach ($service_list as $sl) { $service_data[$sl['id']] = $sl; kaAqq: } goto Q8MZs; nMbvR: $share_config['two'] = $service['level_two']; goto YTCmk; wHW1w: ZuEhi: goto XYTYB; RmD7C: kMovu: goto u_MSp; ZN8Mb: logging_run('order:' . json_encode($order)); goto A2ZQj; cxRCq: jbMO2: goto ZNEm2; o3nhH: define('PORT', 80); goto uMuZe; pHgrg: $sms = pdo_get('xc_beauty_config', array("uniacid" => $uniacid, "xkey" => "sms")); goto o5508; AYVXI: load()->func('logging'); goto Vhy0x; A4pRq: $share_status = $share['content']['status']; goto u4eDg; y7xAl: foreach ($card['content']['level'] as $card_l) { goto uu7ei; uu7ei: if (!(floatval($level_data['card_amount']) >= floatval($card_l['amount']))) { goto hfqaO; } goto seXYq; SAhh2: $level_data['card_price'] = $card_l['price']; goto Qfytc; seXYq: $level_data['card_name'] = $card_l['name']; goto SAhh2; Qfytc: hfqaO: goto e0MGM; e0MGM: fQ5n3: goto uh7vw; uh7vw: } goto wO269; vHbu2: $post_data['form_id'] = $order['form_id']; goto d5O5P; ISPgG: if ($store_count) { goto SMIs6; } goto Ez5I7; renrL: $times_log = pdo_get('xc_beauty_times_log', array("uniacid" => $uniacid, "plan_date" => $order['plan_date'], "member" => $order['member'], "createtime >=" => date('Y') . '-01-01 00:00:00')); goto M2zuj; oaSBI: if (!(!empty($card['content']['level']) && is_array($card['content']['level']))) { goto siGOq; } goto YnWu8; buscc: curl_setopt($ch, CURLOPT_URL, $url); goto Ejju2; fWynM: $store_count = pdo_get('xc_beauty_count', array("uniacid" => $uniacid, "plan_date" => date('Y-m'), "store" => $order['store'])); goto ISPgG; dTxzb: goto n4wsv; goto lt3Ja; uMuZe: define('PATH', '/Api/Open/'); goto qAvfC; M3b2L: if (empty($share_condition['three_openid'])) { goto NEsMR; } goto saEXh; g1m00: bMI1H: goto OxvCg; KwPoU: XSlEd: goto ye1jt; MeHd5: if ($order['order_type'] == 4) { goto MdlDZ; } goto U7Y1E; Snpo5: if (!(!empty($order['store']) && $order['store'] != -1)) { goto pYJvw; } goto uK9_B; nuh1Q: $uniacid = $order['uniacid']; goto ur406; ORePB: $get = str_replace('{{amount}}', $order['o_amount'] . '元', $get); goto oAswT; I3I3V: $share_condition['status'] = 1; goto q52hm; AKb7F: $get = str_replace('{{addrx}}', '无', $get); goto dmx_L; BFtAl: $isxml = true; goto dY_2B; riQHA: if (!($card && $card['content']['level_status'] == 1 && $userinfo['card'] == 1)) { goto K7f_2; } goto P8sLW; BlEkt: cWjro: goto mf24P; AJcIE: $group_data['status'] = 1; goto og9EL; GmYww: XUbw9: goto NtK8B; d3J2Y: SmdQE: goto d_VhS; YHbBn: pdo_insert('xc_beauty_count', array("uniacid" => $uniacid, "plan_date" => date('Y-m'), "order" => 1, "amount" => $order['wxpay'], "store" => $order['store'])); goto QWD8R; CAPCt: $share_condition['wx_out_trade_no'] = $order['out_trade_no']; goto paIm2; XIoSj: goto kCgWz; goto Xh20k; uo_ky: if ($share_config['type'] == 1) { goto vw140; } goto cDQfP; FnPBY: $request = pdo_update('xc_beauty_group', $group_data, array("id" => $order['group'], "uniacid" => $uniacid)); goto vrxJ6; b9AKy: $sms['content'] = json_decode($sms['content'], true); goto XWZJi; X5YQ3: $orderInfo .= '--------------------------------<BR>'; goto B33BT; bDq39: $ch = curl_init(); goto KFwkW; iyNQK: Wcm7w: goto lcsHm; Ro7I0: goto XUbw9; goto iNLmD; YSAd6: $orders = $count['order'] + 1; goto C28nP; LLIPX: $requestUrl = 'http://open.10ss.net:8888'; goto EPYbK; NWb5z: define('IP', 'api.feieyun.cn'); goto o3nhH; foPdo: $post = str_replace('{{addrx}}', $order['userinfo']['address'], $post); goto Dfkn_; w1AHI: $group_data['team'] = json_encode($group_data['team']); goto cNfBS; OylIb: if (!empty($order['userinfo']['address'])) { goto bMI1H; } goto qhECy; gUEnO: $share_condition['three_amount'] = null; goto C292N; VMsH_: $request = pdo_update('xc_beauty_order', $share_condition, array("id" => $order['id'], "uniacid" => $uniacid)); goto Ry_qN; vTqly: $content .= '小程序名：' . $config['content']['title'] . '\\r\\n'; goto bgiUR; WLbvI: S3IOs: goto tRsdi; dxz0g: $orders = $store_count['order'] + 1; goto UTIEF; s6G3D: $content .= '手机：' . $order['userinfo']['mobile'] . '\\r\\n'; goto gXiZV; QBM3y: $share_config['type'] = $service['type']; goto DV6Wy; oslfy: $orderInfo = '<CB>订单</CB><BR>'; goto sricf; Yb67K: $share['content'] = json_decode($share['content'], true); goto mu7QY; qhECy: $tpl_value = $tpl_value . '&#addrx#=无'; goto BmMAQ; ZxwnA: y1Wze: goto mD461; wcCLD: curl_setopt($ch, CURLOPT_POSTFIELDS, $post_data); goto ON_mu; juEME: $service = pdo_get('xc_beauty_store_service', array("uniacid" => $uniacid, "id" => $order['pid'])); goto Vpw00; tyBkg: $data_dd = explode('&', $input); goto yuHd5; ixNIG: SpJRt: goto I3I3V; d_dJ1: pdo_update('xc_beauty_userinfo', array("money" => $moeny), array("status" => 1, "openid" => $order['openid'])); goto VFFCF; D7A2D: pdo_update('xc_beauty_userinfo', array("money" => $money), array("status" => 1, "uniacid" => $uniacid, "openid" => $order['openid'])); goto t6WOG; y07BH: pyg2M: goto nUkZ2; TMuyz: koc4p: goto dtjI7; wG_5h: $sign = strtoupper(md5($print['content']['apikey'] . 'machine_code' . $print['content']['machine_code'] . 'partner' . $print['content']['partner'] . 'time' . $time . $print['content']['msign'])); goto LLIPX; sma3K: $share_condition['two_openid'] = null; goto Z591z; lcsHm: XgQ0T: goto cxRCq; dY_2B: $get = ''; goto AYVXI; cNfBS: $group_data['status'] = -1; goto uRq38; d_VhS: $count = pdo_get('xc_beauty_count', array("uniacid" => $uniacid, "plan_date" => date('Y-m'), "store" => -1)); goto MC__E; P8sLW: $level_data = array(); goto CEYox; k88QB: if (!($share_status == 1)) { goto HF4By; } goto MmKmj; VRoFd: if (!$service_list) { goto bHHrK; } goto Eg92x; H1RDm: $orders = $store_count['order'] + 1; goto GQRHg; GQRHg: $amount = round(floatval($store_count['amount']) + floatval($order['wxpay']), 2); goto ZY5yv; E3lah: if (empty($share['content']['type'])) { goto Os3Hv; } goto ThxH5; QWD8R: goto nr6Mn; goto HbISB; htQfH: goto Yw1xs; goto wcJKA; BSA5t: $orderInfo .= '日期：' . $order['plan_date'] . '<BR>'; goto CHpLN; C91qO: HQBY0: goto eV4Zq; sV3H7: define('SN', $print['content']['sn']); goto NWb5z; EMG8m: OKW0W: goto bDq39; C28nP: $amount = round(floatval($count['amount']) + floatval($order['amount']), 2); goto c4K8p; L4OlN: if (!empty($group['team'])) { goto iRjkE; } goto chS51; hH7n3: $config['content'] = json_decode($config['content'], true); goto vcK24; gGtky: gkmHy: goto XLNcQ; WuHi1: $request = pdo_insert('xc_beauty_group', array("uniacid" => $uniacid, "openid" => $order['openid'], "pid" => $order['pid'], "failtime" => $service['group_limit'], "total" => $service['group_number'], "team_total" => 1)); goto k1jEL; IHJMk: if (!($group_data['team_total'] == $group['total'])) { goto AmfkY; } goto AJcIE; VV70u: $score = intval(floatval($order['o_amount']) / floatval($card['content']['score_attr'])) * $card['content']['score_value']; goto dHCjU; xwuAU: jS28F: goto bXL89; sdkdt: include dirname(__FILE__) . '/resource/HttpClient.class.php'; goto Kxs06; iegC7: nr6Mn: goto jO3dX; rX6Cy: K7f_2: goto JinlG; rLGJ0: CFKGq: goto PdyOD; l1Xiv: VAdoz: goto vrKIK; oab1W: if (!$group) { goto AKSJK; } goto dwpZp; AkQGJ: $get = json_encode($get); goto l9ZbT; pDnKn: $post_data = json_encode($post_data); goto AyeSQ; Dvqr9: if (empty($order['member'])) { goto pNyMn; } goto renrL; K6Zyw: $group = pdo_get('xc_beauty_group', array("id" => $order['group'], "uniacid" => $uniacid)); goto oab1W; w73uT: if (empty($order['gift'])) { goto m9UR4; } goto LaKPw; RIphl: foreach ($post as $x2) { $data[$x2['attr']] = $x2['value']; TAP0Q: } goto U7vDY; Luj59: Nl2wC: goto w1AHI; JQ1Ni: if (!is_array($customize)) { goto XSlEd; } goto CfKyW; cLoZq: $use_coupon = pdo_get('xc_beauty_user_coupon', array("status" => -1, "openid" => $order['openid'], "uniacid" => $uniacid, "cid" => $order['coupon_id'])); goto z67v2; Jvvzx: $post_data['touser'] = $order['openid']; goto jY1ny; Ez5I7: pdo_insert('xc_beauty_count', array("uniacid" => $uniacid, "plan_date" => date('Y-m'), "order" => 1, "amount" => $order['wxpay'], "store" => $order['store'])); goto Ro7I0; sJXzt: XOtvt: goto pHgrg; b3aHu: $get = str_replace('{{trade}}', $order['out_trade_no'], $get); goto ORePB; l1xL0: goto B6P2B; goto eE1Np; KAZJG: if (!empty($order['userinfo']['address'])) { goto dw8CT; } goto kbNjW; U3l5v: hVe1V: goto PUMkq; dESt4: $content .= '应付款：' . $order['amount'] . '\\r\\n'; goto vtM8d; uLOjz: pdo_update('xc_beauty_count', array("order" => $orders, "amount" => $amount), array("uniacid" => $uniacid, "plan_date" => date('Y-m'), "store" => $order['store'])); goto RmD7C; jKwaP: goto oqJLd; goto CA4bY; tSWL0: HOFF7: goto M252L; YTCmk: $share_config['three'] = $service['level_three']; goto ixNIG; xSjdj: $share_condition['two_amount'] = $share_config['two']; goto KgTzH; Jwj2e: goto jploq; goto TwnIf; BmMAQ: goto xu46S; goto g1m00; UBh3o: b_ty3: goto jKwaP; piB99: $post = json_encode($post); goto JQ1Ni; cDQfP: if (!($share_config['type'] == 2)) { goto l3BXU; } goto b71hT; NtK8B: pFKy0: goto k88QB; wv99V: $share_config['level'] = $share['content']['level']; goto j5h42; Ue3kL: $content .= '商品：' . $service_name . '\\r\\n'; goto dESt4; Cl6tK: lYH5b: goto VNLmc; QTc7P: if ($print['content']['type'] == 1) { goto Lhn6b; } goto zSflc; Sx0k1: bHHrK: goto oslfy; CRxxD: pdo_update('xc_beauty_count', array("order" => $orders, "amount" => $amount), array("uniacid" => $uniacid, "plan_date" => date('Y-m'), "store" => -1)); goto G4I5y; T5Dw2: eSFZZ: goto Dvqr9; x7LDL: xGsC0: goto oGyYX; EIsrO: curl_setopt($ch, CURLOPT_URL, $sms['content']['url']); goto yrErR; zS_xl: uqsFk: goto S8Vc4; YzvFD: $share_condition['one_amount'] = round(floatval($order['o_amount']) * floatval($share_config['one']) * 0.01, 2); goto tPqYa; EPYbK: $requestAll = ["partner" => $print['content']['partner'], "machine_code" => $print['content']['machine_code'], "time" => $time, "content" => $content, "sign" => $sign]; goto sg5p5; mf24P: $get = str_replace('{{addrx}}', $order['userinfo']['address'], $get); goto TMuyz; ZOfcr: ODKv_: goto BiKvI; a2w6h: if (!($order['order_type'] == 5)) { goto xGsC0; } goto UXLVS; Lgxiq: $share_config['three'] = $share['content']['level_three']; goto l8t53; EgN75: $moeny = round(floatval($userinfo['money']) - floatval($order['canpay']), 2); goto d_dJ1; V2MqS: if (!(!empty($result['result']) && $result['result']['paid'])) { goto B_JJY; } goto nuh1Q; Ey9jD: $content .= '订单号：' . $order['out_trade_no'] . '\\r\\n'; goto vTqly; lyAaH: $customize = $sms['content']['customize']; goto NMsT5; iWY0K: $header = get_headers($sms['content']['url'] . '&xcdubuge=1', 1); goto ZgV43; G82It: $templateParam['addrx'] = $order['userinfo']['address']; goto PBIkY; lX1l_: ysUDf: goto G2hWf; nY8pa: goto JVVDS; goto PWV13; NnSDw: $orderInfo .= '姓名：' . $order['userinfo']['name'] . '<BR>'; goto XTQ1h; mZm2B: $sms['content']['url'] = $sms['content']['url'] . $url_data; goto EMG8m; ylMlx: TKpyh: goto cMGu5; tVApz: $card = pdo_get('xc_beauty_config', array("xkey" => "card", "uniacid" => $uniacid)); goto n3uLB; djUS8: if (!empty($order['group'])) { goto CFPP9; } goto WuHi1; D337g: $result = json_decode($content, true); goto Lo2ao; e8VmT: $level_data['card_amount'] = round(floatval($userinfo['card_amount']) + floatval($order['o_amount']), 2); goto cwcAV; rLxlo: $templateParam = array("webnamex" => $config['content']['title'], "trade" => $order['out_trade_no'], "amount" => $order['o_amount'], "namex" => $order['userinfo']['name'], "phonex" => $order['userinfo']['mobile'], "datex" => $order['plan_date']); goto s006N; BiKvI: echo 'SUCCESS'; goto Cl6tK; beejv: define('SIG', sha1(USER . UKEY . STIME)); goto CmdWV; lsQ_U: $orderInfo .= '备注：' . $order['content'] . '<BR>'; goto K1QWY; evHa4: R7QcY: goto i55Sp; sg5p5: $requestInfo = http_build_query($requestAll); goto tgDyh; G4I5y: eWZum: goto s8Nif; S8Vc4: $share_condition['two_amount'] = round(floatval($order['o_amount']) * floatval($share_config['two']) * 0.01, 2); goto ZxwnA; n3uLB: if (!($card && $card['content']['level_status'] == 1 && $userinfo['card'] == 1)) { goto SmdQE; } goto jytIG; aJKRp: $user_score = $userinfo['score'] + $score; goto FlxrF; pbdqK: if ($order['order_type'] == 2) { goto BCMDR; } goto a2w6h; gBobI: $get = $sms['content']['get']; goto qJIx8; R2mpK: $post = json_decode($post, true); goto l2GhB; NdatB: $share_condition['three_amount'] = round(floatval($order['o_amount']) * floatval($share_config['three']) * 0.01, 2); goto VY59T; PWV13: cckUB: goto phtM4; mu7QY: if (empty($share['content']['status'])) { goto pg8oY; } goto A4pRq; Kxs06: define('USER', $print['content']['user']); goto XgqiX; k1jEL: if (!$request) { goto F0KQW; } goto Z455i; i328I: if (!($share_config['type'] == 2)) { goto S75hd; } goto xSjdj; rQs5M: $postdata = array("keyword1" => array("value" => $order['userinfo']['name']), "keyword2" => array("value" => $order['userinfo']['mobile']), "keyword3" => array("value" => $service['name']), "keyword4" => array("value" => date('Y-m-d'))); goto Jvvzx; hRxcI: $orderInfo .= '地址：' . $order['userinfo']['address'] . '<BR>'; goto ROsYz; sricf: $orderInfo .= '订单号：' . $order['out_trade_no'] . '<BR>'; goto dQF4y; PwCkm: $content = ''; goto Ey9jD; GJMUS: $card = pdo_get('xc_beauty_config', array("xkey" => "card", "uniacid" => $uniacid)); goto aKesm; aFwbE: if (!(!empty($order['store']) && $order['store'] != -1)) { goto pFKy0; } goto fWynM; xbW5m: siGOq: goto rXv9m; d9isR: HF4By: goto JmEKo; H04YZ: $output = curl_exec($ch); goto piWBL; nXOUX: if (!($sms['content']['type'] == 3)) { goto HQBY0; } goto kcdLp; XgqiX: define('UKEY', $print['content']['ukey']); goto sV3H7; EPuUU: z5Fn4: goto YCjZf; B1c4k: goto kMovu; goto k6WNg; i55Sp: if (empty($share_condition['two_openid'])) { goto YkwM6; } goto ha7dS; dmx_L: goto koc4p; goto BlEkt; oI4P7: pdo_insert('xc_beauty_times_log', array("uniacid" => $uniacid, "member" => $order['member'], "plan_date" => $order['plan_date'], "total" => 1)); goto Jwj2e; M2zuj: if ($times_log) { goto XN5ed; } goto oI4P7; VNLmc: } public function doWebWxPay() { goto jTWTw; Cwlax: goto voaIM; goto Tn5Y3; ztqfD: $user_IP = $user_IP ? $user_IP : $_SERVER['REMOTE_ADDR']; goto B2G4N; RB3qM: $arr['openid'] = $order['openid']; goto c9u3g; TKRQr: $arr = array(); goto W3ZMh; hWv5c: $json = array("status" => -1, "msg" => "查询不到订单"); goto e2sTx; OYWBs: exit; goto uenh7; mpo7R: oQElI: goto cxrNQ; Tn5Y3: i1_98: goto Noqe4; pIOuU: $arr['amount'] = floatval($order['amount']) * 100; goto q8jID; k9D9w: exit; goto B4G7z; WGzjp: if ($data['return_code'] == 'SUCCESS') { goto wNkdf; } goto pi3aV; BD8L2: dpSSw: goto O7DTs; yvCsF: curl_setopt($ch, CURLOPT_URL, $url); goto RWYyr; KsVFD: exit; goto Sltzj; npxI5: exit; goto QuGI6; dkkIb: echo '尝试向文件' . $cert_file . '写入' . $StrConents . '失败！'; goto cXyX3; KwzcB: lEExb: goto U_z8F; A5fNr: H9PHh: goto Pe6n_; akWsy: if ($request) { goto pclTj; } goto XYtXt; c9u3g: $arr['check_name'] = 'NO_CHECK'; goto pIOuU; WAudu: echo '创建可写文件：' . $key_file . '失败'; goto npxI5; BIgs5: curl_setopt($ch, CURLOPT_POST, 1); goto mG33U; q7sfS: $mch_id = $config['payment']['wechat']['mchid']; goto TKRQr; iQjns: unlink($cert_file); goto UwyIp; rzIE6: $request = pdo_update('xc_beauty_withdraw', array("status" => 1, "wx_out_trade_no" => $data['payment_no']), array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto akWsy; wYdTd: if (!(($TxtRes = fopen($cert_file, 'w+')) === FALSE)) { goto sh30D; } goto sC2NN; xA24V: fclose($TxtRes); goto fjm4a; Jofnq: eVZXS: goto xA24V; hNi8O: wNkdf: goto OjxHH; zuysR: echo '尝试向文件' . $key_file . '写入' . $StrConents . '失败！'; goto d39p2; kjTUn: SKM2q: goto EdO2g; z_2Mn: exit; goto Cwlax; sC2NN: echo '创建可写文件：' . $cert_file . '失败'; goto KsVFD; mG33U: curl_setopt($ch, CURLOPT_POSTFIELDS, $xml); goto jdr2N; koPKE: $xml = arrayToXml($arr); goto hSqHT; DptQ8: curl_setopt($ch, CURLOPT_SSLCERTTYPE, 'pem'); goto zWDNe; WVAdI: goto lEExb; goto kjTUn; A2YEy: curl_setopt($ch, CURLOPT_SSLCERT, $cert_file); goto DptQ8; uenh7: goto ctwFM; goto A5fNr; iUa3c: $json = array("status" => 1, "msg" => "提现成功"); goto U_3cj; yyAM_: $data = xmlToArray($data); goto WGzjp; LHA9G: foreach ($arr as $k => $v) { $str .= $k . '=' . $v . '&'; gmRjE: } goto aNUQz; YoH0r: echo json_encode($json); goto yPbLG; oqL2p: $str = ''; goto LHA9G; Pe6n_: $config['payment'] = unserialize($config['payment']); goto I8HvR; QuGI6: v_SNz: goto x1TvK; d39p2: fclose($TxtRes); goto SjbNm; qmo81: exit; goto vOLD7; tddYN: curl_setopt($ch, CURLOPT_SSLCERTTYPE, 'pem'); goto Oh09M; UQ2pd: $order = pdo_get('xc_beauty_withdraw', array("id" => $_GPC['id'], "uniacid" => $uniacid)); goto vRUSK; mBEZB: curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); goto Bpq1l; dTL6G: echo json_encode($json); goto S2o14; cXyX3: fclose($TxtRes); goto dQz59; qBjcE: N34b7: goto KwzcB; IkJHR: $str .= 'key=' . $config['payment']['wechat']['signkey']; goto iM_y1; OjxHH: if ($data['result_code'] == 'SUCCESS') { goto b2XF4; } goto C2qgG; zWDNe: $key_file = IA_ROOT . '/addons/' . $_GPC['m'] . '/resource/' . rand(100000, 999999) . '.pem'; goto ceKCJ; bFMvk: echo json_encode($json); goto z_2Mn; TrDIp: $arr['partner_trade_no'] = $order['out_trade_no']; goto RB3qM; PQgJ_: $json = array("status" => -1, "msg" => $error); goto bFMvk; I7w90: if ($config && $cert) { goto lS0ne; } goto bf3xQ; k63Xa: $user_IP = $_SERVER['HTTP_VIA'] ? $_SERVER['HTTP_X_FORWARDED_FOR'] : $_SERVER['REMOTE_ADDR']; goto ztqfD; EdO2g: $config = pdo_get('uni_settings', array("uniacid" => $uniacid)); goto UiCxi; UiCxi: $cert = pdo_get('xc_beauty_config', array("uniacid" => $uniacid, "xkey" => "refund")); goto I7w90; jdr2N: curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false); goto TWhRL; UwyIp: unlink($key_file); goto Vssf2; lO1ld: echo json_encode($json); goto k9D9w; DTGEv: pclTj: goto iUa3c; S2o14: exit; goto MHBiA; OlUUh: $json = array("status" => -1, "msg" => "证书未上传"); goto HVaZT; HVaZT: echo json_encode($json); goto OYWBs; jTWTw: global $_GPC, $_W; goto GmMsq; W3ZMh: $arr['mch_appid'] = $appid; goto qjIY6; ceKCJ: if (!(($TxtRes = fopen($key_file, 'w+')) === FALSE)) { goto v_SNz; } goto WAudu; TWhRL: curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false); goto SAshH; iM_y1: $arr['sign'] = md5($str); goto koPKE; xR59j: $StrConents = $cert['content']['cert']; goto fi4ZK; cxrNQ: fclose($TxtRes); goto A2YEy; vOLD7: goto dpSSw; goto p0z5n; SjbNm: exit; goto Jofnq; Oh09M: $cert_file = IA_ROOT . '/addons/' . $_GPC['m'] . '/resource/' . rand(100000, 999999) . '.pem'; goto wYdTd; Sltzj: sh30D: goto xR59j; aNUQz: WRJmR: goto IkJHR; SAshH: $data = curl_exec($ch); goto iQjns; CFN1H: lS0ne: goto EyM_5; I8HvR: $appid = $_W['account']['key']; goto q7sfS; yPbLG: exit; goto tDRkq; bf3xQ: $json = array("status" => -1, "msg" => "证书未配置"); goto dTL6G; w63I_: exit; goto SEA0X; fi4ZK: if (fwrite($TxtRes, $StrConents)) { goto oQElI; } goto dkkIb; S00sN: ksort($arr); goto oqL2p; dQz59: exit; goto mpo7R; Vssf2: if ($data) { goto i1_98; } goto qdOKH; M5h4j: if (!empty($cert['content']['cert']) && !empty($cert['content']['key'])) { goto H9PHh; } goto OlUUh; pi3aV: $json = array("status" => -1, "msg" => $data['return_msg']); goto lO1ld; xWBS6: $url = 'https://api.mch.weixin.qq.com/mmpaymkttransfers/promotion/transfers'; goto S00sN; gwMnB: ctwFM: goto qBjcE; tDRkq: goto BA_6J; goto DTGEv; qjIY6: $arr['mchid'] = $mch_id; goto C6EAl; x1TvK: $StrConents = $cert['content']['key']; goto L0YNd; GmMsq: $uniacid = $_W['uniacid']; goto UQ2pd; U_3cj: echo json_encode($json); goto w63I_; C6EAl: $arr['nonce_str'] = '123456'; goto TrDIp; qdOKH: $error = curl_errno($ch); goto CiP7E; EyM_5: $cert['content'] = json_decode($cert['content'], true); goto M5h4j; CiP7E: curl_close($ch); goto PQgJ_; zQa3M: exit; goto WVAdI; B4G7z: goto kbYaT; goto hNi8O; C2qgG: $json = array("status" => -1, "msg" => $data['err_code'] . '：' . $data['err_code_des']); goto oK3Fr; vRUSK: if ($order) { goto SKM2q; } goto hWv5c; RWYyr: curl_setopt($ch, CURLOPT_HEADER, 0); goto mBEZB; e1yZV: $arr['desc'] = $desc; goto k63Xa; O7DTs: kbYaT: goto cQ7Vf; fjm4a: curl_setopt($ch, CURLOPT_SSLKEY, $key_file); goto BIgs5; SEA0X: BA_6J: goto BD8L2; B2G4N: $arr['spbill_create_ip'] = $user_IP; goto xWBS6; L0YNd: if (fwrite($TxtRes, $StrConents)) { goto eVZXS; } goto zuysR; p0z5n: b2XF4: goto rzIE6; XYtXt: $json = array("status" => -1, "msg" => "提现成功，数据写入失败"); goto YoH0r; hSqHT: $ch = curl_init(); goto yvCsF; oK3Fr: echo json_encode($json); goto qmo81; MHBiA: goto N34b7; goto CFN1H; cQ7Vf: voaIM: goto gwMnB; Bpq1l: curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 1); goto tddYN; e2sTx: echo json_encode($json); goto zQa3M; Noqe4: curl_close($ch); goto yyAM_; q8jID: $desc = '提现'; goto e1yZV; U_z8F: } public function doWebUpSql() { include_once '../addons/xc_beauty/upsql.php'; upsql(); } public function doMobileGroupRefund() { goto XBpPV; T6iRW: t464d: goto t71Dy; n9BVs: foreach ($group as &$g) { goto eIIxg; qx3YL: curl_close($ch); goto Fu0N5; Fu1nd: fclose($TxtRes); goto I350U; XK5ls: $config['content'] = json_decode($config['content'], true); goto xx5hm; zIjQD: curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); goto tDVWj; L0CDE: curl_setopt($ch, CURLOPT_POSTFIELDS, $xml); goto Obxrs; i1TkE: jZIvl: goto glbfZ; YQQ4U: $user_id = $config['content']['user_id']; goto zZ8gm; zowam: EwkZO: goto jYMWa; Y6UmF: if (!(($TxtRes = fopen($key_file, 'w+')) === FALSE)) { goto eBzd9; } goto iZTOs; wfNE8: $data = array("charge_id" => $order['charge_id'], "amount" => $order['wxpay']); goto yZ0RZ; c32dX: $config = pdo_get('xc_beauty_config', array("xkey" => "web", "uniacid" => $uniacid)); goto wk5H3; eKDbg: curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false); goto IdW1M; ZEKT5: JXlki: goto r7xEH; Rb2iy: tcuZt: goto G_oHy; ieGPK: $result = json_decode($result, true); goto w4zyB; JOL2k: if ($tiangong == 1 && !empty($AppKey) && !empty($AppSecret)) { goto aALxg; } goto iVVoC; HNJWC: $refund_fee = floatval($order['wxpay']) * 100; goto yZfh5; cEAlV: goto d3zeB; goto DfDmz; F5Tjn: $post_data['data'] = $postdata; goto LX1Qt; zZ8gm: EZR5_: goto s0TL0; uCTuu: unlink($cert_file); goto CGNLC; cdjkv: curl_setopt($ch, CURLOPT_POSTFIELDS, $post_data); goto LcbuB; pgKaF: if ($data['return_code'] == 'SUCCESS') { goto hgjM3; } goto cEAlV; vXeBS: vNOGO: goto DYG0I; glbfZ: fclose($TxtRes); goto Dgtnp; fQjkd: $can_list = 1; goto xXD04; iencN: goto kxwUW; goto zowam; U5D61: KSuRd: goto nBlCg; fOY0x: foreach ($g['team'] as $gg) { goto qhd9G; nqUfn: $ch = curl_init(); goto Mdtly; RnLIA: HAp1t: goto affPr; u619Z: $ref = strtoupper(md5('appid=' . $appid . '&mch_id=' . $config['payment']['wechat']['mchid'] . '&nonce_str=123456' . '&out_refund_no=' . $transaction_id . '&out_trade_no=' . $transaction_id . '&refund_fee=' . $refund_fee . '&total_fee=' . $total_fee . '&key=' . $config['payment']['wechat']['signkey'])); goto X4VIW; IM5lN: curl_setopt($ch, CURLOPT_SSLCERT, $cert_file); goto xAQuR; KSQjs: zWuF3: goto aNJRN; S92TF: $url = 'https://api.weixin.qq.com/cgi-bin/message/wxopen/template/send?access_token=' . $token; goto LScOx; bWqKi: if (!(!empty($cert['content']['cert']) && !empty($cert['content']['key']))) { goto yuuq3; } goto qYstl; Piryo: if (!($config && $cert)) { goto jFppa; } goto mk3Bz; EEdpU: echo '创建可写文件：' . $key_file . '失败'; goto c8MpF; DRpTv: curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false); goto inj74; cZUVX: KdQYI: goto tYwSh; nE4ZK: jFppa: goto qcy8s; qcy8s: goto sZmZt; goto S4NZQ; inped: PgEck: goto XQ8M6; U9qy4: exit; goto vb7c_; kwiXw: curl_setopt($ch, CURLOPT_SSLCERTTYPE, 'pem'); goto JftmY; Pwadh: goto kVznL; goto WpNQw; WWkpP: if ($tiangong == 1 && !empty($AppKey) && !empty($AppSecret)) { goto nMVaD; } goto WcIf_; Mdtly: curl_setopt($ch, CURLOPT_URL, $url); goto Ak3TM; jjy7j: $transaction_id = $order['wx_out_trade_no']; goto Y_zjx; G68Qc: $result = vpost($url, $data); goto QNzfM; NNTlX: if ($group_refund == 1) { goto HAp1t; } goto o8GJW; S4NZQ: nMVaD: goto MRQN3; r907g: if (!$config) { goto vb45I; } goto A2V5k; wSvDN: if (!($can_list == 1)) { goto LCGUy; } goto M_DVT; vb7c_: goto tgSNC; goto wmY5H; HnM4E: exit; goto J7Edn; DEKyG: $output = curl_exec($ch); goto iZ1fU; tf18W: exit; goto Pwadh; KtUso: z122A: goto wSvDN; Q00es: if (!empty($result['result'])) { goto Z4JYu; } goto UmEqg; l9K88: $data = xmlToArray($data); goto FvG9S; pRAjo: curl_setopt($ch, CURLOPT_SSLKEY, $key_file); goto VcdRt; kUytc: $can_list = 1; goto pvwyR; YT_nw: curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); goto zrwBt; Q2uZm: sZmZt: goto KtUso; mVt90: yuuq3: goto nE4ZK; P19Ud: $user_id = ''; goto tM0ZZ; O3t9L: $data = array("charge_id" => $order['charge_id'], "amount" => $order['wxpay']); goto G68Qc; RHnYX: pdo_update('xc_beauty_order', array("refund_status" => -1, "status" => 2), array("id" => $order['id'], "uniacid" => $uniacid)); goto f6rWj; J7Edn: CdcuF: goto w5hB4; WBdu6: echo '尝试向文件' . $cert_file . '写入' . $StrConents . '失败！'; goto kxgDh; uNSfJ: goto z122A; goto eTTMI; IoUA5: $service = pdo_get('xc_beauty_service', array("id" => $order['pid'])); goto Q7d6t; iUs6x: $AppKey = ''; goto Nzgm2; pGSh6: $token = $wechat->checkAuth($_W['account']['key'], $_W['account']['secret']); goto IoUA5; IXUzd: echo '尝试向文件' . $key_file . '写入' . $StrConents . '失败！'; goto xH_Li; AYMsD: curl_setopt($ch, CURLOPT_POSTFIELDS, $post_data); goto DEKyG; Ak3TM: curl_setopt($ch, CURLOPT_HEADER, 0); goto koDsZ; o8GJW: if (!($group_refund == 2)) { goto Ql7MM; } goto DZJ01; Ayazl: HwBYZ: goto I7yoV; z750Y: $url = 'https://api.mch.weixin.qq.com/secapi/pay/refund'; goto u619Z; WPLda: $agent_id = ''; goto P19Ud; jzmDg: $userinfo = pdo_get('xc_beauty_userinfo', array("status" => 1, "openid" => $order['openid'], "uniacid" => $uniacid)); goto NGUxY; aNJRN: $sql = 'UPDATE ' . tablename('xc_beauty_service') . ' SET group_stock=group_stock+:group_stock WHERE uniacid=:uniacid AND id=:id AND group_stock>=0'; goto cCN8O; Y3owF: $post_data['touser'] = $order['openid']; goto orhGQ; tF3Q5: w1ugX: goto sF72e; Y_zjx: $total_fee = floatval($order['wxpay']) * 100; goto XlSht; lvTYm: exit; goto vK_Vj; mk3Bz: $cert['content'] = json_decode($cert['content'], true); goto bWqKi; orhGQ: $post_data['template_id'] = $config['content']['group_fail']; goto qW_PZ; f6rWj: exit; goto b69aB; Nzgm2: $AppSecret = ''; goto WPLda; v9W9c: if (fwrite($TxtRes, $StrConents)) { goto hU3bd; } goto IXUzd; ZepBE: curl_setopt($ch, CURLOPT_URL, $url); goto DRpTv; zrwBt: curl_setopt($ch, CURLOPT_POST, 1); goto AYMsD; qW_PZ: $post_data['page'] = 'xc_beauty/pages/base/base'; goto xunnP; pvwyR: WYHHQ: goto j9LIf; cCN8O: pdo_query($sql, array(":group_stock" => $order['total'], ":uniacid" => $uniacid, ":id" => $order['pid'])); goto LuLaT; gMrHB: zothd: goto UqZKn; inj74: curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false); goto YT_nw; qhd9G: $order = pdo_get('xc_beauty_order', array("status" => 1, "uniacid" => $uniacid, "group" => $g['id'], "openid" => $gg)); goto DKBh_; IKfF0: if (!$config) { goto zWuF3; } goto xKABP; i6Vu1: $result = json_decode($result, true); goto OGHHL; X6Kg1: $tiangong = $config['content']['tiangong']; goto N3umD; x3_cA: $error = curl_errno($ch); goto djpA2; goLTQ: curl_close($ch); goto l9K88; To3SD: if (fwrite($TxtRes, $StrConents)) { goto w1ugX; } goto WBdu6; itg15: D3x_R: goto KSQjs; sMMWI: $data = array("agent_id" => $agent_id, "user_id" => $user_id, "secret_type" => 1); goto QVmkL; YyOJi: $key_file = '../addons/' . $_GPC['m'] . '/resource/' . rand(100000, 999999) . '.pem'; goto F8sYC; NGUxY: $money = round(floatval($userinfo['money']) + floatval($order['canpay']), 2); goto n8eYZ; sF72e: fclose($TxtRes); goto IM5lN; Q3uac: echo '创建可写文件：' . $cert_file . '失败'; goto HnM4E; JftmY: $cert_file = '../addons/' . $_GPC['m'] . '/resource/' . rand(100000, 999999) . '.pem'; goto qaZFi; UUcX3: kVznL: goto fXsU5; eTTMI: k4sio: goto mbBrN; VcdRt: curl_setopt($ch, CURLOPT_POST, 1); goto aEY7P; sz_57: $user_id = $config['content']['user_id']; goto Ayazl; FvG9S: if ($data['return_code'] == 'SUCCESS') { goto KC0j2; } goto RzMtl; Mah0Q: if (!($data['result_code'] == 'SUCCESS')) { goto WYHHQ; } goto kUytc; uojyO: g8LE7: goto goLTQ; xH_Li: fclose($TxtRes); goto lvTYm; olxXJ: $can_list = 1; goto uNSfJ; c8MpF: exit; goto inped; UmEqg: pdo_update('xc_beauty_order', array("refund_status" => -1, "status" => 2), array("id" => $order['id'], "uniacid" => $uniacid)); goto RotVp; tFjJa: $appid = $_W['account']['key']; goto jjy7j; UqZKn: $config = pdo_get('xc_beauty_config', array("xkey" => "web", "uniacid" => $uniacid)); goto IKfF0; KS5Zp: nJwO6: goto mVt90; affPr: pdo_update('xc_beauty_order', array("refund_status" => -1, "status" => 2), array("id" => $order['id'], "uniacid" => $uniacid)); goto gMrHB; koDsZ: curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); goto w40CE; LuLaT: m5gmA: goto hQFtS; RzMtl: pdo_update('xc_beauty_order', array("refund_status" => -1, "status" => 2), array("id" => $order['id'], "uniacid" => $uniacid)); goto U9qy4; lHYMR: $xml = arrayToXml($refund); goto nqUfn; CDHd4: unlink($cert_file); goto YvpBt; A2V5k: $config['content'] = json_decode($config['content'], true); goto MDKq3; r2IN7: $wechat = new Wechat(); goto pGSh6; PMV0a: pdo_update('xc_beauty_order', array("refund_status" => 1, "status" => 2), array("id" => $order['id'], "uniacid" => $uniacid)); goto yyUyg; MDKq3: if (!(!empty($config['content']['tiangong']) && !empty($config['content']['AppKey']) && !empty($config['content']['AppSecret']))) { goto HwBYZ; } goto X6Kg1; ByE7k: $ch = curl_init(); goto ZepBE; WpNQw: BO1jU: goto cGltc; mbBrN: $tiangong = -1; goto iUs6x; sBEyu: require_once IA_ROOT . '/addons/xc_beauty/resource/WeChat.class.php'; goto r2IN7; K1KDi: pdo_update('xc_beauty_order', array("refund_status" => -1, "status" => 2), array("id" => $order['id'], "uniacid" => $uniacid)); goto tf18W; qYstl: $config['payment'] = unserialize($config['payment']); goto tFjJa; Qn4WS: $post_data['data'] = $postdata; goto S92TF; QVmkL: $result = vpost($url, $data); goto i6Vu1; wmY5H: KC0j2: goto Mah0Q; aEY7P: curl_setopt($ch, CURLOPT_POSTFIELDS, $xml); goto U3Ssm; N3umD: $AppKey = $config['content']['AppKey']; goto uR5bs; RotVp: exit; goto UQAm7; kxgDh: fclose($TxtRes); goto EwpW0; I2EH0: fclose($TxtRes); goto pRAjo; b69aB: goto nJwO6; goto uojyO; qaZFi: if (!(($TxtRes = fopen($cert_file, 'w+')) === FALSE)) { goto CdcuF; } goto Q3uac; UQAm7: Z4JYu: goto UUcX3; r33Hd: goto zothd; goto RnLIA; QNzfM: $result = json_decode($result, true); goto Q00es; cGltc: $url = 'https://api.teegon.com/router?method=teegon.payment.charge.refund&app_key=' . $result['result']['key'] . '&client_secret=' . $result['result']['secret']; goto O3t9L; tYwSh: LCGUy: goto PMV0a; DKBh_: if (!$order) { goto m5gmA; } goto NNTlX; Q7d6t: $postdata = array("keyword1" => array("value" => $order['out_trade_no']), "keyword2" => array("value" => $order['amount']), "keyword3" => array("value" => $service['name']), "keyword4" => array("value" => "人数不足")); goto Y3owF; EwpW0: exit; goto tF3Q5; XQ8M6: $StrConents = $cert['content']['key']; goto v9W9c; n8eYZ: $request = pdo_update('xc_beauty_userinfo', array("money" => $money), array("status" => 1, "openid" => $order['openid'], "uniacid" => $uniacid)); goto cZUVX; fXsU5: zx8TJ: goto Q2uZm; xKABP: $config['content'] = json_decode($config['content'], true); goto ICvpN; djpA2: curl_close($ch); goto RHnYX; xunnP: $post_data['form_id'] = $order['form_id']; goto Qn4WS; XlSht: $refund_fee = floatval($order['wxpay']) * 100; goto z750Y; iZ1fU: curl_close($ch); goto itg15; WDhBk: if (floatval($order['wxpay']) != 0) { goto k4sio; } goto olxXJ; U3Ssm: $data = curl_exec($ch); goto CDHd4; I7yoV: vb45I: goto WWkpP; ICvpN: if (empty($config['content']['group_fail'])) { goto D3x_R; } goto sBEyu; hQFtS: b4SNR: goto do8uk; w40CE: curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 1); goto kwiXw; M_DVT: if (!(floatval($order['canpay']) != 0)) { goto KdQYI; } goto jzmDg; LScOx: $post_data = json_encode($post_data); goto ByE7k; xAQuR: curl_setopt($ch, CURLOPT_SSLCERTTYPE, 'pem'); goto YyOJi; X4VIW: $refund = array("appid" => $appid, "mch_id" => $config['payment']['wechat']['mchid'], "nonce_str" => "123456", "out_refund_no" => $transaction_id, "out_trade_no" => $transaction_id, "refund_fee" => $refund_fee, "total_fee" => $total_fee, "sign" => $ref); goto lHYMR; tM0ZZ: $config = pdo_get('xc_beauty_config', array("xkey" => "web", "uniacid" => $uniacid)); goto r907g; YvpBt: unlink($key_file); goto g805a; F8sYC: if (!(($TxtRes = fopen($key_file, 'w+')) === FALSE)) { goto PgEck; } goto EEdpU; BynpW: $url = 'https://api.teegon.com/router?method=teegon.agent.mfuser.get.pay.secret&app_key=' . $AppKey . '&client_secret=' . $AppSecret; goto sMMWI; wxxgi: $cert = pdo_get('xc_beauty_config', array("uniacid" => $uniacid, "xkey" => "refund")); goto Piryo; uR5bs: $AppSecret = $config['content']['AppSecret']; goto kMyh8; g805a: if ($data) { goto g8LE7; } goto x3_cA; vK_Vj: hU3bd: goto I2EH0; kMyh8: $agent_id = $config['content']['agent_id']; goto sz_57; w5hB4: $StrConents = $cert['content']['cert']; goto To3SD; yyUyg: Ql7MM: goto r33Hd; DZJ01: $can_list = -1; goto WDhBk; WcIf_: $config = pdo_get('uni_settings', array("uniacid" => $uniacid)); goto wxxgi; MRQN3: if (empty($order['charge_id'])) { goto zx8TJ; } goto BynpW; j9LIf: tgSNC: goto KS5Zp; OGHHL: if (!empty($result['result'])) { goto BO1jU; } goto K1KDi; do8uk: } goto unBwx; M9f6Q: $agent_id = ''; goto tVli0; E41aq: $AppSecret = ''; goto M9f6Q; Yl_3h: $money = round(floatval($userinfo['money']) + floatval($order['canpay']), 2); goto ydaEy; G8qje: $post_data['form_id'] = $order['form_id']; goto F5Tjn; Zxnef: $cert['content'] = json_decode($cert['content'], true); goto HyZRv; WQNk4: $can_list = 1; goto BO9c1; U8u1t: OXLy6: goto mWJfm; IDq0Y: $token = $wechat->checkAuth($_W['account']['key'], $_W['account']['secret']); goto vhCdV; unBwx: VAOg6: goto qwfJD; uFuGR: $tiangong = $config['content']['tiangong']; goto mrjOh; a7mlR: if (!empty($result['result'])) { goto ZkLBy; } goto fQjkd; bMGOb: pdo_update('xc_beauty_order', array("refund_status" => -1, "status" => 2), array("id" => $order['id'], "uniacid" => $uniacid)); goto KksLm; GS5MF: if (empty($g['team'])) { goto hTD40; } goto vIJeA; vIJeA: $g['team'] = json_decode($g['team'], true); goto fOY0x; fVHLm: $result = json_decode($result, true); goto a7mlR; HT9nP: if (!($data['result_code'] == 'SUCCESS')) { goto V1RDQ; } goto WQNk4; VTNXF: $config['content'] = json_decode($config['content'], true); goto FzevE; VeYRr: if ($can_list == 1) { goto Ijg9G; } goto bMGOb; IalCX: kxwUW: goto VeYRr; aVqvD: $error = curl_errno($ch); goto TQgDV; P8VLs: KkhMO: goto RBHMT; nMCH7: if (floatval($order['wxpay']) != 0) { goto EwkZO; } goto IPb4K; gqAhy: goto JXlki; goto nG7ze; dI0Gs: $cert_file = '../addons/' . $_GPC['m'] . '/resource/' . rand(100000, 999999) . '.pem'; goto tIoWx; lenXw: $can_list = -1; goto nMCH7; jYMWa: $tiangong = -1; goto MPZiU; DYG0I: $config = pdo_get('xc_beauty_config', array("xkey" => "web", "uniacid" => $uniacid)); goto Exqdj; xx5hm: if (!(!empty($config['content']['tiangong']) && !empty($config['content']['AppKey']) && !empty($config['content']['AppSecret']))) { goto EZR5_; } goto uFuGR; TfBqj: require_once IA_ROOT . '/addons/xc_beauty/resource/WeChat.class.php'; goto GQoaK; MxUck: $result = vpost($url, $data); goto ieGPK; TQgDV: curl_close($ch); goto sJldc; Y1kb8: fclose($TxtRes); goto jHcY0; uJngH: exit; goto vs4U6; GrqC0: $userinfo = pdo_get('xc_beauty_userinfo', array("status" => 1, "openid" => $order['openid'], "uniacid" => $uniacid)); goto Yl_3h; vjE1d: if (!($config && $cert)) { goto I0A7O; } goto Zxnef; tVli0: $user_id = ''; goto c32dX; IPb4K: $can_list = 1; goto iencN; lCMwG: DuEj_: goto Bo5Ro; I350U: exit; goto CpDzg; rpVuw: $agent_id = $config['content']['agent_id']; goto YQQ4U; tDVWj: curl_setopt($ch, CURLOPT_POST, 1); goto cdjkv; CGNLC: unlink($key_file); goto WXmoD; tOabG: $post_data['page'] = 'xc_beauty/pages/base/base'; goto G8qje; EHI5S: m3s6M: goto GS5MF; r7xEH: tfKMp: goto IalCX; V2WmL: $post_data = json_encode($post_data); goto rEHr8; b2niY: if (fwrite($TxtRes, $StrConents)) { goto Hnw9k; } goto IB69t; tIoWx: if (!(($TxtRes = fopen($cert_file, 'w+')) === FALSE)) { goto Xs90L; } goto K9Uy9; Q1OE7: $refund = array("appid" => $appid, "mch_id" => $config['payment']['wechat']['mchid'], "nonce_str" => "123456", "out_refund_no" => $transaction_id, "out_trade_no" => $transaction_id, "refund_fee" => $refund_fee, "total_fee" => $total_fee, "sign" => $ref); goto qFH6u; RGRCr: $StrConents = $cert['content']['cert']; goto bZNuc; bZNuc: if (fwrite($TxtRes, $StrConents)) { goto jZIvl; } goto HLTxq; qwfJD: hTD40: goto sgiez; FavAl: IKFyd: goto c7bLQ; LX1Qt: $url = 'https://api.weixin.qq.com/cgi-bin/message/wxopen/template/send?access_token=' . $token; goto V2WmL; y0L4N: curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); goto kJdRF; XJTtm: if (!$order) { goto m3s6M; } goto fyXyt; mWJfm: taiAZ: goto wxvg2; HLTxq: echo '尝试向文件' . $cert_file . '写入' . $StrConents . '失败！'; goto v0aVM; kCO5u: if (!empty($order['charge_id'])) { goto M5br1; } goto gqAhy; G_oHy: pdo_update('xc_beauty_order', array("refund_status" => 1, "status" => 2), array("id" => $order['id'], "uniacid" => $uniacid)); goto U8u1t; ydaEy: $request = pdo_update('xc_beauty_userinfo', array("money" => $money), array("status" => 1, "openid" => $order['openid'], "uniacid" => $uniacid)); goto Rb2iy; ttGtm: $transaction_id = $order['wx_out_trade_no']; goto iT3nt; Bo5Ro: pdo_update('xc_beauty_order', array("refund_status" => -1, "status" => 2), array("id" => $order['id'], "uniacid" => $uniacid)); goto vXeBS; Exqdj: if (!$config) { goto w0G0O; } goto VTNXF; sgiez: $request = pdo_update('xc_beauty_group', array("status" => 2), array("status" => -1, "uniacid" => $uniacid, "id" => $g['id'])); goto seXaB; vnjFI: exit; goto DQl18; Uqpxo: curl_setopt($ch, CURLOPT_URL, $url); goto eKDbg; w4zyB: if (!empty($result['result'])) { goto TFCg2; } goto O9s1h; LcbuB: $output = curl_exec($ch); goto RBgwh; Fu0N5: $data = xmlToArray($data); goto pgKaF; Dgtnp: curl_setopt($ch, CURLOPT_SSLCERT, $cert_file); goto YbxJg; HMuwf: $cert = pdo_get('xc_beauty_config', array("uniacid" => $uniacid, "xkey" => "refund")); goto vjE1d; rEHr8: $ch = curl_init(); goto Uqpxo; MAm9S: TFCg2: goto dIHe8; FzevE: if (empty($config['content']['group_fail'])) { goto KkhMO; } goto TfBqj; NCCks: $config['payment'] = unserialize($config['payment']); goto rXSEJ; X749R: if (!(floatval($order['canpay']) != 0)) { goto tcuZt; } goto GrqC0; jHcY0: curl_setopt($ch, CURLOPT_SSLKEY, $key_file); goto Xzf3E; D6mTv: $postdata = array("keyword1" => array("value" => $order['out_trade_no']), "keyword2" => array("value" => $order['amount']), "keyword3" => array("value" => $service['name']), "keyword4" => array("value" => "人数不足")); goto Iiarz; iVVoC: $config = pdo_get('uni_settings', array("uniacid" => $uniacid)); goto HMuwf; oXbtK: curl_setopt($ch, CURLOPT_HEADER, 0); goto y0L4N; eIIxg: if (!(strtotime($g['createtime']) + intval($g['failtime']) * 60 * 60 < time())) { goto Awrq5; } goto GYBt6; bHwcT: pdo_query($sql, array(":group_stock" => $order['total'], ":uniacid" => $uniacid, ":id" => $order['pid'])); goto EHI5S; yZfh5: $url = 'https://api.mch.weixin.qq.com/secapi/pay/refund'; goto rEoBS; qFH6u: $xml = arrayToXml($refund); goto ckxg1; v0aVM: fclose($TxtRes); goto wKAFF; mFBz_: Ijg9G: goto X749R; wvVCm: d3zeB: goto U5D61; JBg16: aALxg: goto kCO5u; wKAFF: exit; goto i1TkE; cDR0J: jLNSl: goto ZEKT5; RBgwh: curl_close($ch); goto P8VLs; SQryH: $url = 'https://api.teegon.com/router?method=teegon.agent.mfuser.get.pay.secret&app_key=' . $AppKey . '&client_secret=' . $AppSecret; goto Qpw5P; rEoBS: $ref = strtoupper(md5('appid=' . $appid . '&mch_id=' . $config['payment']['wechat']['mchid'] . '&nonce_str=123456' . '&out_refund_no=' . $transaction_id . '&out_trade_no=' . $transaction_id . '&refund_fee=' . $refund_fee . '&total_fee=' . $total_fee . '&key=' . $config['payment']['wechat']['signkey'])); goto Q1OE7; YbxJg: curl_setopt($ch, CURLOPT_SSLCERTTYPE, 'pem'); goto jXa7w; DfDmz: hgjM3: goto HT9nP; RBHMT: w0G0O: goto T2K9o; fyXyt: if ($group_refund == 1) { goto DuEj_; } goto npoJ8; sJldc: goto KSuRd; goto dROse; nBlCg: J4S5O: goto n0Aph; npoJ8: if (!($group_refund == 2)) { goto taiAZ; } goto lenXw; k1j5i: goto tfKMp; goto JBg16; BO9c1: V1RDQ: goto wvVCm; IdW1M: curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false); goto zIjQD; T2K9o: $sql = 'UPDATE ' . tablename('xc_beauty_service') . ' SET group_stock=group_stock+:group_stock WHERE uniacid=:uniacid AND id=:id AND group_stock>=0'; goto bHwcT; rXSEJ: $appid = $_W['account']['key']; goto ttGtm; HyZRv: if (!(!empty($cert['content']['cert']) && !empty($cert['content']['key']))) { goto J4S5O; } goto NCCks; GQoaK: $wechat = new Wechat(); goto IDq0Y; iT3nt: $total_fee = floatval($order['wxpay']) * 100; goto HNJWC; Qpw5P: $data = array("agent_id" => $agent_id, "user_id" => $user_id, "secret_type" => 1); goto MxUck; n0Aph: I0A7O: goto k1j5i; Obxrs: $data = curl_exec($ch); goto uCTuu; xXD04: ZkLBy: goto cDR0J; wxvg2: goto vNOGO; goto lCMwG; vhCdV: $service = pdo_get('xc_beauty_service', array("id" => $order['pid'])); goto D6mTv; dIHe8: $url = 'https://api.teegon.com/router?method=teegon.payment.charge.refund&app_key=' . $result['result']['key'] . '&client_secret=' . $result['result']['secret']; goto wfNE8; s0TL0: NWYot: goto JOL2k; Xzf3E: curl_setopt($ch, CURLOPT_POST, 1); goto L0CDE; mrjOh: $AppKey = $config['content']['AppKey']; goto qjiHe; kJdRF: curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 1); goto NNLQn; seXaB: Awrq5: goto FavAl; yZ0RZ: $result = vpost($url, $data); goto fVHLm; dsqS7: $post_data['template_id'] = $config['content']['group_fail']; goto tOabG; Iiarz: $post_data['touser'] = $order['openid']; goto dsqS7; IB69t: echo '尝试向文件' . $key_file . '写入' . $StrConents . '失败！'; goto Fu1nd; vs4U6: eBzd9: goto lj1SI; qjiHe: $AppSecret = $config['content']['AppSecret']; goto rpVuw; GYBt6: $order = pdo_get('xc_beauty_order', array("status" => 1, "uniacid" => $uniacid, "group" => $g['id'], "openid" => $g['openid'])); goto XJTtm; O9s1h: goto jLNSl; goto MAm9S; MPZiU: $AppKey = ''; goto E41aq; KksLm: goto OXLy6; goto mFBz_; dROse: Y7Uxi: goto qx3YL; CpDzg: Hnw9k: goto Y1kb8; NNLQn: curl_setopt($ch, CURLOPT_SSLCERTTYPE, 'pem'); goto dI0Gs; wk5H3: if (!$config) { goto NWYot; } goto XK5ls; ckxg1: $ch = curl_init(); goto zKqgy; nG7ze: M5br1: goto SQryH; K9Uy9: echo '创建可写文件：' . $cert_file . '失败'; goto vnjFI; jXa7w: $key_file = '../addons/' . $_GPC['m'] . '/resource/' . rand(100000, 999999) . '.pem'; goto Y6UmF; WXmoD: if ($data) { goto Y7Uxi; } goto aVqvD; lj1SI: $StrConents = $cert['content']['key']; goto b2niY; zKqgy: curl_setopt($ch, CURLOPT_URL, $url); goto oXbtK; DQl18: Xs90L: goto RGRCr; iZTOs: echo '创建可写文件：' . $key_file . '失败'; goto uJngH; c7bLQ: } goto xpbfg; GGvMg: $uniacid = $_W['uniacid']; goto Db4Z7; t71Dy: echo '退款完成'; goto MDyUX; IK3ZF: if (!$group_config) { goto qV_fB; } goto bE4Kb; kC2UJ: jbTT9: goto bIaFN; U_6yO: ignore_user_abort(true); goto ItTaa; Db4Z7: set_time_limit(0); goto U_6yO; Q0jZJ: $group_config = pdo_get('xc_beauty_config', array("xkey" => "web", "uniacid" => $uniacid)); goto IK3ZF; xpbfg: gE9I5: goto T6iRW; XBpPV: global $_GPC, $_W; goto GGvMg; bIaFN: qV_fB: goto n9BVs; pnQn7: $group_refund = $group_config['content']['group_refund']; goto kC2UJ; YCLro: if (!$group) { goto t464d; } goto gBzle; bE4Kb: $group_config['content'] = json_decode($group_config['content'], true); goto FKZP2; FKZP2: if (empty($group_config['content']['group_refund'])) { goto jbTT9; } goto pnQn7; ItTaa: $group = pdo_getall('xc_beauty_group', array("status" => -1, "uniacid" => $uniacid)); goto YCLro; gBzle: $group_refund = 1; goto Q0jZJ; MDyUX: } } goto i5NqT; prk4Q: function wp_print($printer_sn, $orderInfo, $times) { goto qZGD9; rOB9w: if (!$client->post(PATH, $content)) { goto C27fx; } goto ioSiB; qZGD9: $content = array("user" => USER, "stime" => STIME, "sig" => SIG, "apiname" => "Open_printMsg", "sn" => $printer_sn, "content" => $orderInfo, "times" => $times); goto UWp3s; ioSiB: echo $client->getContent(); goto WynJD; b3yPf: C27fx: goto d38ge; d38ge: echo 'error'; goto tgLdx; UWp3s: $client = new HttpClient(IP, PORT); goto rOB9w; tgLdx: jNIJj: goto JWTbk; WynJD: goto jNIJj; goto b3yPf; JWTbk: } goto DfGXd; YK2kJ: function array2url($params) { goto qmOjc; qmOjc: $str = ''; goto hXju_; uL3cR: $str = trim($str, '&'); goto gURyG; jm302: foreach ($params as $key => $val) { goto Uac4w; mdULg: $str .= "{$key}={$val}&"; goto gGfuc; kQK3o: goto EOj3x; goto Ye5nX; Uac4w: if (!((empty($val) || is_array($val)) && !in_array($key, $ignore))) { goto OyNOz; } goto kQK3o; gGfuc: EOj3x: goto Jw2PM; Ye5nX: OyNOz: goto mdULg; Jw2PM: } goto AB6Xs; AB6Xs: GUPrZ: goto uL3cR; gURyG: return $str; goto GpWjn; hXju_: $ignore = array("coupon_refund_fee", "coupon_refund_count"); goto jm302; GpWjn: } ?>