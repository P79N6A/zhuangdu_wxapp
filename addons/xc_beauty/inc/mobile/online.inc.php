<?php
 goto pTkp2; pTkp2: global $_W, $_GPC; goto g_FOy; YwM08: if (!$config) { goto c2sW3; } goto tiici; wNo3F: $token = $config["\x63\157\x6e\164\x65\x6e\x74"]["\164\157\x6b\145\x6e"]; goto DHNxu; d10nJ: load()->func("\154\x6f\x67\147\x69\x6e\x67"); goto w147j; DHNxu: FzH6S: goto kKSMZ; rIW1z: $token = ''; goto G21zs; w147j: class Online { public $token, $uniacid; public function __construct($token, $uniacid, $appid) { goto a_V4s; f1KKm: $this->appid = $appid; goto XvGsi; a_V4s: $this->token = $token; goto yWrAu; yWrAu: $this->uniacid = $uniacid; goto f1KKm; XvGsi: } public function check_server() { goto g3STb; Qivan: goto NsoWW; goto a0hVW; hwqeW: $this->valid(); goto N2H3Y; a0hVW: r67jG: goto hwqeW; g3STb: if (isset($_GET["\145\143\150\x6f\163\164\162"])) { goto r67jG; } goto PYRkG; PYRkG: $this->responseMsg(); goto Qivan; N2H3Y: NsoWW: goto jet8v; jet8v: } public function valid() { goto aISz3; v6L10: echo $echoStr; goto LgAOU; C4Gof: echo $echoStr . "\x2b\x2b\x2b" . $this->token; goto IwzLf; F8LyT: if ($this->checkSignature()) { goto zXeyl; } goto C4Gof; IwzLf: exit; goto Kbu9O; Kbu9O: goto G2ZpV; goto pFm_R; ZiJk2: G2ZpV: goto MYGpp; LgAOU: exit; goto ZiJk2; aISz3: $echoStr = $_GET["\145\x63\x68\157\163\x74\x72"]; goto F8LyT; VUbUC: header("\x63\x6f\156\x74\145\x6e\164\x2d\164\171\x70\145\72\x74\x65\x78\164"); goto v6L10; pFm_R: zXeyl: goto VUbUC; MYGpp: } private function checkSignature() { goto uxjTm; uxjTm: $signature = $_GET["\163\x69\147\x6e\141\x74\x75\162\145"]; goto CMA0y; cE5pr: $tmpArr = array($token, $timestamp, $nonce); goto X9JD6; xzSPw: return true; goto s1y2Y; TvE0a: HTS_0: goto xzSPw; cXShB: $tmpStr = sha1($tmpStr); goto Y8nxb; PQ_L6: $tmpStr = implode($tmpArr); goto cXShB; Y8nxb: if ($tmpStr == $signature) { goto HTS_0; } goto AlJqM; gMIEq: $nonce = $_GET["\156\x6f\156\x63\145"]; goto tAhqf; CMA0y: $timestamp = $_GET["\164\151\x6d\x65\x73\164\141\155\x70"]; goto gMIEq; s1y2Y: NuAzv: goto V9PGr; wmu8I: goto NuAzv; goto TvE0a; tAhqf: $token = $this->token; goto cE5pr; AlJqM: return false; goto wmu8I; X9JD6: sort($tmpArr, SORT_STRING); goto PQ_L6; V9PGr: } public function responseMsg() { goto fk_1a; ZJeP1: echo "\163\165\x63\x63\x65\x73\163"; goto a2d40; sBi0C: if (!empty($postStr) && is_string($postStr)) { goto IeZFo; } goto U7aNz; vfUDF: $data["\143\157\x6e\x74\145\156\x74"] = $postArr["\120\151\x63\125\162\154"]; goto uVq9a; tB7Qy: $data["\x75\156\151\x61\143\x69\144"] = $this->uniacid; goto SsKey; uVq9a: $this->checkOnline($data); goto xUIM2; TjX33: $postArr = json_decode($postStr, true); goto yjvk2; U7aNz: echo ''; goto rnyfZ; y42dD: UcVOu: goto ZJeP1; fqSSR: goto UcVOu; goto U2RFp; vA9RL: VfD9a: goto M3KhY; JTbHC: IeZFo: goto TjX33; CbhUR: if ($postArr["\x4d\x73\147\124\x79\x70\145"] == "\x65\x76\145\x6e\164" && $postArr["\105\166\x65\x6e\164"] == "\x75\163\x65\162\137\x65\156\164\145\162\137\x74\x65\155\x70\x73\x65\x73\x73\x69\x6f\156") { goto VfD9a; } goto KUGL2; rN2wa: $data["\x75\x6e\x69\141\x63\x69\x64"] = $this->uniacid; goto FcsD2; FcsD2: $data["\157\x70\x65\x6e\x69\x64"] = $postArr["\106\x72\157\x6d\x55\163\x65\x72\116\x61\x6d\x65"]; goto otFJD; fk_1a: $postStr = $GLOBALS["\110\x54\x54\x50\x5f\x52\101\x57\x5f\x50\117\x53\x54\137\104\101\x54\x41"]; goto sBi0C; QUn27: goto Qxcq8; goto JTbHC; xUIM2: goto UcVOu; goto vA9RL; SsKey: $data["\157\x70\x65\156\151\x64"] = $postArr["\106\x72\x6f\x6d\x55\163\x65\162\x4e\141\x6d\145"]; goto B9hNP; a2d40: exit; goto JkynF; KUGL2: goto UcVOu; goto DQ_0Y; otFJD: $data["\164\x79\x70\x65"] = 1; goto ko3h9; BXypZ: if (!empty($postArr["\x4d\163\147\124\x79\160\145"]) && $postArr["\115\x73\147\x54\x79\160\145"] == "\151\155\x61\147\x65") { goto DvZx0; } goto CbhUR; ko3h9: $data["\143\157\x6e\164\145\156\x74"] = base64_encode($postArr["\103\x6f\x6e\x74\145\156\164"]); goto penV0; JkynF: Qxcq8: goto uNenX; U2RFp: DvZx0: goto tB7Qy; M3KhY: logging_run("\350\xbf\x9b\xe5\205\xa5\xe5\xae\xa2\xe6\234\215\xe4\xbc\232\350\257\235\357\274\x9a" . json_encode($postArr)); goto y42dD; rnyfZ: exit; goto QUn27; yjvk2: if (!empty($postArr["\115\x73\147\x54\x79\x70\x65"]) && $postArr["\x4d\163\147\x54\171\160\x65"] == "\164\x65\x78\x74") { goto rnmqI; } goto BXypZ; penV0: $this->checkOnline($data); goto fqSSR; B9hNP: $data["\164\171\160\145"] = 2; goto vfUDF; DQ_0Y: rnmqI: goto rN2wa; uNenX: } public function checkOnline($data) { goto AzdGM; EyLwk: NKDba: goto BLqi_; kZwm2: if (empty($config["\x63\x6f\x6e\164\x65\x6e\x74"]["\152\151\x61\156\147\145"])) { goto KxZeH; } goto EkAuU; H1N9A: pdo_insert("\x78\x63\137\142\x65\141\165\x74\171\x5f\157\156\x6c\x69\x6e\145\x5f\154\x6f\147", $data); goto d9VN6; hjgRG: HOWWQ: goto KwdgY; oAmMV: if ($online) { goto zNX2E; } goto ZColo; AzdGM: $online = pdo_get("\170\143\137\142\x65\141\165\x74\x79\x5f\x6f\x6e\154\151\x6e\145\163", array("\x75\x6e\151\x61\143\151\x64" => $data["\x75\156\151\141\143\151\144"], "\x6f\160\x65\x6e\x69\x64" => $data["\157\160\145\x6e\x69\144"])); goto oAmMV; dk2aq: $sql = "\125\x50\104\x41\124\105\x20" . tablename("\170\143\137\142\145\141\165\164\171\x5f\157\x6e\x6c\x69\156\145\163") . "\x20\123\105\124\x20\155\x65\155\x62\x65\x72\x3d\155\145\155\142\145\x72\53\x31\54\x75\160\144\x61\x74\x65\x74\151\155\x65\75\x3a\x74\151\155\x65\x73\x2c\x74\171\160\145\75\72\164\x79\x70\145\x2c\143\157\x6e\164\145\x6e\x74\75\72\x63\157\156\164\145\x6e\164\x20\127\x48\105\x52\x45\40\x69\144\x3d\72\151\x64\x20\x41\116\104\x20\165\156\151\x61\x63\x69\144\75\x3a\x75\156\151\x61\143\x69\144"; goto F2hK5; hAx2y: $this->sendMon($data); goto MqjKA; k8QZN: $config = pdo_get("\170\x63\x5f\x62\x65\x61\165\x74\x79\137\143\157\156\146\151\x67", array("\x78\153\x65\x79" => "\157\x6e\154\151\x6e\145", "\x75\x6e\151\x61\143\151\144" => $this->uniacid)); goto InmUp; sD8S0: if (!$request) { goto b6qDK; } goto dk2aq; R0uk2: Zmada: goto k8QZN; Nre5D: i7Ih2: goto XZags; IBXSq: IZX72: goto Ow74t; MqjKA: goto csHmw; goto R0uk2; ZColo: $request = pdo_insert("\170\x63\x5f\x62\145\x61\165\x74\171\x5f\x6f\156\x6c\151\156\145\x73", array("\165\x6e\x69\141\x63\151\144" => $data["\165\156\151\x61\143\x69\x64"], "\x6f\x70\145\156\x69\x64" => $data["\x6f\x70\x65\156\151\x64"], "\155\145\x6d\x62\145\162" => 1, "\x75\x70\144\x61\x74\145\164\151\x6d\x65" => date("\x59\x2d\155\x2d\144\x20\110\72\x69\x3a\163"), "\164\x79\160\145" => $data["\164\x79\x70\x65"], "\143\x6f\156\164\x65\156\x74" => $data["\x63\157\156\x74\x65\156\x74"])); goto jWDmA; d9VN6: $this->sendMon($data); goto EyLwk; F2hK5: pdo_query($sql, array("\x3a\164\151\x6d\x65\163" => date("\131\x2d\155\55\144\x20\x48\72\x69\x3a\x73"), "\72\151\x64" => $online["\x69\144"], "\72\x75\156\151\141\143\x69\x64" => $data["\x75\156\151\141\x63\151\x64"], "\x3a\164\171\160\x65" => $data["\164\171\x70\x65"], "\72\143\157\x6e\x74\x65\x6e\x74" => $data["\143\157\156\164\x65\156\x74"])); goto oLOzB; en8F9: zNX2E: goto jmT5F; KwdgY: KxZeH: goto Nre5D; if1Uo: if ($prev) { goto Zmada; } goto hAx2y; VTFNV: $this->sendMon($data); goto hjgRG; jWDmA: if (!$request) { goto NKDba; } goto oxAO6; BLqi_: goto IZX72; goto en8F9; oLOzB: $prev = pdo_getall("\x78\x63\x5f\142\x65\141\165\164\171\137\x6f\156\154\151\x6e\x65\137\x6c\x6f\147", array("\x75\x6e\151\141\143\151\144" => $data["\x75\156\151\x61\143\x69\x64"], "\x70\151\144" => $data["\160\151\x64"], "\144\x75\x74\x79" => 2), array(), '', "\x63\162\x65\141\164\x65\x74\151\155\145\x20\104\x45\x53\103\x2c\x69\144\x20\x44\105\x53\103", array(1, 5)); goto if1Uo; X1u7U: $request = pdo_insert("\170\x63\x5f\x62\145\x61\x75\164\171\x5f\x6f\156\x6c\x69\x6e\x65\137\x6c\157\147", $data); goto sD8S0; EkAuU: if (!(time() - strtotime($prev[0]["\143\x72\145\x61\x74\x65\x74\x69\155\x65"]) >= intval($config["\x63\157\x6e\x74\x65\156\x74"]["\x6a\x69\x61\156\x67\145"]))) { goto HOWWQ; } goto VTFNV; InmUp: if (!$config) { goto i7Ih2; } goto qzn2N; oxAO6: $data["\x70\x69\x64"] = pdo_insertid(); goto H1N9A; qzn2N: $config["\x63\x6f\x6e\164\145\x6e\164"] = json_decode($config["\x63\x6f\156\x74\x65\156\x74"], true); goto kZwm2; XZags: csHmw: goto kC2Kl; jmT5F: $data["\160\x69\x64"] = $online["\151\x64"]; goto X1u7U; kC2Kl: b6qDK: goto IBXSq; Ow74t: } public function sendMon($data) { goto bENFz; bENFz: $templateParam = array("\x77\145\x62\x6e\141\x6d\x65\x78" => "\346\227\240", "\156\x69\143\153" => "\xe6\x97\xa0", "\143\x6f\156\x74\145\156\x74" => "\xe6\227\xa0", "\x61\160\x70\151\x64" => $this->appid, "\160\x61\147\145" => "\x78\143\x5f\x62\x65\x61\165\x74\171\57\x70\141\x67\145\x73\57\142\x61\x73\145\x2f\x62\x61\163\145\77\163\150\x61\162\145\75\x2f\170\143\137\142\x65\x61\x75\164\x79\57\x75\151\x32\57\x6f\x6e\154\x69\156\x65\57\x69\x6e\x64\145\x78"); goto mt1eg; dHKhx: $templateParam["\x63\x6f\x6e\x74\145\156\164"] = "\xe5\233\276\347\x89\207"; goto WS7un; Baq5u: $sendopenid = array(); goto Ahw8e; QrM6W: if (!$web) { goto d2iOn; } goto KW0eE; nuvPV: cp205: goto WGc2A; uNcJq: $web["\x63\157\156\x74\x65\156\164"] = json_decode($web["\x63\157\156\x74\x65\156\164"], true); goto cvQTO; mt1eg: $config = pdo_get("\x78\143\137\142\x65\x61\165\x74\x79\137\143\x6f\156\146\x69\x67", array("\170\153\145\x79" => "\157\x6e\x6c\151\x6e\145", "\165\156\151\141\x63\151\x64" => $this->uniacid)); goto DJk4Y; tzhsS: if (empty($config["\143\157\156\x74\x65\x6e\164"])) { goto s7J1f; } goto ksGfU; p7tOA: if (!$web) { goto IrIpe; } goto uNcJq; Ahw8e: foreach ($openids as $itemopenis) { $sendopenid[] = $itemopenis["\157\160\x65\x6e\151\144"]; ZAVE7: } goto ce9EM; Gq2_K: if (!($userinfo && !empty($userinfo["\x6e\151\143\153"]))) { goto cp205; } goto USSN1; qY0Uu: if (!(!empty($web["\x63\x6f\156\x74\x65\x6e\164"]) && !empty($web["\143\x6f\156\x74\145\156\x74"]["\164\151\164\x6c\x65"]))) { goto w44XP; } goto p5Xmb; pqyxs: if (!($data["\x74\x79\160\x65"] == 2)) { goto aCw3W; } goto dHKhx; FPVgW: $userinfo = pdo_get("\x78\x63\137\142\145\x61\165\164\171\137\165\163\x65\x72\x69\156\146\x6f", array("\165\156\x69\x61\x63\151\x64" => $this->uniacid, "\x6f\x70\x65\x6e\x69\144" => $data["\157\x70\x65\x6e\151\144"])); goto Gq2_K; WGc2A: if ($data["\x74\x79\160\x65"] == 1) { goto uyWjE; } goto pqyxs; XgF4t: momessv2($accessurl, $template, $sendopenid, $templateParam); goto yAaKc; vQ1YU: $accessurl = $web["\x63\157\156\164\x65\156\x74"]["\170\143\155\x65\163\x73\x61\x67\x65"] . "\46\x6f\160\75\163\x65\x6e\x64\166\x32"; goto PXnwJ; WS7un: aCw3W: goto lDs9A; FFQH4: d2iOn: goto FPVgW; Pi2oA: $templateParam["\x63\x6f\156\164\x65\x6e\x74"] = base64_decode($data["\x63\x6f\156\164\145\156\x74"]); goto eRh_Y; PXnwJ: $template = $config["\x63\x6f\156\x74\x65\x6e\164"]["\x78\143"]; goto oKUf1; DJk4Y: if (!$config) { goto k403j; } goto LU7sU; XojeJ: $web = pdo_get("\170\x63\137\x62\x65\141\165\164\x79\137\x63\x6f\156\146\151\147", array("\170\153\x65\171" => "\x77\x65\142", "\x75\156\x69\x61\143\151\144" => $this->uniacid)); goto QrM6W; USSN1: $templateParam["\x6e\151\x63\153"] = base64_decode($userinfo["\x6e\x69\x63\x6b"]); goto nuvPV; p5Xmb: $templateParam["\x77\x65\x62\156\x61\155\x65\170"] = $web["\x63\157\x6e\x74\x65\156\x74"]["\164\x69\x74\x6c\145"]; goto T3x61; dcbqO: $openids = $config["\x63\157\x6e\x74\145\156\x74"]["\165\x73\145\x72\154\x69\x73\x74"]; goto Baq5u; cvQTO: IrIpe: goto vQ1YU; oKUf1: $template["\144\x61\x74\x61"] = $config["\x63\x6f\156\x74\145\x6e\164"]["\x64\141\x74\141"]; goto dcbqO; SZWUF: uyWjE: goto Pi2oA; KW0eE: $web["\143\157\156\x74\145\x6e\x74"] = json_decode($web["\x63\157\x6e\164\x65\156\164"], true); goto qY0Uu; LU7sU: $config["\x63\157\x6e\x74\145\x6e\x74"] = json_decode($config["\143\157\x6e\x74\145\156\164"], true); goto tzhsS; ce9EM: tSUgX: goto XojeJ; ksGfU: $web = pdo_get("\170\143\x5f\142\145\x61\x75\164\171\137\143\x6f\156\x66\x69\147", array("\x78\153\145\x79" => "\167\145\x62", "\165\x6e\x69\x61\x63\151\x64" => $data["\x75\156\151\x61\143\x69\144"])); goto p7tOA; eRh_Y: Of8qF: goto XgF4t; yAaKc: s7J1f: goto HrwZC; T3x61: w44XP: goto FFQH4; lDs9A: goto Of8qF; goto SZWUF; HrwZC: k403j: goto Lcyxy; Lcyxy: } } goto rIW1z; g_FOy: $uniacid = $_W["\165\x6e\151\141\x63\x69\x64"]; goto d10nJ; kKSMZ: c2sW3: goto k9Qm_; tiici: $config["\143\157\156\164\x65\156\x74"] = json_decode($config["\143\x6f\x6e\164\145\x6e\164"], true); goto VL3zM; G21zs: $config = pdo_get("\x78\x63\137\x62\x65\x61\165\164\171\137\143\x6f\x6e\146\151\x67", array("\x78\x6b\145\171" => "\x6f\x6e\154\x69\156\145", "\165\x6e\151\x61\x63\x69\x64" => $uniacid)); goto YwM08; VL3zM: if (!(!empty($config["\143\157\x6e\164\x65\156\x74"]) && !empty($config["\x63\x6f\x6e\x74\145\x6e\164"]["\x74\x6f\153\145\x6e"]))) { goto FzH6S; } goto wNo3F; k9Qm_: $online = new Online($token, $uniacid, $_W["\x61\x63\143\157\x75\x6e\164"]["\x6b\145\x79"]); goto p99mB; p99mB: $online->check_server();